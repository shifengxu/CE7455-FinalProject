[2022-04-13 13:09:48.576] corpus.train_file_list: 2
[2022-04-13 13:09:48.576]         ../data/sample_500k/cbt_train.txt
[2022-04-13 13:09:48.576]         ../data/sample_500k/adolescent_train.txt
[2022-04-13 13:09:48.576] corpus.valid_file_list: 2
[2022-04-13 13:09:48.576]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 13:09:48.576]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:09:48.576] corpus.test_file_list: 3
[2022-04-13 13:09:48.576]         ../data/sample_500k/adult_test.txt
[2022-04-13 13:09:48.576]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:09:48.576]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 13:09:48.576] corpus.subword_vocab_size: 0
[2022-04-13 13:09:48.576] corpus.subword_model = None. Corpus will not use subword.
[2022-04-13 13:09:48.576] corpus tokenize...
[2022-04-13 13:09:49.247]         train tokens: 511735  ../data/sample_500k/cbt_train.txt
[2022-04-13 13:09:50.278]         train tokens: 467267  ../data/sample_500k/adolescent_train.txt
[2022-04-13 13:09:50.413]         valid tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-13 13:09:50.648]         valid tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:09:51.258]         test  tokens: 506878  ../data/sample_500k/adult_test.txt
[2022-04-13 13:09:51.477]         test  tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:09:51.611]         test  tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-13 13:09:51.612] corpus.ntokens      : 100726
[2022-04-13 13:09:51.612] corpus.char_count   : 166
[2022-04-13 13:09:51.612] corpus.char_cnt_dict: 166
[2022-04-13 13:09:51.612] corpus.char_id_dict : 166
[2022-04-13 13:09:51.618] corpus.batchify(2 files, batch_size=20)...
[2022-04-13 13:09:51.618]         tokens_all: 979002
[2022-04-13 13:09:51.618]         batched   :  48950
[2022-04-13 13:09:51.618]         ../data/sample_500k/cbt_train.txt
[2022-04-13 13:09:51.618]         ../data/sample_500k/adolescent_train.txt
[2022-04-13 13:09:51.621] corpus.batchify(2 files, batch_size=20)...
[2022-04-13 13:09:51.621]         tokens_all: 227673
[2022-04-13 13:09:51.621]         batched   :  11383
[2022-04-13 13:09:51.621]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 13:09:51.621]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:09:51.625] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 13:09:51.625]         tokens_all: 506878
[2022-04-13 13:09:51.625]         batched   :  25343
[2022-04-13 13:09:51.625]         ../data/sample_500k/adult_test.txt
[2022-04-13 13:09:51.627] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 13:09:51.627]         tokens_all: 112256
[2022-04-13 13:09:51.627]         batched   :   5612
[2022-04-13 13:09:51.627]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:09:51.629] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 13:09:51.629]         tokens_all: 115417
[2022-04-13 13:09:51.629]         batched   :   5770
[2022-04-13 13:09:51.629]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 13:09:51.629] subword_adapter will be generated due to word_split_mode='Subword.200'
[2022-04-13 13:09:51.629] SubwordAdapter.file_list: 4
[2022-04-13 13:09:51.629]         ../data/sample_500k/cbt_train.txt
[2022-04-13 13:09:51.630]         ../data/sample_500k/adolescent_train.txt
[2022-04-13 13:09:51.630]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 13:09:51.630]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:09:51.630] SubwordAdapter.subword_vocab_size: 200
[2022-04-13 13:09:51.630] SubwordAdapter.subword_model.train(4 files)...
[2022-04-13 13:09:52.055] SubwordAdapter.subword_model.train(4 files)...Done
[2022-04-13 13:09:52.831] RNNModel.rnn_type: LSTM
[2022-04-13 13:09:52.831] RNNModel.ntoken  : 100726
[2022-04-13 13:09:52.831] RNNModel.ninp    : 200
[2022-04-13 13:09:52.831] RNNModel.nhid    : 200
[2022-04-13 13:09:52.831] RNNModel.nlayers : 2
[2022-04-13 13:09:52.831] RNNModel.dropout : 0.2
[2022-04-13 13:09:52.831] RNNModel.tie_weights: False
[2022-04-13 13:09:52.831] RNNModel.fragment_aggregate_mode: LSTM
[2022-04-13 13:09:52.831] RNNModel.fragment_cnt           : 202
[2022-04-13 13:09:52.831] RNNModel.fragment_emsize        : 25
[2022-04-13 13:09:52.832] RNNModel.fragment_nhid          : 200
[2022-04-13 13:09:52.832] RNNModel.fragment_embeds     : created
[2022-04-13 13:09:52.836] RNNModel.fragment_lstm       : created
[2022-04-13 13:09:52.836] RNNModel.fragment_lstm_linear: created
[2022-04-13 13:09:52.905] Epoch 001/20 ==================================================
[2022-04-13 13:11:06.129] E001 |   200/1398 batches | lr 20.0000 | loss  8.137 | ppl   3417.20 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 13:12:20.174] E001 |   400/1398 batches | lr 20.0000 | loss  6.954 | ppl   1046.90 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 13:13:32.169] E001 |   600/1398 batches | lr 20.0000 | loss  6.352 | ppl    573.60 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 13:14:45.139] E001 |   800/1398 batches | lr 20.0000 | loss  6.129 | ppl    458.93 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 13:15:57.582] E001 |  1000/1398 batches | lr 20.0000 | loss  5.937 | ppl    378.62 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 13:17:08.202] E001 |  1200/1398 batches | lr 20.0000 | loss  5.771 | ppl    320.79 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 13:18:19.533] E001 |  1398/1398 batches | lr 20.0000 | loss  5.638 | ppl    281.02 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 13:18:48.411] End E001 | valid loss  5.795; ppl    328.51 | accu 0.1784 = 40612/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 13:19:52.739] End E001 |  test loss  8.295; ppl   4002.29 | accu 0.0719 = 36437/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 13:20:09.379] End E001 |  test loss  6.506; ppl    669.14 | accu 0.1697 = 19046/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:20:24.490] End E001 |  test loss  5.162; ppl    174.56 | accu 0.1806 = 20836/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 13:20:24.491] Save: model.pt... 
[2022-04-13 13:20:25.128] Save: model.pt...Done. best_val_loss: 5.7946
[2022-04-13 13:20:25.128] Epoch 002/20 ==================================================
[2022-04-13 13:21:39.111] E002 |   200/1398 batches | lr 20.0000 | loss  5.577 | ppl    264.20 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 13:22:50.676] E002 |   400/1398 batches | lr 20.0000 | loss  5.501 | ppl    244.84 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 13:24:02.568] E002 |   600/1398 batches | lr 20.0000 | loss  5.366 | ppl    213.94 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 13:25:16.853] E002 |   800/1398 batches | lr 20.0000 | loss  5.426 | ppl    227.18 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 13:26:31.169] E002 |  1000/1398 batches | lr 20.0000 | loss  5.342 | ppl    208.89 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 13:27:41.891] E002 |  1200/1398 batches | lr 20.0000 | loss  5.264 | ppl    193.18 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 13:28:52.665] E002 |  1398/1398 batches | lr 20.0000 | loss  5.202 | ppl    181.60 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 13:29:21.983] End E002 | valid loss  5.475; ppl    238.70 | accu 0.2059 = 46869/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 13:30:27.735] End E002 |  test loss  8.193; ppl   3614.85 | accu 0.0827 = 41900/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 13:30:42.177] End E002 |  test loss  6.065; ppl    430.36 | accu 0.2081 = 23351/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:30:56.771] End E002 |  test loss  4.903; ppl    134.66 | accu 0.2037 = 23498/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 13:30:56.771] Save: model.pt... 
[2022-04-13 13:30:57.422] Save: model.pt...Done. best_val_loss: 5.4752
[2022-04-13 13:30:57.422] Epoch 003/20 ==================================================
[2022-04-13 13:32:09.447] E003 |   200/1398 batches | lr 20.0000 | loss  5.195 | ppl    180.32 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 13:33:22.397] E003 |   400/1398 batches | lr 20.0000 | loss  5.174 | ppl    176.68 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 13:34:34.132] E003 |   600/1398 batches | lr 20.0000 | loss  5.073 | ppl    159.57 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 13:35:47.212] E003 |   800/1398 batches | lr 20.0000 | loss  5.162 | ppl    174.49 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 13:36:59.902] E003 |  1000/1398 batches | lr 20.0000 | loss  5.092 | ppl    162.75 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 13:38:11.770] E003 |  1200/1398 batches | lr 20.0000 | loss  5.031 | ppl    153.10 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 13:39:22.734] E003 |  1398/1398 batches | lr 20.0000 | loss  4.987 | ppl    146.51 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 13:39:52.327] End E003 | valid loss  5.377; ppl    216.31 | accu 0.2109 = 47999/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 13:40:58.066] End E003 |  test loss  8.147; ppl   3453.57 | accu 0.0829 = 41996/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 13:41:16.104] End E003 |  test loss  5.971; ppl    391.93 | accu 0.2097 = 23534/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:41:31.180] End E003 |  test loss  4.800; ppl    121.48 | accu 0.2117 = 24430/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 13:41:31.180] Save: model.pt... 
[2022-04-13 13:41:31.810] Save: model.pt...Done. best_val_loss: 5.3767
[2022-04-13 13:41:31.811] Epoch 004/20 ==================================================
[2022-04-13 13:42:43.649] E004 |   200/1398 batches | lr 20.0000 | loss  4.997 | ppl    147.96 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 13:43:57.441] E004 |   400/1398 batches | lr 20.0000 | loss  4.982 | ppl    145.80 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 13:45:07.561] E004 |   600/1398 batches | lr 20.0000 | loss  4.901 | ppl    134.37 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 13:46:22.163] E004 |   800/1398 batches | lr 20.0000 | loss  4.993 | ppl    147.35 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 13:47:35.598] E004 |  1000/1398 batches | lr 20.0000 | loss  4.931 | ppl    138.58 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 13:48:47.198] E004 |  1200/1398 batches | lr 20.0000 | loss  4.874 | ppl    130.79 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 13:49:59.480] E004 |  1398/1398 batches | lr 20.0000 | loss  4.833 | ppl    125.58 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 13:50:28.224] End E004 | valid loss  5.313; ppl    202.86 | accu 0.2165 = 49278/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 13:51:32.587] End E004 |  test loss  8.129; ppl   3390.59 | accu 0.0879 = 44548/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 13:51:46.842] End E004 |  test loss  5.902; ppl    365.86 | accu 0.2147 = 24099/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:52:01.195] End E004 |  test loss  4.740; ppl    114.49 | accu 0.2183 = 25189/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 13:52:01.196] Save: model.pt... 
[2022-04-13 13:52:01.818] Save: model.pt...Done. best_val_loss: 5.3125
[2022-04-13 13:52:01.818] Epoch 005/20 ==================================================
[2022-04-13 13:53:13.875] E005 |   200/1398 batches | lr 20.0000 | loss  4.856 | ppl    128.57 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 13:54:25.419] E005 |   400/1398 batches | lr 20.0000 | loss  4.847 | ppl    127.31 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 13:55:35.626] E005 |   600/1398 batches | lr 20.0000 | loss  4.770 | ppl    117.89 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 13:56:50.064] E005 |   800/1398 batches | lr 20.0000 | loss  4.866 | ppl    129.85 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 13:58:01.557] E005 |  1000/1398 batches | lr 20.0000 | loss  4.804 | ppl    121.99 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 13:59:14.008] E005 |  1200/1398 batches | lr 20.0000 | loss  4.749 | ppl    115.52 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 14:00:25.262] E005 |  1398/1398 batches | lr 20.0000 | loss  4.713 | ppl    111.37 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 14:00:54.307] End E005 | valid loss  5.287; ppl    197.83 | accu 0.2160 = 49165/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 14:01:58.971] End E005 |  test loss  8.166; ppl   3520.58 | accu 0.0842 = 42662/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:02:14.968] End E005 |  test loss  5.874; ppl    355.71 | accu 0.2120 = 23796/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:02:29.615] End E005 |  test loss  4.715; ppl    111.57 | accu 0.2200 = 25384/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:02:29.616] Save: model.pt... 
[2022-04-13 14:02:30.249] Save: model.pt...Done. best_val_loss: 5.2874
[2022-04-13 14:02:30.249] Epoch 006/20 ==================================================
[2022-04-13 14:03:41.915] E006 |   200/1398 batches | lr 20.0000 | loss  4.738 | ppl    114.24 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 14:04:55.403] E006 |   400/1398 batches | lr 20.0000 | loss  4.737 | ppl    114.10 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 14:06:09.429] E006 |   600/1398 batches | lr 20.0000 | loss  4.660 | ppl    105.59 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 14:07:23.207] E006 |   800/1398 batches | lr 20.0000 | loss  4.753 | ppl    115.96 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 14:08:37.186] E006 |  1000/1398 batches | lr 20.0000 | loss  4.699 | ppl    109.86 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 14:09:48.067] E006 |  1200/1398 batches | lr 20.0000 | loss  4.646 | ppl    104.14 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 14:10:56.575] E006 |  1398/1398 batches | lr 20.0000 | loss  4.618 | ppl    101.24 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 14:11:25.731] End E006 | valid loss  5.275; ppl    195.44 | accu 0.2193 = 49916/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 14:12:31.405] End E006 |  test loss  8.199; ppl   3637.67 | accu 0.0885 = 44849/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:12:45.644] End E006 |  test loss  5.898; ppl    364.23 | accu 0.2143 = 24049/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:12:59.884] End E006 |  test loss  4.671; ppl    106.81 | accu 0.2240 = 25841/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:12:59.884] Save: model.pt... 
[2022-04-13 14:13:00.512] Save: model.pt...Done. best_val_loss: 5.2753
[2022-04-13 14:13:00.512] Epoch 007/20 ==================================================
[2022-04-13 14:14:11.080] E007 |   200/1398 batches | lr 20.0000 | loss  4.642 | ppl    103.80 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 14:15:23.502] E007 |   400/1398 batches | lr 20.0000 | loss  4.639 | ppl    103.41 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 14:16:34.918] E007 |   600/1398 batches | lr 20.0000 | loss  4.572 | ppl     96.70 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 14:17:48.275] E007 |   800/1398 batches | lr 20.0000 | loss  4.660 | ppl    105.69 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 14:19:01.171] E007 |  1000/1398 batches | lr 20.0000 | loss  4.605 | ppl     99.96 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 14:20:16.132] E007 |  1200/1398 batches | lr 20.0000 | loss  4.558 | ppl     95.44 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 14:21:27.840] E007 |  1398/1398 batches | lr 20.0000 | loss  4.529 | ppl     92.68 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 14:21:56.550] End E007 | valid loss  5.281; ppl    196.51 | accu 0.2211 = 50335/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 14:23:01.556] End E007 |  test loss  8.297; ppl   4012.55 | accu 0.0870 = 44078/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:23:15.881] End E007 |  test loss  5.894; ppl    362.73 | accu 0.2173 = 24380/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:23:30.491] End E007 |  test loss  4.684; ppl    108.23 | accu 0.2246 = 25919/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:23:30.491] Epoch 008/20 ==================================================
[2022-04-13 14:24:42.239] E008 |   200/1398 batches | lr 10.0000 | loss  4.511 | ppl     90.98 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 14:25:52.874] E008 |   400/1398 batches | lr 10.0000 | loss  4.476 | ppl     87.84 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 14:27:02.884] E008 |   600/1398 batches | lr 10.0000 | loss  4.388 | ppl     80.49 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 14:28:17.756] E008 |   800/1398 batches | lr 10.0000 | loss  4.463 | ppl     86.74 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 14:29:29.747] E008 |  1000/1398 batches | lr 10.0000 | loss  4.393 | ppl     80.90 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 14:30:41.552] E008 |  1200/1398 batches | lr 10.0000 | loss  4.333 | ppl     76.19 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 14:31:54.703] E008 |  1398/1398 batches | lr 10.0000 | loss  4.293 | ppl     73.19 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 14:32:24.027] End E008 | valid loss  5.195; ppl    180.32 | accu 0.2315 = 52688/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 14:33:29.767] End E008 |  test loss  8.215; ppl   3694.66 | accu 0.0945 = 47919/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:33:44.585] End E008 |  test loss  5.814; ppl    334.87 | accu 0.2266 = 25432/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:33:59.228] End E008 |  test loss  4.596; ppl     99.12 | accu 0.2358 = 27210/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:33:59.229] Save: model.pt... 
[2022-04-13 14:33:59.854] Save: model.pt...Done. best_val_loss: 5.1947
[2022-04-13 14:33:59.854] Epoch 009/20 ==================================================
[2022-04-13 14:35:13.811] E009 |   200/1398 batches | lr 10.0000 | loss  4.394 | ppl     81.00 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 14:36:24.564] E009 |   400/1398 batches | lr 10.0000 | loss  4.377 | ppl     79.62 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 14:37:35.332] E009 |   600/1398 batches | lr 10.0000 | loss  4.308 | ppl     74.26 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 14:38:49.166] E009 |   800/1398 batches | lr 10.0000 | loss  4.388 | ppl     80.47 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 14:40:00.352] E009 |  1000/1398 batches | lr 10.0000 | loss  4.327 | ppl     75.75 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 14:41:09.675] E009 |  1200/1398 batches | lr 10.0000 | loss  4.275 | ppl     71.88 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 14:42:19.917] E009 |  1398/1398 batches | lr 10.0000 | loss  4.242 | ppl     69.52 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 14:42:48.396] End E009 | valid loss  5.193; ppl    180.00 | accu 0.2323 = 52876/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 14:43:52.112] End E009 |  test loss  8.290; ppl   3984.93 | accu 0.0928 = 47031/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:44:06.508] End E009 |  test loss  5.821; ppl    337.19 | accu 0.2259 = 25355/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:44:20.872] End E009 |  test loss  4.586; ppl     98.06 | accu 0.2381 = 27472/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:44:20.873] Save: model.pt... 
[2022-04-13 14:44:21.492] Save: model.pt...Done. best_val_loss: 5.1930
[2022-04-13 14:44:21.492] Epoch 010/20 ==================================================
[2022-04-13 14:45:32.033] E010 |   200/1398 batches | lr 10.0000 | loss  4.333 | ppl     76.15 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 14:46:41.891] E010 |   400/1398 batches | lr 10.0000 | loss  4.313 | ppl     74.63 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 14:47:54.049] E010 |   600/1398 batches | lr 10.0000 | loss  4.247 | ppl     69.90 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 14:49:06.409] E010 |   800/1398 batches | lr 10.0000 | loss  4.331 | ppl     76.00 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 14:50:18.357] E010 |  1000/1398 batches | lr 10.0000 | loss  4.275 | ppl     71.86 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 14:51:27.800] E010 |  1200/1398 batches | lr 10.0000 | loss  4.220 | ppl     68.04 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 14:52:39.031] E010 |  1398/1398 batches | lr 10.0000 | loss  4.194 | ppl     66.32 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 14:53:10.644] End E010 | valid loss  5.213; ppl    183.72 | accu 0.2326 = 52951/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 14:54:33.336] End E010 |  test loss  8.316; ppl   4088.06 | accu 0.0909 = 46095/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:54:49.883] End E010 |  test loss  5.852; ppl    347.84 | accu 0.2279 = 25570/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:55:04.452] End E010 |  test loss  4.601; ppl     99.59 | accu 0.2365 = 27285/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:55:04.452] Epoch 011/20 ==================================================
[2022-04-13 14:56:17.526] E011 |   200/1398 batches | lr 5.0000 | loss  4.270 | ppl     71.53 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 14:57:30.982] E011 |   400/1398 batches | lr 5.0000 | loss  4.238 | ppl     69.29 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 14:58:41.235] E011 |   600/1398 batches | lr 5.0000 | loss  4.158 | ppl     63.93 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 14:59:57.937] E011 |   800/1398 batches | lr 5.0000 | loss  4.224 | ppl     68.34 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 15:01:11.559] E011 |  1000/1398 batches | lr 5.0000 | loss  4.167 | ppl     64.53 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 15:02:21.261] E011 |  1200/1398 batches | lr 5.0000 | loss  4.104 | ppl     60.57 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 15:03:29.932] E011 |  1398/1398 batches | lr 5.0000 | loss  4.068 | ppl     58.42 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 15:03:58.588] End E011 | valid loss  5.180; ppl    177.72 | accu 0.2364 = 53809/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 15:05:12.552] End E011 |  test loss  8.376; ppl   4339.82 | accu 0.0943 = 47797/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:05:26.909] End E011 |  test loss  5.820; ppl    336.80 | accu 0.2299 = 25797/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:05:41.215] End E011 |  test loss  4.566; ppl     96.21 | accu 0.2420 = 27921/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:05:41.216] Save: model.pt... 
[2022-04-13 15:05:41.969] Save: model.pt...Done. best_val_loss: 5.1802
[2022-04-13 15:05:41.969] Epoch 012/20 ==================================================
[2022-04-13 15:06:53.673] E012 |   200/1398 batches | lr 5.0000 | loss  4.208 | ppl     67.22 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 15:08:03.291] E012 |   400/1398 batches | lr 5.0000 | loss  4.182 | ppl     65.50 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 15:09:16.356] E012 |   600/1398 batches | lr 5.0000 | loss  4.114 | ppl     61.19 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 15:10:32.099] E012 |   800/1398 batches | lr 5.0000 | loss  4.188 | ppl     65.88 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 15:11:44.753] E012 |  1000/1398 batches | lr 5.0000 | loss  4.134 | ppl     62.41 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 15:12:57.020] E012 |  1200/1398 batches | lr 5.0000 | loss  4.081 | ppl     59.20 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 15:14:07.245] E012 |  1398/1398 batches | lr 5.0000 | loss  4.046 | ppl     57.18 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 15:14:36.646] End E012 | valid loss  5.179; ppl    177.54 | accu 0.2372 = 54007/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 15:15:41.220] End E012 |  test loss  8.383; ppl   4373.99 | accu 0.0955 = 48399/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:15:55.555] End E012 |  test loss  5.823; ppl    337.97 | accu 0.2298 = 25784/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:16:10.271] End E012 |  test loss  4.555; ppl     95.09 | accu 0.2442 = 28177/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:16:10.271] Save: model.pt... 
[2022-04-13 15:16:10.933] Save: model.pt...Done. best_val_loss: 5.1792
[2022-04-13 15:16:10.933] Epoch 013/20 ==================================================
[2022-04-13 15:17:23.231] E013 |   200/1398 batches | lr 5.0000 | loss  4.166 | ppl     64.48 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 15:18:35.215] E013 |   400/1398 batches | lr 5.0000 | loss  4.147 | ppl     63.26 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 15:19:45.196] E013 |   600/1398 batches | lr 5.0000 | loss  4.079 | ppl     59.10 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 15:20:59.000] E013 |   800/1398 batches | lr 5.0000 | loss  4.150 | ppl     63.43 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 15:22:12.388] E013 |  1000/1398 batches | lr 5.0000 | loss  4.103 | ppl     60.51 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 15:23:25.345] E013 |  1200/1398 batches | lr 5.0000 | loss  4.053 | ppl     57.54 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 15:24:36.299] E013 |  1398/1398 batches | lr 5.0000 | loss  4.022 | ppl     55.82 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 15:25:05.012] End E013 | valid loss  5.185; ppl    178.52 | accu 0.2373 = 54011/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 15:26:10.120] End E013 |  test loss  8.441; ppl   4634.35 | accu 0.0943 = 47785/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:26:24.384] End E013 |  test loss  5.827; ppl    339.49 | accu 0.2303 = 25848/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:26:38.820] End E013 |  test loss  4.564; ppl     95.97 | accu 0.2437 = 28123/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:26:38.820] Epoch 014/20 ==================================================
[2022-04-13 15:27:52.568] E014 |   200/1398 batches | lr 2.5000 | loss  4.142 | ppl     62.90 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 15:29:03.488] E014 |   400/1398 batches | lr 2.5000 | loss  4.111 | ppl     61.00 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 15:30:14.387] E014 |   600/1398 batches | lr 2.5000 | loss  4.042 | ppl     56.93 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 15:31:29.429] E014 |   800/1398 batches | lr 2.5000 | loss  4.102 | ppl     60.47 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 15:32:43.722] E014 |  1000/1398 batches | lr 2.5000 | loss  4.047 | ppl     57.25 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 15:33:54.772] E014 |  1200/1398 batches | lr 2.5000 | loss  3.986 | ppl     53.83 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 15:35:06.220] E014 |  1398/1398 batches | lr 2.5000 | loss  3.954 | ppl     52.16 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 15:35:35.334] End E014 | valid loss  5.178; ppl    177.29 | accu 0.2391 = 54438/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 15:36:44.660] End E014 |  test loss  8.457; ppl   4709.61 | accu 0.0939 = 47572/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:37:02.143] End E014 |  test loss  5.830; ppl    340.48 | accu 0.2320 = 26031/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:37:16.564] End E014 |  test loss  4.545; ppl     94.12 | accu 0.2460 = 28385/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:37:16.565] Save: model.pt... 
[2022-04-13 15:37:17.222] Save: model.pt...Done. best_val_loss: 5.1778
[2022-04-13 15:37:17.222] Epoch 015/20 ==================================================
[2022-04-13 15:38:31.623] E015 |   200/1398 batches | lr 2.5000 | loss  4.107 | ppl     60.74 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 15:39:45.725] E015 |   400/1398 batches | lr 2.5000 | loss  4.077 | ppl     58.98 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 15:40:57.859] E015 |   600/1398 batches | lr 2.5000 | loss  4.013 | ppl     55.32 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 15:42:11.632] E015 |   800/1398 batches | lr 2.5000 | loss  4.081 | ppl     59.19 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 15:43:27.082] E015 |  1000/1398 batches | lr 2.5000 | loss  4.027 | ppl     56.11 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 15:44:41.791] E015 |  1200/1398 batches | lr 2.5000 | loss  3.973 | ppl     53.16 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 15:45:53.597] E015 |  1398/1398 batches | lr 2.5000 | loss  3.946 | ppl     51.73 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 15:46:22.811] End E015 | valid loss  5.177; ppl    177.21 | accu 0.2395 = 54511/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 15:47:30.877] End E015 |  test loss  8.456; ppl   4703.37 | accu 0.0949 = 48112/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:47:47.646] End E015 |  test loss  5.835; ppl    341.94 | accu 0.2323 = 26064/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:48:02.403] End E015 |  test loss  4.540; ppl     93.66 | accu 0.2464 = 28431/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:48:02.404] Save: model.pt... 
[2022-04-13 15:48:03.051] Save: model.pt...Done. best_val_loss: 5.1774
[2022-04-13 15:48:03.051] Epoch 016/20 ==================================================
[2022-04-13 15:49:16.091] E016 |   200/1398 batches | lr 2.5000 | loss  4.088 | ppl     59.59 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 15:50:26.630] E016 |   400/1398 batches | lr 2.5000 | loss  4.059 | ppl     57.94 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 15:51:40.006] E016 |   600/1398 batches | lr 2.5000 | loss  3.996 | ppl     54.36 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 15:52:55.252] E016 |   800/1398 batches | lr 2.5000 | loss  4.064 | ppl     58.23 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 15:54:09.949] E016 |  1000/1398 batches | lr 2.5000 | loss  4.013 | ppl     55.32 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 15:55:22.545] E016 |  1200/1398 batches | lr 2.5000 | loss  3.956 | ppl     52.27 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 15:56:35.056] E016 |  1398/1398 batches | lr 2.5000 | loss  3.929 | ppl     50.86 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 15:57:04.150] End E016 | valid loss  5.182; ppl    178.11 | accu 0.2386 = 54308/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 15:58:11.736] End E016 |  test loss  8.495; ppl   4891.29 | accu 0.0935 = 47400/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:58:26.078] End E016 |  test loss  5.842; ppl    344.45 | accu 0.2311 = 25939/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:58:41.949] End E016 |  test loss  4.542; ppl     93.90 | accu 0.2456 = 28337/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:58:41.949] Epoch 017/20 ==================================================
[2022-04-13 15:59:56.013] E017 |   200/1398 batches | lr 1.2500 | loss  4.076 | ppl     58.88 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 16:01:07.841] E017 |   400/1398 batches | lr 1.2500 | loss  4.044 | ppl     57.07 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 16:02:20.346] E017 |   600/1398 batches | lr 1.2500 | loss  3.977 | ppl     53.38 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 16:03:35.647] E017 |   800/1398 batches | lr 1.2500 | loss  4.040 | ppl     56.84 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 16:04:49.475] E017 |  1000/1398 batches | lr 1.2500 | loss  3.989 | ppl     54.03 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 16:06:02.940] E017 |  1200/1398 batches | lr 1.2500 | loss  3.927 | ppl     50.74 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 16:07:14.631] E017 |  1398/1398 batches | lr 1.2500 | loss  3.895 | ppl     49.17 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 16:07:45.827] End E017 | valid loss  5.181; ppl    177.90 | accu 0.2400 = 54631/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 16:08:51.243] End E017 |  test loss  8.502; ppl   4925.24 | accu 0.0934 = 47334/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:09:05.779] End E017 |  test loss  5.847; ppl    346.35 | accu 0.2322 = 26056/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:09:20.430] End E017 |  test loss  4.535; ppl     93.21 | accu 0.2473 = 28535/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 16:09:20.430] Epoch 018/20 ==================================================
[2022-04-13 16:10:35.021] E018 |   200/1398 batches | lr 0.6250 | loss  4.064 | ppl     58.22 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 16:11:46.323] E018 |   400/1398 batches | lr 0.6250 | loss  4.031 | ppl     56.33 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 16:12:59.783] E018 |   600/1398 batches | lr 0.6250 | loss  3.962 | ppl     52.58 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 16:14:15.942] E018 |   800/1398 batches | lr 0.6250 | loss  4.027 | ppl     56.12 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 16:15:30.501] E018 |  1000/1398 batches | lr 0.6250 | loss  3.973 | ppl     53.15 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 16:16:42.335] E018 |  1200/1398 batches | lr 0.6250 | loss  3.906 | ppl     49.70 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 16:17:53.344] E018 |  1398/1398 batches | lr 0.6250 | loss  3.877 | ppl     48.26 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 16:18:23.605] End E018 | valid loss  5.181; ppl    177.80 | accu 0.2405 = 54754/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 16:19:30.831] End E018 |  test loss  8.510; ppl   4965.37 | accu 0.0946 = 47943/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:19:45.270] End E018 |  test loss  5.849; ppl    346.96 | accu 0.2329 = 26137/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:19:59.931] End E018 |  test loss  4.533; ppl     93.03 | accu 0.2478 = 28594/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 16:19:59.931] Epoch 019/20 ==================================================
[2022-04-13 16:21:13.542] E019 |   200/1398 batches | lr 0.3125 | loss  4.055 | ppl     57.70 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 16:22:24.356] E019 |   400/1398 batches | lr 0.3125 | loss  4.029 | ppl     56.18 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 16:23:36.073] E019 |   600/1398 batches | lr 0.3125 | loss  3.959 | ppl     52.40 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 16:24:50.460] E019 |   800/1398 batches | lr 0.3125 | loss  4.016 | ppl     55.46 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 16:26:04.118] E019 |  1000/1398 batches | lr 0.3125 | loss  3.966 | ppl     52.80 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 16:27:16.215] E019 |  1200/1398 batches | lr 0.3125 | loss  3.898 | ppl     49.29 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 16:28:29.587] E019 |  1398/1398 batches | lr 0.3125 | loss  3.869 | ppl     47.88 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 16:28:58.784] End E019 | valid loss  5.177; ppl    177.10 | accu 0.2409 = 54848/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 16:30:05.775] End E019 |  test loss  8.505; ppl   4939.24 | accu 0.0952 = 48259/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:30:20.194] End E019 |  test loss  5.844; ppl    345.14 | accu 0.2328 = 26127/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:30:35.052] End E019 |  test loss  4.529; ppl     92.62 | accu 0.2490 = 28726/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 16:30:35.052] Save: model.pt... 
[2022-04-13 16:30:35.718] Save: model.pt...Done. best_val_loss: 5.1767
[2022-04-13 16:30:35.719] Epoch 020/20 ==================================================
[2022-04-13 16:31:48.329] E020 |   200/1398 batches | lr 0.3125 | loss  4.051 | ppl     57.43 frag_cnt/word_cnt=2.811=393514/140000
[2022-04-13 16:33:01.825] E020 |   400/1398 batches | lr 0.3125 | loss  4.019 | ppl     55.64 frag_cnt/word_cnt=2.831=396308/140000
[2022-04-13 16:34:12.039] E020 |   600/1398 batches | lr 0.3125 | loss  3.955 | ppl     52.18 frag_cnt/word_cnt=2.828=395903/140000
[2022-04-13 16:35:26.008] E020 |   800/1398 batches | lr 0.3125 | loss  4.014 | ppl     55.36 frag_cnt/word_cnt=2.868=401547/140000
[2022-04-13 16:36:41.886] E020 |  1000/1398 batches | lr 0.3125 | loss  3.963 | ppl     52.63 frag_cnt/word_cnt=2.868=401482/140000
[2022-04-13 16:37:52.859] E020 |  1200/1398 batches | lr 0.3125 | loss  3.899 | ppl     49.37 frag_cnt/word_cnt=2.849=398806/140000
[2022-04-13 16:39:01.811] E020 |  1398/1398 batches | lr 0.3125 | loss  3.869 | ppl     47.92 frag_cnt/word_cnt=2.829=392120/138600
[2022-04-13 16:39:31.194] End E020 | valid loss  5.175; ppl    176.80 | accu 0.2410 = 54869/227640 | w_len 2.7669 = 629848/227640
[2022-04-13 16:40:36.893] End E020 |  test loss  8.506; ppl   4946.60 | accu 0.0951 = 48181/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:40:51.668] End E020 |  test loss  5.843; ppl    344.96 | accu 0.2329 = 26132/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:41:06.300] End E020 |  test loss  4.526; ppl     92.43 | accu 0.2490 = 28724/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 16:41:06.301] Save: model.pt... 
[2022-04-13 16:41:06.944] Save: model.pt...Done. best_val_loss: 5.1750
[2022-04-13 16:42:18.641] End. test loss  8.51; ppl  4946.60 | accu 0.0951 = 48181/506840 | w_len 3.2474 = 1645900/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:42:33.137] End. test loss  5.84; ppl   344.96 | accu 0.2329 = 26132/112220 | w_len 3.1716 = 355919/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:42:48.992] End. test loss  4.53; ppl    92.43 | accu 0.2490 = 28724/115380 | w_len 2.3732 = 273816/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 16:42:48.992] =========================================================================================
[2022-04-13 16:42:48.992] valid_loss
[2022-04-13 16:42:48.992]  5.79, 5.48, 5.38, 5.31, 5.29, 5.28, 5.28, 5.19, 5.19, 5.21, 5.18, 5.18, 5.18, 5.18, 5.18, 5.18, 5.18, 5.18, 5.18, 5.18
[2022-04-13 16:42:48.992] valid_loss ppl
[2022-04-13 16:42:48.992]   328.51,  238.70,  216.31,  202.86,  197.83,  195.44,  196.51,  180.32,  180.00,  183.72,  177.72,  177.54,  178.52,  177.29,  177.21,  178.11,  177.90,  177.80,  177.10,  176.80
[2022-04-13 16:42:48.993] test_loss of ../data/sample_500k/adult_test.txt
[2022-04-13 16:42:48.993]  8.29, 8.19, 8.15, 8.13, 8.17, 8.20, 8.30, 8.21, 8.29, 8.32, 8.38, 8.38, 8.44, 8.46, 8.46, 8.50, 8.50, 8.51, 8.50, 8.51
[2022-04-13 16:42:48.993] test_loss of ../data/sample_500k/adult_test.txt ppl
[2022-04-13 16:42:48.993]  4002.29, 3614.85, 3453.57, 3390.59, 3520.58, 3637.67, 4012.55, 3694.66, 3984.93, 4088.06, 4339.82, 4373.99, 4634.35, 4709.61, 4703.37, 4891.29, 4925.24, 4965.37, 4939.24, 4946.60
[2022-04-13 16:42:48.993] test_loss of ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:42:48.993]  6.51, 6.06, 5.97, 5.90, 5.87, 5.90, 5.89, 5.81, 5.82, 5.85, 5.82, 5.82, 5.83, 5.83, 5.83, 5.84, 5.85, 5.85, 5.84, 5.84
[2022-04-13 16:42:48.993] test_loss of ../data/sample_500k/adolescent_valid.txt ppl
[2022-04-13 16:42:48.993]   669.14,  430.36,  391.93,  365.86,  355.71,  364.23,  362.73,  334.87,  337.19,  347.84,  336.80,  337.97,  339.49,  340.48,  341.94,  344.45,  346.35,  346.96,  345.14,  344.96
[2022-04-13 16:42:48.993] test_loss of ../data/sample_500k/cbt_valid.txt
[2022-04-13 16:42:48.993]  5.16, 4.90, 4.80, 4.74, 4.71, 4.67, 4.68, 4.60, 4.59, 4.60, 4.57, 4.55, 4.56, 4.54, 4.54, 4.54, 4.53, 4.53, 4.53, 4.53
[2022-04-13 16:42:48.993] test_loss of ../data/sample_500k/cbt_valid.txt ppl
[2022-04-13 16:42:48.993]   174.56,  134.66,  121.48,  114.49,  111.57,  106.81,  108.23,   99.12,   98.06,   99.59,   96.21,   95.09,   95.97,   94.12,   93.66,   93.90,   93.21,   93.03,   92.62,   92.43
[2022-04-13 16:42:48.993] 
[2022-04-13 16:42:48.993] 
[2022-04-13 16:42:48.993] 
