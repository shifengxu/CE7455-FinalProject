[2022-04-13 18:51:57.121] corpus.train_file_list: 2
[2022-04-13 18:51:57.122]         ../data/sample_500k/cbt_train.txt
[2022-04-13 18:51:57.122]         ../data/sample_500k/adolescent_train.txt
[2022-04-13 18:51:57.122] corpus.valid_file_list: 2
[2022-04-13 18:51:57.122]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 18:51:57.122]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:51:57.122] corpus.test_file_list: 3
[2022-04-13 18:51:57.122]         ../data/sample_500k/adult_test.txt
[2022-04-13 18:51:57.122]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:51:57.122]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 18:51:57.122] corpus.subword_vocab_size: 0
[2022-04-13 18:51:57.122] corpus.subword_model = None. Corpus will not use subword.
[2022-04-13 18:51:57.122] corpus tokenize...
[2022-04-13 18:51:57.806]         train tokens: 511735  ../data/sample_500k/cbt_train.txt
[2022-04-13 18:51:58.903]         train tokens: 467267  ../data/sample_500k/adolescent_train.txt
[2022-04-13 18:51:59.049]         valid tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-13 18:51:59.281]         valid tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:51:59.945]         test  tokens: 506878  ../data/sample_500k/adult_test.txt
[2022-04-13 18:52:00.211]         test  tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:52:00.348]         test  tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-13 18:52:00.349] corpus.ntokens      : 100726
[2022-04-13 18:52:00.349] corpus.char_count   : 166
[2022-04-13 18:52:00.349] corpus.char_cnt_dict: 166
[2022-04-13 18:52:00.349] corpus.char_id_dict : 166
[2022-04-13 18:52:00.366] corpus.batchify(2 files, batch_size=20)...
[2022-04-13 18:52:00.367]         tokens_all: 979002
[2022-04-13 18:52:00.367]         batched   :  48950
[2022-04-13 18:52:00.367]         ../data/sample_500k/cbt_train.txt
[2022-04-13 18:52:00.367]         ../data/sample_500k/adolescent_train.txt
[2022-04-13 18:52:00.379] corpus.batchify(2 files, batch_size=20)...
[2022-04-13 18:52:00.379]         tokens_all: 227673
[2022-04-13 18:52:00.379]         batched   :  11383
[2022-04-13 18:52:00.379]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 18:52:00.379]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:52:00.384] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 18:52:00.385]         tokens_all: 506878
[2022-04-13 18:52:00.385]         batched   :  25343
[2022-04-13 18:52:00.385]         ../data/sample_500k/adult_test.txt
[2022-04-13 18:52:00.388] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 18:52:00.388]         tokens_all: 112256
[2022-04-13 18:52:00.388]         batched   :   5612
[2022-04-13 18:52:00.388]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:52:00.389] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 18:52:00.389]         tokens_all: 115417
[2022-04-13 18:52:00.390]         batched   :   5770
[2022-04-13 18:52:00.390]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 18:52:00.390] subword_adapter will be generated due to word_split_mode='Subword.5000'
[2022-04-13 18:52:00.390] SubwordAdapter.file_list: 4
[2022-04-13 18:52:00.390]         ../data/sample_500k/cbt_train.txt
[2022-04-13 18:52:00.390]         ../data/sample_500k/adolescent_train.txt
[2022-04-13 18:52:00.391]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 18:52:00.391]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:52:00.391] SubwordAdapter.subword_vocab_size: 5000
[2022-04-13 18:52:00.391] SubwordAdapter.subword_model.train(4 files)...
[2022-04-13 18:52:01.416] SubwordAdapter.subword_model.train(4 files)...Done
[2022-04-13 18:52:02.120] RNNModel.rnn_type: LSTM
[2022-04-13 18:52:02.120] RNNModel.ntoken  : 100726
[2022-04-13 18:52:02.120] RNNModel.ninp    : 200
[2022-04-13 18:52:02.121] RNNModel.nhid    : 200
[2022-04-13 18:52:02.121] RNNModel.nlayers : 2
[2022-04-13 18:52:02.121] RNNModel.dropout : 0.2
[2022-04-13 18:52:02.121] RNNModel.tie_weights: False
[2022-04-13 18:52:02.121] RNNModel.fragment_aggregate_mode: CNN
[2022-04-13 18:52:02.121] RNNModel.fragment_cnt           : 5002
[2022-04-13 18:52:02.121] RNNModel.fragment_emsize        : 25
[2022-04-13 18:52:02.121] RNNModel.fragment_nhid          : 200
[2022-04-13 18:52:02.124] RNNModel.fragment_embeds     : created
[2022-04-13 18:52:02.124] RNNModel.fragment_cnn3       : created
[2022-04-13 18:52:02.185] Epoch 001/20 ==================================================
[2022-04-13 18:52:20.394] E001 |   200/1398 batches | lr 20.0000 | loss  8.141 | ppl   3432.80 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 18:52:38.583] E001 |   400/1398 batches | lr 20.0000 | loss  6.828 | ppl    922.98 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 18:52:56.741] E001 |   600/1398 batches | lr 20.0000 | loss  6.263 | ppl    524.55 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 18:53:14.890] E001 |   800/1398 batches | lr 20.0000 | loss  6.069 | ppl    432.46 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 18:53:32.924] E001 |  1000/1398 batches | lr 20.0000 | loss  5.873 | ppl    355.33 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 18:53:51.030] E001 |  1200/1398 batches | lr 20.0000 | loss  5.726 | ppl    306.73 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 18:54:09.189] E001 |  1398/1398 batches | lr 20.0000 | loss  5.601 | ppl    270.67 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 18:54:21.114] End E001 | valid loss  5.796; ppl    329.03 | accu 0.1777 = 40458/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 18:54:48.021] End E001 |  test loss  8.192; ppl   3610.26 | accu 0.0712 = 36078/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 18:54:53.880] End E001 |  test loss  6.416; ppl    611.81 | accu 0.1751 = 19648/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:54:59.740] End E001 |  test loss  5.133; ppl    169.47 | accu 0.1887 = 21770/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 18:54:59.740] Save: model.pt... 
[2022-04-13 18:55:00.384] Save: model.pt...Done. best_val_loss: 5.7962
[2022-04-13 18:55:00.384] Epoch 002/20 ==================================================
[2022-04-13 18:55:18.478] E002 |   200/1398 batches | lr 20.0000 | loss  5.539 | ppl    254.53 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 18:55:36.580] E002 |   400/1398 batches | lr 20.0000 | loss  5.472 | ppl    237.99 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 18:55:54.686] E002 |   600/1398 batches | lr 20.0000 | loss  5.348 | ppl    210.24 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 18:56:12.947] E002 |   800/1398 batches | lr 20.0000 | loss  5.415 | ppl    224.71 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 18:56:31.198] E002 |  1000/1398 batches | lr 20.0000 | loss  5.332 | ppl    206.89 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 18:56:49.261] E002 |  1200/1398 batches | lr 20.0000 | loss  5.258 | ppl    192.11 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 18:57:07.201] E002 |  1398/1398 batches | lr 20.0000 | loss  5.203 | ppl    181.83 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 18:57:19.075] End E002 | valid loss  5.473; ppl    238.10 | accu 0.2040 = 46434/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 18:57:45.703] End E002 |  test loss  8.270; ppl   3903.20 | accu 0.0784 = 39721/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 18:57:51.590] End E002 |  test loss  6.067; ppl    431.31 | accu 0.2033 = 22816/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:57:57.472] End E002 |  test loss  4.898; ppl    134.00 | accu 0.2044 = 23586/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 18:57:57.472] Save: model.pt... 
[2022-04-13 18:57:58.091] Save: model.pt...Done. best_val_loss: 5.4727
[2022-04-13 18:57:58.091] Epoch 003/20 ==================================================
[2022-04-13 18:58:15.947] E003 |   200/1398 batches | lr 20.0000 | loss  5.203 | ppl    181.76 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 18:58:34.544] E003 |   400/1398 batches | lr 20.0000 | loss  5.183 | ppl    178.27 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 18:58:52.680] E003 |   600/1398 batches | lr 20.0000 | loss  5.086 | ppl    161.67 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 18:59:10.911] E003 |   800/1398 batches | lr 20.0000 | loss  5.177 | ppl    177.21 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 18:59:29.127] E003 |  1000/1398 batches | lr 20.0000 | loss  5.109 | ppl    165.50 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 18:59:47.401] E003 |  1200/1398 batches | lr 20.0000 | loss  5.048 | ppl    155.63 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:00:05.343] E003 |  1398/1398 batches | lr 20.0000 | loss  5.006 | ppl    149.32 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:00:17.257] End E003 | valid loss  5.375; ppl    215.99 | accu 0.2095 = 47680/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:00:43.976] End E003 |  test loss  8.346; ppl   4213.23 | accu 0.0650 = 32927/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:00:49.860] End E003 |  test loss  5.950; ppl    383.76 | accu 0.2089 = 23445/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:00:55.718] End E003 |  test loss  4.819; ppl    123.85 | accu 0.2098 = 24212/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:00:55.718] Save: model.pt... 
[2022-04-13 19:00:56.339] Save: model.pt...Done. best_val_loss: 5.3752
[2022-04-13 19:00:56.339] Epoch 004/20 ==================================================
[2022-04-13 19:01:14.446] E004 |   200/1398 batches | lr 20.0000 | loss  5.021 | ppl    151.55 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:01:32.488] E004 |   400/1398 batches | lr 20.0000 | loss  5.015 | ppl    150.59 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:01:50.683] E004 |   600/1398 batches | lr 20.0000 | loss  4.930 | ppl    138.40 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:02:08.885] E004 |   800/1398 batches | lr 20.0000 | loss  5.031 | ppl    153.11 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:02:27.109] E004 |  1000/1398 batches | lr 20.0000 | loss  4.969 | ppl    143.84 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:02:45.337] E004 |  1200/1398 batches | lr 20.0000 | loss  4.902 | ppl    134.52 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:03:03.415] E004 |  1398/1398 batches | lr 20.0000 | loss  4.868 | ppl    130.01 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:03:15.345] End E004 | valid loss  5.360; ppl    212.68 | accu 0.2113 = 48110/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:03:42.182] End E004 |  test loss  9.782; ppl  17714.45 | accu 0.0241 = 12195/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:03:48.033] End E004 |  test loss  5.959; ppl    387.18 | accu 0.2076 = 23293/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:03:53.916] End E004 |  test loss  4.779; ppl    119.03 | accu 0.2148 = 24781/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:03:53.916] Save: model.pt... 
[2022-04-13 19:03:54.533] Save: model.pt...Done. best_val_loss: 5.3598
[2022-04-13 19:03:54.533] Epoch 005/20 ==================================================
[2022-04-13 19:04:12.760] E005 |   200/1398 batches | lr 20.0000 | loss  4.892 | ppl    133.26 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:04:31.043] E005 |   400/1398 batches | lr 20.0000 | loss  4.895 | ppl    133.65 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:04:49.335] E005 |   600/1398 batches | lr 20.0000 | loss  4.809 | ppl    122.60 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:05:07.691] E005 |   800/1398 batches | lr 20.0000 | loss  4.913 | ppl    136.03 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:05:26.024] E005 |  1000/1398 batches | lr 20.0000 | loss  4.846 | ppl    127.19 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:05:44.387] E005 |  1200/1398 batches | lr 20.0000 | loss  4.787 | ppl    119.92 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:06:02.407] E005 |  1398/1398 batches | lr 20.0000 | loss  4.759 | ppl    116.63 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:06:14.281] End E005 | valid loss  5.329; ppl    206.23 | accu 0.2138 = 48672/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:06:40.850] End E005 |  test loss  8.271; ppl   3910.60 | accu 0.0821 = 41633/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:06:46.730] End E005 |  test loss  5.934; ppl    377.53 | accu 0.2102 = 23585/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:06:52.568] End E005 |  test loss  4.741; ppl    114.52 | accu 0.2171 = 25053/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:06:52.569] Save: model.pt... 
[2022-04-13 19:06:53.191] Save: model.pt...Done. best_val_loss: 5.3290
[2022-04-13 19:06:53.191] Epoch 006/20 ==================================================
[2022-04-13 19:07:11.328] E006 |   200/1398 batches | lr 20.0000 | loss  4.786 | ppl    119.86 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:07:29.696] E006 |   400/1398 batches | lr 20.0000 | loss  4.790 | ppl    120.33 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:07:47.950] E006 |   600/1398 batches | lr 20.0000 | loss  4.718 | ppl    111.96 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:08:06.169] E006 |   800/1398 batches | lr 20.0000 | loss  4.823 | ppl    124.35 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:08:24.609] E006 |  1000/1398 batches | lr 20.0000 | loss  4.753 | ppl    115.92 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:08:43.016] E006 |  1200/1398 batches | lr 20.0000 | loss  4.697 | ppl    109.60 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:09:01.175] E006 |  1398/1398 batches | lr 20.0000 | loss  4.664 | ppl    106.06 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:09:13.038] End E006 | valid loss  5.309; ppl    202.20 | accu 0.2157 = 49101/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:09:39.733] End E006 |  test loss  8.490; ppl   4863.71 | accu 0.0720 = 36501/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:09:45.608] End E006 |  test loss  5.919; ppl    372.13 | accu 0.2107 = 23649/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:09:51.460] End E006 |  test loss  4.717; ppl    111.83 | accu 0.2202 = 25411/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:09:51.461] Save: model.pt... 
[2022-04-13 19:09:52.083] Save: model.pt...Done. best_val_loss: 5.3092
[2022-04-13 19:09:52.083] Epoch 007/20 ==================================================
[2022-04-13 19:10:10.414] E007 |   200/1398 batches | lr 20.0000 | loss  4.698 | ppl    109.70 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:10:28.739] E007 |   400/1398 batches | lr 20.0000 | loss  4.705 | ppl    110.52 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:10:46.721] E007 |   600/1398 batches | lr 20.0000 | loss  4.637 | ppl    103.20 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:11:05.139] E007 |   800/1398 batches | lr 20.0000 | loss  4.743 | ppl    114.73 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:11:23.441] E007 |  1000/1398 batches | lr 20.0000 | loss  4.671 | ppl    106.75 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:11:41.715] E007 |  1200/1398 batches | lr 20.0000 | loss  4.616 | ppl    101.13 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:11:59.824] E007 |  1398/1398 batches | lr 20.0000 | loss  4.589 | ppl     98.43 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:12:11.727] End E007 | valid loss  5.298; ppl    199.90 | accu 0.2182 = 49676/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:12:38.569] End E007 |  test loss  8.670; ppl   5825.10 | accu 0.0635 = 32195/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:12:44.428] End E007 |  test loss  5.913; ppl    369.73 | accu 0.2149 = 24120/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:12:50.312] End E007 |  test loss  4.700; ppl    109.99 | accu 0.2212 = 25523/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:12:50.312] Save: model.pt... 
[2022-04-13 19:12:50.938] Save: model.pt...Done. best_val_loss: 5.2978
[2022-04-13 19:12:50.938] Epoch 008/20 ==================================================
[2022-04-13 19:13:09.122] E008 |   200/1398 batches | lr 20.0000 | loss  4.626 | ppl    102.12 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:13:27.545] E008 |   400/1398 batches | lr 20.0000 | loss  4.633 | ppl    102.78 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:13:46.022] E008 |   600/1398 batches | lr 20.0000 | loss  4.558 | ppl     95.42 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:14:04.396] E008 |   800/1398 batches | lr 20.0000 | loss  4.664 | ppl    106.04 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:14:22.533] E008 |  1000/1398 batches | lr 20.0000 | loss  4.597 | ppl     99.20 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:14:40.788] E008 |  1200/1398 batches | lr 20.0000 | loss  4.546 | ppl     94.25 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:14:58.949] E008 |  1398/1398 batches | lr 20.0000 | loss  4.520 | ppl     91.80 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:15:10.861] End E008 | valid loss  5.280; ppl    196.45 | accu 0.2180 = 49628/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:15:37.694] End E008 |  test loss  8.278; ppl   3935.60 | accu 0.0852 = 43166/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:15:43.583] End E008 |  test loss  5.896; ppl    363.70 | accu 0.2122 = 23810/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:15:49.473] End E008 |  test loss  4.683; ppl    108.07 | accu 0.2236 = 25803/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:15:49.473] Save: model.pt... 
[2022-04-13 19:15:50.113] Save: model.pt...Done. best_val_loss: 5.2804
[2022-04-13 19:15:50.113] Epoch 009/20 ==================================================
[2022-04-13 19:16:08.297] E009 |   200/1398 batches | lr 20.0000 | loss  4.555 | ppl     95.11 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:16:26.721] E009 |   400/1398 batches | lr 20.0000 | loss  4.570 | ppl     96.57 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:16:45.028] E009 |   600/1398 batches | lr 20.0000 | loss  4.500 | ppl     90.06 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:17:03.393] E009 |   800/1398 batches | lr 20.0000 | loss  4.598 | ppl     99.30 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:17:21.714] E009 |  1000/1398 batches | lr 20.0000 | loss  4.527 | ppl     92.47 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:17:40.040] E009 |  1200/1398 batches | lr 20.0000 | loss  4.483 | ppl     88.52 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:17:58.123] E009 |  1398/1398 batches | lr 20.0000 | loss  4.459 | ppl     86.44 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:18:10.012] End E009 | valid loss  5.287; ppl    197.75 | accu 0.2192 = 49891/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:18:36.545] End E009 |  test loss  8.291; ppl   3989.36 | accu 0.0876 = 44416/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:18:42.382] End E009 |  test loss  5.912; ppl    369.29 | accu 0.2144 = 24063/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:18:48.208] End E009 |  test loss  4.680; ppl    107.81 | accu 0.2235 = 25788/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:18:48.208] Epoch 010/20 ==================================================
[2022-04-13 19:19:06.452] E010 |   200/1398 batches | lr 10.0000 | loss  4.443 | ppl     85.03 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:19:24.808] E010 |   400/1398 batches | lr 10.0000 | loss  4.419 | ppl     83.00 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:19:43.088] E010 |   600/1398 batches | lr 10.0000 | loss  4.332 | ppl     76.09 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:20:01.511] E010 |   800/1398 batches | lr 10.0000 | loss  4.409 | ppl     82.19 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:20:19.854] E010 |  1000/1398 batches | lr 10.0000 | loss  4.331 | ppl     76.01 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:20:38.217] E010 |  1200/1398 batches | lr 10.0000 | loss  4.269 | ppl     71.46 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:20:56.344] E010 |  1398/1398 batches | lr 10.0000 | loss  4.234 | ppl     69.00 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:21:08.254] End E010 | valid loss  5.217; ppl    184.41 | accu 0.2290 = 52140/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:21:35.074] End E010 |  test loss  8.416; ppl   4518.69 | accu 0.0886 = 44891/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:21:40.927] End E010 |  test loss  5.851; ppl    347.63 | accu 0.2237 = 25102/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:21:46.808] End E010 |  test loss  4.603; ppl     99.77 | accu 0.2342 = 27027/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:21:46.808] Save: model.pt... 
[2022-04-13 19:21:47.431] Save: model.pt...Done. best_val_loss: 5.2172
[2022-04-13 19:21:47.431] Epoch 011/20 ==================================================
[2022-04-13 19:22:05.644] E011 |   200/1398 batches | lr 10.0000 | loss  4.335 | ppl     76.30 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:22:23.910] E011 |   400/1398 batches | lr 10.0000 | loss  4.328 | ppl     75.78 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:22:41.971] E011 |   600/1398 batches | lr 10.0000 | loss  4.257 | ppl     70.61 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:23:00.393] E011 |   800/1398 batches | lr 10.0000 | loss  4.344 | ppl     76.98 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:23:18.752] E011 |  1000/1398 batches | lr 10.0000 | loss  4.274 | ppl     71.78 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:23:37.109] E011 |  1200/1398 batches | lr 10.0000 | loss  4.217 | ppl     67.86 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:23:55.241] E011 |  1398/1398 batches | lr 10.0000 | loss  4.193 | ppl     66.22 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:24:07.097] End E011 | valid loss  5.211; ppl    183.27 | accu 0.2304 = 52455/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:24:33.741] End E011 |  test loss  8.439; ppl   4621.95 | accu 0.0905 = 45859/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:24:39.582] End E011 |  test loss  5.846; ppl    345.77 | accu 0.2245 = 25192/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:24:45.469] End E011 |  test loss  4.596; ppl     99.06 | accu 0.2362 = 27249/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:24:45.469] Save: model.pt... 
[2022-04-13 19:24:46.097] Save: model.pt...Done. best_val_loss: 5.2109
[2022-04-13 19:24:46.097] Epoch 012/20 ==================================================
[2022-04-13 19:25:04.401] E012 |   200/1398 batches | lr 10.0000 | loss  4.279 | ppl     72.17 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:25:22.712] E012 |   400/1398 batches | lr 10.0000 | loss  4.279 | ppl     72.17 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:25:41.016] E012 |   600/1398 batches | lr 10.0000 | loss  4.207 | ppl     67.15 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:25:59.338] E012 |   800/1398 batches | lr 10.0000 | loss  4.296 | ppl     73.38 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:26:17.672] E012 |  1000/1398 batches | lr 10.0000 | loss  4.228 | ppl     68.59 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:26:35.933] E012 |  1200/1398 batches | lr 10.0000 | loss  4.171 | ppl     64.76 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:26:54.093] E012 |  1398/1398 batches | lr 10.0000 | loss  4.151 | ppl     63.47 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:27:05.922] End E012 | valid loss  5.222; ppl    185.33 | accu 0.2306 = 52483/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:27:32.460] End E012 |  test loss  8.483; ppl   4831.80 | accu 0.0896 = 45403/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:27:38.273] End E012 |  test loss  5.865; ppl    352.35 | accu 0.2260 = 25362/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:27:44.081] End E012 |  test loss  4.600; ppl     99.47 | accu 0.2351 = 27129/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:27:44.081] Epoch 013/20 ==================================================
[2022-04-13 19:28:02.276] E013 |   200/1398 batches | lr 5.0000 | loss  4.221 | ppl     68.13 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:28:20.669] E013 |   400/1398 batches | lr 5.0000 | loss  4.204 | ppl     66.96 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:28:39.105] E013 |   600/1398 batches | lr 5.0000 | loss  4.125 | ppl     61.88 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:28:57.451] E013 |   800/1398 batches | lr 5.0000 | loss  4.196 | ppl     66.43 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:29:15.765] E013 |  1000/1398 batches | lr 5.0000 | loss  4.123 | ppl     61.76 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:29:34.065] E013 |  1200/1398 batches | lr 5.0000 | loss  4.061 | ppl     58.04 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:29:52.199] E013 |  1398/1398 batches | lr 5.0000 | loss  4.029 | ppl     56.23 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:30:04.042] End E013 | valid loss  5.191; ppl    179.63 | accu 0.2352 = 53534/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:30:30.604] End E013 |  test loss  8.516; ppl   4994.35 | accu 0.0911 = 46173/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:30:36.420] End E013 |  test loss  5.840; ppl    343.89 | accu 0.2286 = 25648/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:30:42.235] End E013 |  test loss  4.561; ppl     95.70 | accu 0.2412 = 27829/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:30:42.235] Save: model.pt... 
[2022-04-13 19:30:42.855] Save: model.pt...Done. best_val_loss: 5.1909
[2022-04-13 19:30:42.855] Epoch 014/20 ==================================================
[2022-04-13 19:31:01.048] E014 |   200/1398 batches | lr 5.0000 | loss  4.162 | ppl     64.17 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:31:19.380] E014 |   400/1398 batches | lr 5.0000 | loss  4.149 | ppl     63.37 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:31:37.655] E014 |   600/1398 batches | lr 5.0000 | loss  4.084 | ppl     59.39 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:31:55.996] E014 |   800/1398 batches | lr 5.0000 | loss  4.160 | ppl     64.04 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:32:14.024] E014 |  1000/1398 batches | lr 5.0000 | loss  4.095 | ppl     60.02 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:32:31.872] E014 |  1200/1398 batches | lr 5.0000 | loss  4.032 | ppl     56.35 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:32:50.079] E014 |  1398/1398 batches | lr 5.0000 | loss  4.010 | ppl     55.15 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:33:01.924] End E014 | valid loss  5.194; ppl    180.20 | accu 0.2359 = 53711/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:33:28.547] End E014 |  test loss  8.517; ppl   5001.03 | accu 0.0920 = 46614/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:33:34.396] End E014 |  test loss  5.850; ppl    347.38 | accu 0.2291 = 25712/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:33:40.409] End E014 |  test loss  4.559; ppl     95.49 | accu 0.2424 = 27968/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:33:40.409] Epoch 015/20 ==================================================
[2022-04-13 19:33:58.568] E015 |   200/1398 batches | lr 2.5000 | loss  4.133 | ppl     62.36 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:34:16.980] E015 |   400/1398 batches | lr 2.5000 | loss  4.117 | ppl     61.39 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:34:35.356] E015 |   600/1398 batches | lr 2.5000 | loss  4.039 | ppl     56.79 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:34:53.732] E015 |   800/1398 batches | lr 2.5000 | loss  4.109 | ppl     60.86 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:35:12.032] E015 |  1000/1398 batches | lr 2.5000 | loss  4.040 | ppl     56.83 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:35:30.259] E015 |  1200/1398 batches | lr 2.5000 | loss  3.976 | ppl     53.32 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:35:48.397] E015 |  1398/1398 batches | lr 2.5000 | loss  3.946 | ppl     51.75 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:36:00.209] End E015 | valid loss  5.182; ppl    178.01 | accu 0.2385 = 54297/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:36:26.800] End E015 |  test loss  8.543; ppl   5131.26 | accu 0.0920 = 46631/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:36:32.637] End E015 |  test loss  5.844; ppl    345.06 | accu 0.2314 = 25963/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:36:38.472] End E015 |  test loss  4.542; ppl     93.88 | accu 0.2450 = 28267/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:36:38.472] Save: model.pt... 
[2022-04-13 19:36:39.135] Save: model.pt...Done. best_val_loss: 5.1819
[2022-04-13 19:36:39.135] Epoch 016/20 ==================================================
[2022-04-13 19:36:57.326] E016 |   200/1398 batches | lr 2.5000 | loss  4.102 | ppl     60.44 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:37:15.646] E016 |   400/1398 batches | lr 2.5000 | loss  4.081 | ppl     59.21 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:37:34.013] E016 |   600/1398 batches | lr 2.5000 | loss  4.018 | ppl     55.58 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:37:52.382] E016 |   800/1398 batches | lr 2.5000 | loss  4.086 | ppl     59.52 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:38:10.708] E016 |  1000/1398 batches | lr 2.5000 | loss  4.020 | ppl     55.73 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:38:29.057] E016 |  1200/1398 batches | lr 2.5000 | loss  3.962 | ppl     52.58 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:38:47.103] E016 |  1398/1398 batches | lr 2.5000 | loss  3.934 | ppl     51.11 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:38:58.905] End E016 | valid loss  5.182; ppl    178.08 | accu 0.2392 = 54451/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:39:25.396] End E016 |  test loss  8.548; ppl   5158.21 | accu 0.0929 = 47108/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:39:31.216] End E016 |  test loss  5.845; ppl    345.53 | accu 0.2319 = 26019/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:39:37.053] End E016 |  test loss  4.540; ppl     93.73 | accu 0.2460 = 28389/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:39:37.053] Epoch 017/20 ==================================================
[2022-04-13 19:39:55.204] E017 |   200/1398 batches | lr 1.2500 | loss  4.086 | ppl     59.49 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:40:13.536] E017 |   400/1398 batches | lr 1.2500 | loss  4.070 | ppl     58.55 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:40:31.847] E017 |   600/1398 batches | lr 1.2500 | loss  3.999 | ppl     54.52 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:40:50.256] E017 |   800/1398 batches | lr 1.2500 | loss  4.065 | ppl     58.27 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:41:08.576] E017 |  1000/1398 batches | lr 1.2500 | loss  3.997 | ppl     54.41 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:41:26.902] E017 |  1200/1398 batches | lr 1.2500 | loss  3.930 | ppl     50.91 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:41:44.550] E017 |  1398/1398 batches | lr 1.2500 | loss  3.902 | ppl     49.51 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:41:56.386] End E017 | valid loss  5.177; ppl    177.14 | accu 0.2399 = 54610/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:42:22.942] End E017 |  test loss  8.560; ppl   5216.99 | accu 0.0926 = 46953/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:42:28.760] End E017 |  test loss  5.843; ppl    344.73 | accu 0.2326 = 26105/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:42:34.589] End E017 |  test loss  4.531; ppl     92.90 | accu 0.2465 = 28438/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:42:34.589] Save: model.pt... 
[2022-04-13 19:42:35.270] Save: model.pt...Done. best_val_loss: 5.1769
[2022-04-13 19:42:35.270] Epoch 018/20 ==================================================
[2022-04-13 19:42:53.533] E018 |   200/1398 batches | lr 1.2500 | loss  4.065 | ppl     58.29 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:43:11.871] E018 |   400/1398 batches | lr 1.2500 | loss  4.052 | ppl     57.54 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:43:30.187] E018 |   600/1398 batches | lr 1.2500 | loss  3.983 | ppl     53.70 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:43:48.519] E018 |   800/1398 batches | lr 1.2500 | loss  4.054 | ppl     57.63 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:44:06.824] E018 |  1000/1398 batches | lr 1.2500 | loss  3.991 | ppl     54.10 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:44:25.184] E018 |  1200/1398 batches | lr 1.2500 | loss  3.924 | ppl     50.58 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:44:43.328] E018 |  1398/1398 batches | lr 1.2500 | loss  3.899 | ppl     49.36 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:44:55.117] End E018 | valid loss  5.181; ppl    177.83 | accu 0.2401 = 54649/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:45:21.663] End E018 |  test loss  8.551; ppl   5170.06 | accu 0.0930 = 47146/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:45:27.459] End E018 |  test loss  5.850; ppl    347.21 | accu 0.2326 = 26107/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:45:33.259] End E018 |  test loss  4.532; ppl     92.97 | accu 0.2470 = 28503/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:45:33.259] Epoch 019/20 ==================================================
[2022-04-13 19:45:51.449] E019 |   200/1398 batches | lr 0.6250 | loss  4.063 | ppl     58.14 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:46:09.757] E019 |   400/1398 batches | lr 0.6250 | loss  4.046 | ppl     57.19 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:46:28.097] E019 |   600/1398 batches | lr 0.6250 | loss  3.977 | ppl     53.35 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:46:46.476] E019 |   800/1398 batches | lr 0.6250 | loss  4.038 | ppl     56.73 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:47:04.826] E019 |  1000/1398 batches | lr 0.6250 | loss  3.976 | ppl     53.32 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:47:23.160] E019 |  1200/1398 batches | lr 0.6250 | loss  3.907 | ppl     49.77 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:47:41.303] E019 |  1398/1398 batches | lr 0.6250 | loss  3.880 | ppl     48.41 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:47:53.096] End E019 | valid loss  5.177; ppl    177.06 | accu 0.2406 = 54759/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:48:19.703] End E019 |  test loss  8.543; ppl   5128.60 | accu 0.0934 = 47354/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:48:25.544] End E019 |  test loss  5.847; ppl    346.23 | accu 0.2329 = 26134/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:48:31.363] End E019 |  test loss  4.526; ppl     92.41 | accu 0.2476 = 28570/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:48:31.363] Save: model.pt... 
[2022-04-13 19:48:32.025] Save: model.pt...Done. best_val_loss: 5.1765
[2022-04-13 19:48:32.025] Epoch 020/20 ==================================================
[2022-04-13 19:48:50.184] E020 |   200/1398 batches | lr 0.6250 | loss  4.050 | ppl     57.37 frag_cnt/word_cnt=1.516=212212/140000
[2022-04-13 19:49:08.469] E020 |   400/1398 batches | lr 0.6250 | loss  4.036 | ppl     56.63 frag_cnt/word_cnt=1.555=217696/140000
[2022-04-13 19:49:26.739] E020 |   600/1398 batches | lr 0.6250 | loss  3.964 | ppl     52.69 frag_cnt/word_cnt=1.542=215887/140000
[2022-04-13 19:49:45.153] E020 |   800/1398 batches | lr 0.6250 | loss  4.035 | ppl     56.57 frag_cnt/word_cnt=1.563=218797/140000
[2022-04-13 19:50:03.628] E020 |  1000/1398 batches | lr 0.6250 | loss  3.970 | ppl     52.99 frag_cnt/word_cnt=1.558=218091/140000
[2022-04-13 19:50:21.966] E020 |  1200/1398 batches | lr 0.6250 | loss  3.907 | ppl     49.73 frag_cnt/word_cnt=1.548=216776/140000
[2022-04-13 19:50:40.166] E020 |  1398/1398 batches | lr 0.6250 | loss  3.877 | ppl     48.30 frag_cnt/word_cnt=1.536=212852/138600
[2022-04-13 19:50:51.945] End E020 | valid loss  5.176; ppl    177.05 | accu 0.2407 = 54782/227640 | w_len 1.5032 = 342192/227640
[2022-04-13 19:51:18.584] End E020 |  test loss  8.545; ppl   5142.22 | accu 0.0939 = 47577/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:51:24.431] End E020 |  test loss  5.848; ppl    346.48 | accu 0.2331 = 26164/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:51:30.267] End E020 |  test loss  4.526; ppl     92.36 | accu 0.2474 = 28540/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:51:30.267] Save: model.pt... 
[2022-04-13 19:51:30.932] Save: model.pt...Done. best_val_loss: 5.1764
[2022-04-13 19:51:57.856] End. test loss  8.55; ppl  5142.22 | accu 0.0939 = 47577/506840 | w_len 1.6957 = 859471/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:52:03.685] End. test loss  5.85; ppl   346.48 | accu 0.2331 = 26164/112220 | w_len 1.7787 = 199605/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:52:09.491] End. test loss  4.53; ppl    92.36 | accu 0.2474 = 28540/115380 | w_len 1.2352 = 142521/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:52:09.491] =========================================================================================
[2022-04-13 19:52:09.491] valid_loss
[2022-04-13 19:52:09.491]  5.80, 5.47, 5.38, 5.36, 5.33, 5.31, 5.30, 5.28, 5.29, 5.22, 5.21, 5.22, 5.19, 5.19, 5.18, 5.18, 5.18, 5.18, 5.18, 5.18
[2022-04-13 19:52:09.491] valid_loss ppl
[2022-04-13 19:52:09.491]   329.03,  238.10,  215.99,  212.68,  206.23,  202.20,  199.90,  196.45,  197.75,  184.41,  183.27,  185.33,  179.63,  180.20,  178.01,  178.08,  177.14,  177.83,  177.06,  177.05
[2022-04-13 19:52:09.491] test_loss of ../data/sample_500k/adult_test.txt
[2022-04-13 19:52:09.491]  8.19, 8.27, 8.35, 9.78, 8.27, 8.49, 8.67, 8.28, 8.29, 8.42, 8.44, 8.48, 8.52, 8.52, 8.54, 8.55, 8.56, 8.55, 8.54, 8.55
[2022-04-13 19:52:09.491] test_loss of ../data/sample_500k/adult_test.txt ppl
[2022-04-13 19:52:09.491]  3610.26, 3903.20, 4213.23,17714.45, 3910.60, 4863.71, 5825.10, 3935.60, 3989.36, 4518.69, 4621.95, 4831.80, 4994.35, 5001.03, 5131.26, 5158.21, 5216.99, 5170.06, 5128.60, 5142.22
[2022-04-13 19:52:09.491] test_loss of ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:52:09.492]  6.42, 6.07, 5.95, 5.96, 5.93, 5.92, 5.91, 5.90, 5.91, 5.85, 5.85, 5.86, 5.84, 5.85, 5.84, 5.85, 5.84, 5.85, 5.85, 5.85
[2022-04-13 19:52:09.492] test_loss of ../data/sample_500k/adolescent_valid.txt ppl
[2022-04-13 19:52:09.492]   611.81,  431.31,  383.76,  387.18,  377.53,  372.13,  369.73,  363.70,  369.29,  347.63,  345.77,  352.35,  343.89,  347.38,  345.06,  345.53,  344.73,  347.21,  346.23,  346.48
[2022-04-13 19:52:09.492] test_loss of ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:52:09.492]  5.13, 4.90, 4.82, 4.78, 4.74, 4.72, 4.70, 4.68, 4.68, 4.60, 4.60, 4.60, 4.56, 4.56, 4.54, 4.54, 4.53, 4.53, 4.53, 4.53
[2022-04-13 19:52:09.492] test_loss of ../data/sample_500k/cbt_valid.txt ppl
[2022-04-13 19:52:09.492]   169.47,  134.00,  123.85,  119.03,  114.52,  111.83,  109.99,  108.07,  107.81,   99.77,   99.06,   99.47,   95.70,   95.49,   93.88,   93.73,   92.90,   92.97,   92.41,   92.36
[2022-04-13 19:52:09.492] 
[2022-04-13 19:52:09.492] 
[2022-04-13 19:52:09.492] 
