[2022-04-13 14:37:50.482] corpus.train_file_list: 1
[2022-04-13 14:37:50.483]         ../data/sample_500k/adolescent_train.txt
[2022-04-13 14:37:50.483] corpus.valid_file_list: 1
[2022-04-13 14:37:50.483]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:37:50.483] corpus.test_file_list: 2
[2022-04-13 14:37:50.483]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:37:50.483]         ../data/sample_500k/adult_test.txt
[2022-04-13 14:37:50.483] corpus.subword_vocab_size: 0
[2022-04-13 14:37:50.483] corpus.subword_model = None. Corpus will not use subword.
[2022-04-13 14:37:50.483] corpus tokenize...
[2022-04-13 14:37:51.532]         train tokens: 467267  ../data/sample_500k/adolescent_train.txt
[2022-04-13 14:37:51.751]         valid tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:37:51.886]         test  tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:37:52.499]         test  tokens: 506878  ../data/sample_500k/adult_test.txt
[2022-04-13 14:37:52.499] corpus.ntokens      : 95521
[2022-04-13 14:37:52.500] corpus.char_count   : 166
[2022-04-13 14:37:52.500] corpus.char_cnt_dict: 166
[2022-04-13 14:37:52.500] corpus.char_id_dict : 166
[2022-04-13 14:37:52.503] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 14:37:52.503]         tokens_all: 467267
[2022-04-13 14:37:52.503]         batched   :  23363
[2022-04-13 14:37:52.503]         ../data/sample_500k/adolescent_train.txt
[2022-04-13 14:37:52.505] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 14:37:52.506]         tokens_all: 112256
[2022-04-13 14:37:52.506]         batched   :   5612
[2022-04-13 14:37:52.506]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:37:52.507] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 14:37:52.507]         tokens_all: 115417
[2022-04-13 14:37:52.507]         batched   :   5770
[2022-04-13 14:37:52.507]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:37:52.511] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 14:37:52.511]         tokens_all: 506878
[2022-04-13 14:37:52.511]         batched   :  25343
[2022-04-13 14:37:52.511]         ../data/sample_500k/adult_test.txt
[2022-04-13 14:37:52.512] subword_adapter will be generated due to word_split_mode='Subword.500'
[2022-04-13 14:37:52.513] SubwordAdapter.file_list: 2
[2022-04-13 14:37:52.513]         ../data/sample_500k/adolescent_train.txt
[2022-04-13 14:37:52.513]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:37:52.513] SubwordAdapter.subword_vocab_size: 500
[2022-04-13 14:37:52.513] SubwordAdapter.subword_model.train(2 files)...
[2022-04-13 14:37:52.956] SubwordAdapter.subword_model.train(2 files)...Done
[2022-04-13 14:37:53.599] RNNModel.rnn_type: LSTM
[2022-04-13 14:37:53.599] RNNModel.ntoken  : 95521
[2022-04-13 14:37:53.599] RNNModel.ninp    : 200
[2022-04-13 14:37:53.599] RNNModel.nhid    : 200
[2022-04-13 14:37:53.599] RNNModel.nlayers : 2
[2022-04-13 14:37:53.599] RNNModel.dropout : 0.2
[2022-04-13 14:37:53.599] RNNModel.tie_weights: False
[2022-04-13 14:37:53.599] RNNModel.fragment_aggregate_mode: CNN
[2022-04-13 14:37:53.600] RNNModel.fragment_cnt           : 502
[2022-04-13 14:37:53.600] RNNModel.fragment_emsize        : 25
[2022-04-13 14:37:53.600] RNNModel.fragment_nhid          : 200
[2022-04-13 14:37:53.600] RNNModel.fragment_embeds     : created
[2022-04-13 14:37:53.601] RNNModel.fragment_cnn3       : created
[2022-04-13 14:37:53.640] Epoch 001/20 ==================================================
[2022-04-13 14:38:11.388] E001 |   200/667 batches | lr 20.0000 | loss  8.560 | ppl   5219.29 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 14:38:29.288] E001 |   400/667 batches | lr 20.0000 | loss  7.661 | ppl   2123.75 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 14:38:47.088] E001 |   600/667 batches | lr 20.0000 | loss  7.074 | ppl   1181.06 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 14:38:53.072] E001 |   667/667 batches | lr 20.0000 | loss  6.746 | ppl    851.05 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 14:38:58.916] End E001 | valid loss  6.593; ppl    729.70 | accu 0.1743 = 19556/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 14:39:04.676] End E001 |  test loss  7.833; ppl   2522.94 | accu 0.0732 = 8442/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:39:30.821] End E001 |  test loss  9.499; ppl  13344.09 | accu 0.0044 = 2205/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:39:30.821] Save: model.pt... 
[2022-04-13 14:39:31.408] Save: model.pt...Done. best_val_loss: 6.5926
[2022-04-13 14:39:31.409] Epoch 002/20 ==================================================
[2022-04-13 14:39:49.121] E002 |   200/667 batches | lr 20.0000 | loss  6.581 | ppl    720.94 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 14:40:06.944] E002 |   400/667 batches | lr 20.0000 | loss  6.409 | ppl    607.13 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 14:40:24.750] E002 |   600/667 batches | lr 20.0000 | loss  6.197 | ppl    491.14 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 14:40:30.743] E002 |   667/667 batches | lr 20.0000 | loss  6.077 | ppl    435.85 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 14:40:36.567] End E002 | valid loss  6.249; ppl    517.47 | accu 0.1986 = 22289/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 14:40:42.357] End E002 |  test loss  8.549; ppl   5163.77 | accu 0.0648 = 7481/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:41:08.479] End E002 |  test loss 10.737; ppl  46020.98 | accu 0.0051 = 2602/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:41:08.480] Save: model.pt... 
[2022-04-13 14:41:09.055] Save: model.pt...Done. best_val_loss: 6.2490
[2022-04-13 14:41:09.055] Epoch 003/20 ==================================================
[2022-04-13 14:41:26.885] E003 |   200/667 batches | lr 20.0000 | loss  6.035 | ppl    417.66 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 14:41:44.847] E003 |   400/667 batches | lr 20.0000 | loss  5.999 | ppl    402.92 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 14:42:02.763] E003 |   600/667 batches | lr 20.0000 | loss  5.860 | ppl    350.78 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 14:42:08.772] E003 |   667/667 batches | lr 20.0000 | loss  5.772 | ppl    321.08 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 14:42:14.659] End E003 | valid loss  6.058; ppl    427.71 | accu 0.2069 = 23214/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 14:42:20.414] End E003 |  test loss  7.932; ppl   2786.37 | accu 0.0721 = 8318/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:42:46.571] End E003 |  test loss  9.473; ppl  13008.42 | accu 0.0065 = 3272/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:42:46.572] Save: model.pt... 
[2022-04-13 14:42:47.150] Save: model.pt...Done. best_val_loss: 6.0585
[2022-04-13 14:42:47.150] Epoch 004/20 ==================================================
[2022-04-13 14:43:05.021] E004 |   200/667 batches | lr 20.0000 | loss  5.761 | ppl    317.72 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 14:43:23.018] E004 |   400/667 batches | lr 20.0000 | loss  5.738 | ppl    310.54 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 14:43:41.014] E004 |   600/667 batches | lr 20.0000 | loss  5.638 | ppl    280.93 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 14:43:47.057] E004 |   667/667 batches | lr 20.0000 | loss  5.552 | ppl    257.69 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 14:43:52.910] End E004 | valid loss  6.007; ppl    406.27 | accu 0.2089 = 23446/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 14:43:58.668] End E004 |  test loss  8.092; ppl   3266.93 | accu 0.0700 = 8079/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:44:24.994] End E004 |  test loss  9.211; ppl  10006.18 | accu 0.0092 = 4686/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:44:24.994] Save: model.pt... 
[2022-04-13 14:44:25.593] Save: model.pt...Done. best_val_loss: 6.0070
[2022-04-13 14:44:25.593] Epoch 005/20 ==================================================
[2022-04-13 14:44:43.442] E005 |   200/667 batches | lr 20.0000 | loss  5.554 | ppl    258.21 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 14:45:01.353] E005 |   400/667 batches | lr 20.0000 | loss  5.560 | ppl    259.75 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 14:45:19.330] E005 |   600/667 batches | lr 20.0000 | loss  5.470 | ppl    237.48 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 14:45:25.418] E005 |   667/667 batches | lr 20.0000 | loss  5.410 | ppl    223.56 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 14:45:31.316] End E005 | valid loss  6.015; ppl    409.47 | accu 0.2063 = 23153/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 14:45:37.132] End E005 |  test loss  7.866; ppl   2608.35 | accu 0.0744 = 8583/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:46:03.281] End E005 |  test loss  8.561; ppl   5224.07 | accu 0.0278 = 14081/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:46:03.281] Epoch 006/20 ==================================================
[2022-04-13 14:46:21.171] E006 |   200/667 batches | lr 10.0000 | loss  5.289 | ppl    198.10 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 14:46:39.146] E006 |   400/667 batches | lr 10.0000 | loss  5.255 | ppl    191.56 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 14:46:57.180] E006 |   600/667 batches | lr 10.0000 | loss  5.146 | ppl    171.76 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 14:47:03.188] E006 |   667/667 batches | lr 10.0000 | loss  5.065 | ppl    158.33 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 14:47:09.143] End E006 | valid loss  5.895; ppl    363.15 | accu 0.2192 = 24594/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 14:47:15.388] End E006 |  test loss  7.841; ppl   2543.75 | accu 0.0727 = 8389/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:47:42.033] End E006 |  test loss  8.693; ppl   5963.61 | accu 0.0114 = 5775/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:47:42.033] Save: model.pt... 
[2022-04-13 14:47:42.652] Save: model.pt...Done. best_val_loss: 5.8948
[2022-04-13 14:47:42.653] Epoch 007/20 ==================================================
[2022-04-13 14:48:00.565] E007 |   200/667 batches | lr 10.0000 | loss  5.140 | ppl    170.80 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 14:48:18.584] E007 |   400/667 batches | lr 10.0000 | loss  5.131 | ppl    169.18 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 14:48:36.641] E007 |   600/667 batches | lr 10.0000 | loss  5.044 | ppl    155.09 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 14:48:42.677] E007 |   667/667 batches | lr 10.0000 | loss  4.974 | ppl    144.54 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 14:48:48.660] End E007 | valid loss  5.895; ppl    363.09 | accu 0.2198 = 24665/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 14:48:54.511] End E007 |  test loss  7.750; ppl   2322.47 | accu 0.0750 = 8657/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:49:21.038] End E007 |  test loss  8.759; ppl   6370.77 | accu 0.0136 = 6873/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:49:21.038] Save: model.pt... 
[2022-04-13 14:49:21.631] Save: model.pt...Done. best_val_loss: 5.8946
[2022-04-13 14:49:21.631] Epoch 008/20 ==================================================
[2022-04-13 14:49:39.527] E008 |   200/667 batches | lr 10.0000 | loss  5.034 | ppl    153.60 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 14:49:57.533] E008 |   400/667 batches | lr 10.0000 | loss  5.033 | ppl    153.45 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 14:50:15.396] E008 |   600/667 batches | lr 10.0000 | loss  4.954 | ppl    141.68 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 14:50:21.469] E008 |   667/667 batches | lr 10.0000 | loss  4.886 | ppl    132.42 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 14:50:27.440] End E008 | valid loss  5.902; ppl    365.66 | accu 0.2202 = 24715/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 14:50:33.341] End E008 |  test loss  7.615; ppl   2028.34 | accu 0.0748 = 8630/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:50:59.889] End E008 |  test loss  8.573; ppl   5287.30 | accu 0.0127 = 6424/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:50:59.889] Epoch 009/20 ==================================================
[2022-04-13 14:51:17.846] E009 |   200/667 batches | lr 5.0000 | loss  4.909 | ppl    135.46 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 14:51:35.917] E009 |   400/667 batches | lr 5.0000 | loss  4.881 | ppl    131.83 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 14:51:53.992] E009 |   600/667 batches | lr 5.0000 | loss  4.779 | ppl    118.97 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 14:52:00.019] E009 |   667/667 batches | lr 5.0000 | loss  4.706 | ppl    110.63 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 14:52:05.962] End E009 | valid loss  5.886; ppl    359.82 | accu 0.2246 = 25208/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 14:52:11.892] End E009 |  test loss  7.683; ppl   2171.38 | accu 0.0781 = 9012/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:52:38.354] End E009 |  test loss  8.541; ppl   5122.82 | accu 0.0162 = 8234/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:52:38.354] Save: model.pt... 
[2022-04-13 14:52:38.942] Save: model.pt...Done. best_val_loss: 5.8856
[2022-04-13 14:52:38.942] Epoch 010/20 ==================================================
[2022-04-13 14:52:56.767] E010 |   200/667 batches | lr 5.0000 | loss  4.828 | ppl    125.01 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 14:53:14.793] E010 |   400/667 batches | lr 5.0000 | loss  4.816 | ppl    123.49 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 14:53:32.914] E010 |   600/667 batches | lr 5.0000 | loss  4.729 | ppl    113.18 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 14:53:38.955] E010 |   667/667 batches | lr 5.0000 | loss  4.655 | ppl    105.07 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 14:53:44.959] End E010 | valid loss  5.891; ppl    361.86 | accu 0.2249 = 25234/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 14:53:50.817] End E010 |  test loss  7.677; ppl   2157.83 | accu 0.0783 = 9035/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:54:17.623] End E010 |  test loss  8.465; ppl   4743.50 | accu 0.0178 = 9003/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:54:17.623] Epoch 011/20 ==================================================
[2022-04-13 14:54:35.530] E011 |   200/667 batches | lr 2.5000 | loss  4.763 | ppl    117.15 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 14:54:53.538] E011 |   400/667 batches | lr 2.5000 | loss  4.735 | ppl    113.90 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 14:55:11.568] E011 |   600/667 batches | lr 2.5000 | loss  4.631 | ppl    102.62 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 14:55:17.588] E011 |   667/667 batches | lr 2.5000 | loss  4.558 | ppl     95.39 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 14:55:23.495] End E011 | valid loss  5.883; ppl    358.99 | accu 0.2269 = 25459/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 14:55:29.293] End E011 |  test loss  7.653; ppl   2107.41 | accu 0.0792 = 9141/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:55:55.642] End E011 |  test loss  8.442; ppl   4637.17 | accu 0.0193 = 9782/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:55:55.642] Save: model.pt... 
[2022-04-13 14:55:56.222] Save: model.pt...Done. best_val_loss: 5.8833
[2022-04-13 14:55:56.222] Epoch 012/20 ==================================================
[2022-04-13 14:56:13.966] E012 |   200/667 batches | lr 2.5000 | loss  4.716 | ppl    111.70 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 14:56:32.059] E012 |   400/667 batches | lr 2.5000 | loss  4.697 | ppl    109.63 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 14:56:50.115] E012 |   600/667 batches | lr 2.5000 | loss  4.609 | ppl    100.38 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 14:56:56.185] E012 |   667/667 batches | lr 2.5000 | loss  4.536 | ppl     93.33 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 14:57:02.137] End E012 | valid loss  5.883; ppl    358.85 | accu 0.2268 = 25447/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 14:57:07.992] End E012 |  test loss  7.643; ppl   2086.81 | accu 0.0795 = 9176/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:57:34.430] End E012 |  test loss  8.439; ppl   4625.72 | accu 0.0175 = 8884/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:57:34.431] Save: model.pt... 
[2022-04-13 14:57:35.030] Save: model.pt...Done. best_val_loss: 5.8829
[2022-04-13 14:57:35.031] Epoch 013/20 ==================================================
[2022-04-13 14:57:53.407] E013 |   200/667 batches | lr 2.5000 | loss  4.682 | ppl    107.95 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 14:58:11.486] E013 |   400/667 batches | lr 2.5000 | loss  4.670 | ppl    106.67 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 14:58:29.501] E013 |   600/667 batches | lr 2.5000 | loss  4.582 | ppl     97.69 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 14:58:35.542] E013 |   667/667 batches | lr 2.5000 | loss  4.516 | ppl     91.48 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 14:58:41.477] End E013 | valid loss  5.889; ppl    361.10 | accu 0.2267 = 25445/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 14:58:47.325] End E013 |  test loss  7.767; ppl   2360.66 | accu 0.0796 = 9188/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:59:13.951] End E013 |  test loss  8.440; ppl   4630.29 | accu 0.0206 = 10436/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:59:13.951] Epoch 014/20 ==================================================
[2022-04-13 14:59:31.859] E014 |   200/667 batches | lr 1.2500 | loss  4.655 | ppl    105.07 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 14:59:49.939] E014 |   400/667 batches | lr 1.2500 | loss  4.631 | ppl    102.59 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 15:00:07.858] E014 |   600/667 batches | lr 1.2500 | loss  4.534 | ppl     93.13 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 15:00:13.886] E014 |   667/667 batches | lr 1.2500 | loss  4.462 | ppl     86.64 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 15:00:19.841] End E014 | valid loss  5.881; ppl    358.14 | accu 0.2282 = 25603/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 15:00:25.693] End E014 |  test loss  7.643; ppl   2085.89 | accu 0.0797 = 9198/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:00:52.310] End E014 |  test loss  8.362; ppl   4280.45 | accu 0.0214 = 10825/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:00:52.310] Save: model.pt... 
[2022-04-13 15:00:52.909] Save: model.pt...Done. best_val_loss: 5.8809
[2022-04-13 15:00:52.909] Epoch 015/20 ==================================================
[2022-04-13 15:01:10.840] E015 |   200/667 batches | lr 1.2500 | loss  4.629 | ppl    102.43 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 15:01:28.858] E015 |   400/667 batches | lr 1.2500 | loss  4.610 | ppl    100.45 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 15:01:46.874] E015 |   600/667 batches | lr 1.2500 | loss  4.522 | ppl     91.99 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 15:01:52.882] E015 |   667/667 batches | lr 1.2500 | loss  4.453 | ppl     85.87 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 15:01:58.856] End E015 | valid loss  5.883; ppl    359.04 | accu 0.2281 = 25597/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 15:02:04.782] End E015 |  test loss  7.636; ppl   2072.46 | accu 0.0807 = 9310/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:02:31.341] End E015 |  test loss  8.328; ppl   4137.75 | accu 0.0248 = 12564/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:02:31.342] Epoch 016/20 ==================================================
[2022-04-13 15:02:49.200] E016 |   200/667 batches | lr 0.6250 | loss  4.610 | ppl    100.50 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 15:03:07.221] E016 |   400/667 batches | lr 0.6250 | loss  4.590 | ppl     98.50 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 15:03:25.272] E016 |   600/667 batches | lr 0.6250 | loss  4.494 | ppl     89.52 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 15:03:31.299] E016 |   667/667 batches | lr 0.6250 | loss  4.423 | ppl     83.33 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 15:03:37.334] End E016 | valid loss  5.887; ppl    360.49 | accu 0.2289 = 25686/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 15:03:43.237] End E016 |  test loss  7.647; ppl   2093.97 | accu 0.0801 = 9242/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:04:09.845] End E016 |  test loss  8.371; ppl   4318.61 | accu 0.0209 = 10606/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:04:09.845] Epoch 017/20 ==================================================
[2022-04-13 15:04:27.770] E017 |   200/667 batches | lr 0.3125 | loss  4.601 | ppl     99.61 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 15:04:45.806] E017 |   400/667 batches | lr 0.3125 | loss  4.579 | ppl     97.43 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 15:05:03.901] E017 |   600/667 batches | lr 0.3125 | loss  4.482 | ppl     88.40 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 15:05:09.955] E017 |   667/667 batches | lr 0.3125 | loss  4.407 | ppl     82.03 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 15:05:15.920] End E017 | valid loss  5.886; ppl    359.95 | accu 0.2294 = 25745/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 15:05:21.815] End E017 |  test loss  7.622; ppl   2042.10 | accu 0.0796 = 9179/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:05:48.429] End E017 |  test loss  8.369; ppl   4309.97 | accu 0.0207 = 10485/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:05:48.429] Epoch 018/20 ==================================================
[2022-04-13 15:06:06.298] E018 |   200/667 batches | lr 0.1562 | loss  4.596 | ppl     99.07 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 15:06:24.375] E018 |   400/667 batches | lr 0.1562 | loss  4.573 | ppl     96.87 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 15:06:42.507] E018 |   600/667 batches | lr 0.1562 | loss  4.473 | ppl     87.63 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 15:06:48.556] E018 |   667/667 batches | lr 0.1562 | loss  4.399 | ppl     81.34 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 15:06:54.548] End E018 | valid loss  5.884; ppl    359.38 | accu 0.2296 = 25764/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 15:07:00.413] End E018 |  test loss  7.616; ppl   2031.34 | accu 0.0794 = 9163/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:07:27.026] End E018 |  test loss  8.377; ppl   4344.94 | accu 0.0205 = 10408/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:07:27.026] Epoch 019/20 ==================================================
[2022-04-13 15:07:44.877] E019 |   200/667 batches | lr 0.0781 | loss  4.593 | ppl     98.80 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 15:08:02.918] E019 |   400/667 batches | lr 0.0781 | loss  4.570 | ppl     96.51 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 15:08:20.955] E019 |   600/667 batches | lr 0.0781 | loss  4.472 | ppl     87.50 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 15:08:26.990] E019 |   667/667 batches | lr 0.0781 | loss  4.391 | ppl     80.71 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 15:08:32.979] End E019 | valid loss  5.884; ppl    359.08 | accu 0.2296 = 25765/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 15:08:38.884] End E019 |  test loss  7.611; ppl   2020.45 | accu 0.0793 = 9153/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:09:05.649] End E019 |  test loss  8.377; ppl   4344.79 | accu 0.0209 = 10614/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:09:05.649] Epoch 020/20 ==================================================
[2022-04-13 15:09:23.497] E020 |   200/667 batches | lr 0.0391 | loss  4.589 | ppl     98.43 frag_cnt/word_cnt=2.609=365242/140000
[2022-04-13 15:09:41.616] E020 |   400/667 batches | lr 0.0391 | loss  4.571 | ppl     96.69 frag_cnt/word_cnt=2.646=370388/140000
[2022-04-13 15:09:59.627] E020 |   600/667 batches | lr 0.0391 | loss  4.472 | ppl     87.55 frag_cnt/word_cnt=2.630=368153/140000
[2022-04-13 15:10:05.691] E020 |   667/667 batches | lr 0.0391 | loss  4.390 | ppl     80.66 frag_cnt/word_cnt=2.618=122782/46900
[2022-04-13 15:10:11.633] End E020 | valid loss  5.884; ppl    359.28 | accu 0.2298 = 25787/112220 | w_len 2.5007 = 280626/112220
[2022-04-13 15:10:17.492] End E020 |  test loss  7.606; ppl   2010.40 | accu 0.0793 = 9151/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:10:44.012] End E020 |  test loss  8.373; ppl   4329.00 | accu 0.0212 = 10766/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:10:50.057] End. test loss  7.64; ppl  2085.89 | accu 0.0797 = 9198/115380 | w_len 1.8144 = 209350/115380 ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:11:16.712] End. test loss  8.36; ppl  4280.45 | accu 0.0214 = 10825/506840 | w_len 2.4840 = 1258997/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:11:16.712] =========================================================================================
[2022-04-13 15:11:16.713] valid_loss
[2022-04-13 15:11:16.713]  6.59, 6.25, 6.06, 6.01, 6.01, 5.89, 5.89, 5.90, 5.89, 5.89, 5.88, 5.88, 5.89, 5.88, 5.88, 5.89, 5.89, 5.88, 5.88, 5.88
[2022-04-13 15:11:16.713] valid_loss ppl
[2022-04-13 15:11:16.713]   729.70,  517.47,  427.71,  406.27,  409.47,  363.15,  363.09,  365.66,  359.82,  361.86,  358.99,  358.85,  361.10,  358.14,  359.04,  360.49,  359.95,  359.38,  359.08,  359.28
[2022-04-13 15:11:16.713] test_loss of ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:11:16.713]  7.83, 8.55, 7.93, 8.09, 7.87, 7.84, 7.75, 7.61, 7.68, 7.68, 7.65, 7.64, 7.77, 7.64, 7.64, 7.65, 7.62, 7.62, 7.61, 7.61
[2022-04-13 15:11:16.713] test_loss of ../data/sample_500k/cbt_valid.txt ppl
[2022-04-13 15:11:16.713]  2522.94, 5163.77, 2786.37, 3266.93, 2608.35, 2543.75, 2322.47, 2028.34, 2171.38, 2157.83, 2107.41, 2086.81, 2360.66, 2085.89, 2072.46, 2093.97, 2042.10, 2031.34, 2020.45, 2010.40
[2022-04-13 15:11:16.713] test_loss of ../data/sample_500k/adult_test.txt
[2022-04-13 15:11:16.713]  9.50,10.74, 9.47, 9.21, 8.56, 8.69, 8.76, 8.57, 8.54, 8.46, 8.44, 8.44, 8.44, 8.36, 8.33, 8.37, 8.37, 8.38, 8.38, 8.37
[2022-04-13 15:11:16.713] test_loss of ../data/sample_500k/adult_test.txt ppl
[2022-04-13 15:11:16.713] 13344.09,46020.98,13008.42,10006.18, 5224.07, 5963.61, 6370.77, 5287.30, 5122.82, 4743.50, 4637.17, 4625.72, 4630.29, 4280.45, 4137.75, 4318.61, 4309.97, 4344.94, 4344.79, 4329.00
[2022-04-13 15:11:16.713] 
[2022-04-13 15:11:16.713] 
[2022-04-13 15:11:16.713] 
