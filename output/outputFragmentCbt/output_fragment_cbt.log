[2022-04-13 12:11:36.958] args: Namespace(batch_size=20, bptt=35, clip=0.25, data_dir='../data/sample_500k', dropout=0.2, emsize=200, epochs=20, fragment_aggregate_mode_list=['CNN', 'LSTM'], gpu_ids=[1], log_interval=200, lr=20.0, model='LSTM', nhead=2, nhid=200, nlayers=2, save='model.pt', seed=1111, subword_vocab_size=0, test_file_list=['adolescent_valid.txt', 'adult_test.txt'], tied=False, train_file_list=['cbt_train.txt'], valid_file_list=['cbt_valid.txt'], word_split_mode_list=['Subword.200', 'Subword.500', 'Subword.1000', 'Subword.2000', 'Subword.5000', 'Subword.10000'])
[2022-04-13 12:11:36.958] device: cuda:1
Log file: ./output_wsm_Subword.200_fam_CNN.log open...
[2022-04-13 12:11:36.959] corpus.train_file_list: 1
[2022-04-13 12:11:36.959]         ../data/sample_500k/cbt_train.txt
[2022-04-13 12:11:36.959] corpus.valid_file_list: 1
[2022-04-13 12:11:36.959]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 12:11:36.959] corpus.test_file_list: 2
[2022-04-13 12:11:36.959]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:11:36.959]         ../data/sample_500k/adult_test.txt
[2022-04-13 12:11:36.959] corpus.subword_vocab_size: 0
[2022-04-13 12:11:36.959] corpus.subword_model = None. Corpus will not use subword.
[2022-04-13 12:11:36.959] corpus tokenize...
[2022-04-13 12:11:37.655]         train tokens: 511735  ../data/sample_500k/cbt_train.txt
[2022-04-13 12:11:37.800]         valid tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-13 12:11:38.024]         test  tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:11:38.633]         test  tokens: 506878  ../data/sample_500k/adult_test.txt
[2022-04-13 12:11:38.633] corpus.ntokens      : 73236
[2022-04-13 12:11:38.633] corpus.char_count   : 157
[2022-04-13 12:11:38.633] corpus.char_cnt_dict: 157
[2022-04-13 12:11:38.633] corpus.char_id_dict : 157
[2022-04-13 12:11:38.644] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 12:11:38.644]         tokens_all: 511735
[2022-04-13 12:11:38.644]         batched   :  25586
[2022-04-13 12:11:38.644]         ../data/sample_500k/cbt_train.txt
[2022-04-13 12:11:40.351] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 12:11:40.352]         tokens_all: 115417
[2022-04-13 12:11:40.352]         batched   :   5770
[2022-04-13 12:11:40.352]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 12:11:40.354] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 12:11:40.354]         tokens_all: 112256
[2022-04-13 12:11:40.354]         batched   :   5612
[2022-04-13 12:11:40.354]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:11:40.359] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 12:11:40.359]         tokens_all: 506878
[2022-04-13 12:11:40.360]         batched   :  25343
[2022-04-13 12:11:40.360]         ../data/sample_500k/adult_test.txt
[2022-04-13 12:11:40.360] subword_adapter will be generated due to word_split_mode='Subword.200'
[2022-04-13 12:11:40.360] SubwordAdapter.file_list: 2
[2022-04-13 12:11:40.360]         ../data/sample_500k/cbt_train.txt
[2022-04-13 12:11:40.361]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 12:11:40.361] SubwordAdapter.subword_vocab_size: 200
[2022-04-13 12:11:40.361] SubwordAdapter.subword_model.train(2 files)...
[2022-04-13 12:11:40.598] SubwordAdapter.subword_model.train(2 files)...Done
[2022-04-13 12:11:41.088] RNNModel.rnn_type: LSTM
[2022-04-13 12:11:41.088] RNNModel.ntoken  : 73236
[2022-04-13 12:11:41.089] RNNModel.ninp    : 200
[2022-04-13 12:11:41.089] RNNModel.nhid    : 200
[2022-04-13 12:11:41.089] RNNModel.nlayers : 2
[2022-04-13 12:11:41.089] RNNModel.dropout : 0.2
[2022-04-13 12:11:41.089] RNNModel.tie_weights: False
[2022-04-13 12:11:41.089] RNNModel.fragment_aggregate_mode: CNN
[2022-04-13 12:11:41.089] RNNModel.fragment_cnt           : 202
[2022-04-13 12:11:41.089] RNNModel.fragment_emsize        : 25
[2022-04-13 12:11:41.089] RNNModel.fragment_nhid          : 200
[2022-04-13 12:11:41.089] RNNModel.fragment_embeds     : created
[2022-04-13 12:11:41.090] RNNModel.fragment_cnn3       : created
[2022-04-13 12:11:41.276] Epoch 001/20 ==================================================
[2022-04-13 12:11:56.466] E001 |   200/731 batches | lr 20.0000 | loss  7.408 | ppl   1649.42 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:12:11.715] E001 |   400/731 batches | lr 20.0000 | loss  5.989 | ppl    398.82 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:12:26.730] E001 |   600/731 batches | lr 20.0000 | loss  5.351 | ppl    210.91 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:12:36.594] E001 |   731/731 batches | lr 20.0000 | loss  5.187 | ppl    179.02 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:12:41.936] End E001 | valid loss  5.359; ppl    212.44 | accu 0.1528 = 17633/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:12:47.236] End E001 |  test loss  8.902; ppl   7344.12 | accu 0.0282 = 3161/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:13:11.196] End E001 |  test loss  9.040; ppl   8435.13 | accu 0.0283 = 14328/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:13:11.196] Save: model.pt... 
[2022-04-13 12:13:11.646] Save: model.pt...Done. best_val_loss: 5.3586
[2022-04-13 12:13:11.646] Epoch 002/20 ==================================================
[2022-04-13 12:13:26.692] E002 |   200/731 batches | lr 20.0000 | loss  5.043 | ppl    154.86 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:13:42.197] E002 |   400/731 batches | lr 20.0000 | loss  4.938 | ppl    139.53 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:13:57.300] E002 |   600/731 batches | lr 20.0000 | loss  4.744 | ppl    114.95 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:14:07.140] E002 |   731/731 batches | lr 20.0000 | loss  4.700 | ppl    109.91 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:14:12.591] End E002 | valid loss  5.036; ppl    153.89 | accu 0.1834 = 21160/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:14:17.941] End E002 |  test loss  8.768; ppl   6427.16 | accu 0.0457 = 5130/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:14:41.734] End E002 |  test loss  9.043; ppl   8455.80 | accu 0.0450 = 22805/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:14:41.734] Save: model.pt... 
[2022-04-13 12:14:42.172] Save: model.pt...Done. best_val_loss: 5.0362
[2022-04-13 12:14:42.172] Epoch 003/20 ==================================================
[2022-04-13 12:14:57.221] E003 |   200/731 batches | lr 20.0000 | loss  4.653 | ppl    104.92 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:15:12.272] E003 |   400/731 batches | lr 20.0000 | loss  4.628 | ppl    102.32 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:15:27.264] E003 |   600/731 batches | lr 20.0000 | loss  4.493 | ppl     89.42 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:15:37.082] E003 |   731/731 batches | lr 20.0000 | loss  4.474 | ppl     87.74 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:15:42.347] End E003 | valid loss  4.885; ppl    132.28 | accu 0.1958 = 22597/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:15:47.571] End E003 |  test loss  8.750; ppl   6311.87 | accu 0.0474 = 5314/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:16:11.417] End E003 |  test loss  9.063; ppl   8631.42 | accu 0.0481 = 24372/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:16:11.418] Save: model.pt... 
[2022-04-13 12:16:11.844] Save: model.pt...Done. best_val_loss: 4.8849
[2022-04-13 12:16:11.845] Epoch 004/20 ==================================================
[2022-04-13 12:16:26.907] E004 |   200/731 batches | lr 20.0000 | loss  4.454 | ppl     85.94 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:16:42.083] E004 |   400/731 batches | lr 20.0000 | loss  4.444 | ppl     85.12 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:16:57.191] E004 |   600/731 batches | lr 20.0000 | loss  4.339 | ppl     76.61 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:17:07.040] E004 |   731/731 batches | lr 20.0000 | loss  4.321 | ppl     75.24 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:17:12.289] End E004 | valid loss  4.787; ppl    119.94 | accu 0.2026 = 23374/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:17:17.484] End E004 |  test loss  8.982; ppl   7955.31 | accu 0.0408 = 4575/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:17:41.326] End E004 |  test loss  9.302; ppl  10958.35 | accu 0.0393 = 19915/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:17:41.326] Save: model.pt... 
[2022-04-13 12:17:41.760] Save: model.pt...Done. best_val_loss: 4.7870
[2022-04-13 12:17:41.760] Epoch 005/20 ==================================================
[2022-04-13 12:17:56.738] E005 |   200/731 batches | lr 20.0000 | loss  4.311 | ppl     74.53 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:18:11.719] E005 |   400/731 batches | lr 20.0000 | loss  4.314 | ppl     74.71 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:18:26.736] E005 |   600/731 batches | lr 20.0000 | loss  4.223 | ppl     68.26 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:18:36.552] E005 |   731/731 batches | lr 20.0000 | loss  4.203 | ppl     66.89 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:18:41.815] End E005 | valid loss  4.757; ppl    116.37 | accu 0.2068 = 23860/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:18:47.031] End E005 |  test loss  8.837; ppl   6881.28 | accu 0.0486 = 5450/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:19:10.832] End E005 |  test loss  9.035; ppl   8393.73 | accu 0.0518 = 26260/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:19:10.833] Save: model.pt... 
[2022-04-13 12:19:11.260] Save: model.pt...Done. best_val_loss: 4.7567
[2022-04-13 12:19:11.260] Epoch 006/20 ==================================================
[2022-04-13 12:19:26.349] E006 |   200/731 batches | lr 20.0000 | loss  4.202 | ppl     66.84 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:19:41.556] E006 |   400/731 batches | lr 20.0000 | loss  4.208 | ppl     67.20 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:19:56.762] E006 |   600/731 batches | lr 20.0000 | loss  4.123 | ppl     61.76 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:20:06.677] E006 |   731/731 batches | lr 20.0000 | loss  4.104 | ppl     60.59 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:20:11.946] End E006 | valid loss  4.728; ppl    113.10 | accu 0.2112 = 24363/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:20:17.135] End E006 |  test loss  8.712; ppl   6078.37 | accu 0.0518 = 5811/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:20:40.783] End E006 |  test loss  9.194; ppl   9837.60 | accu 0.0478 = 24207/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:20:40.783] Save: model.pt... 
[2022-04-13 12:20:41.213] Save: model.pt...Done. best_val_loss: 4.7283
[2022-04-13 12:20:41.214] Epoch 007/20 ==================================================
[2022-04-13 12:20:56.238] E007 |   200/731 batches | lr 20.0000 | loss  4.101 | ppl     60.39 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:21:11.334] E007 |   400/731 batches | lr 20.0000 | loss  4.112 | ppl     61.09 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:21:26.420] E007 |   600/731 batches | lr 20.0000 | loss  4.034 | ppl     56.49 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:21:36.282] E007 |   731/731 batches | lr 20.0000 | loss  4.017 | ppl     55.54 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:21:41.586] End E007 | valid loss  4.700; ppl    109.90 | accu 0.2161 = 24929/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:21:46.801] End E007 |  test loss  8.925; ppl   7518.89 | accu 0.0494 = 5549/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:22:10.470] End E007 |  test loss  9.320; ppl  11160.73 | accu 0.0502 = 25466/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:22:10.470] Save: model.pt... 
[2022-04-13 12:22:10.897] Save: model.pt...Done. best_val_loss: 4.6996
[2022-04-13 12:22:10.897] Epoch 008/20 ==================================================
[2022-04-13 12:22:25.943] E008 |   200/731 batches | lr 20.0000 | loss  4.013 | ppl     55.33 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:22:41.118] E008 |   400/731 batches | lr 20.0000 | loss  4.027 | ppl     56.11 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:22:56.273] E008 |   600/731 batches | lr 20.0000 | loss  3.958 | ppl     52.33 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:23:06.201] E008 |   731/731 batches | lr 20.0000 | loss  3.937 | ppl     51.25 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:23:11.458] End E008 | valid loss  4.683; ppl    108.14 | accu 0.2214 = 25550/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:23:16.666] End E008 |  test loss  9.016; ppl   8231.56 | accu 0.0545 = 6114/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:23:40.350] End E008 |  test loss  9.383; ppl  11888.98 | accu 0.0529 = 26797/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:23:40.350] Save: model.pt... 
[2022-04-13 12:23:40.777] Save: model.pt...Done. best_val_loss: 4.6834
[2022-04-13 12:23:40.778] Epoch 009/20 ==================================================
[2022-04-13 12:23:55.786] E009 |   200/731 batches | lr 20.0000 | loss  3.941 | ppl     51.46 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:24:11.094] E009 |   400/731 batches | lr 20.0000 | loss  3.963 | ppl     52.63 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:24:26.242] E009 |   600/731 batches | lr 20.0000 | loss  3.887 | ppl     48.74 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:24:36.147] E009 |   731/731 batches | lr 20.0000 | loss  3.870 | ppl     47.95 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:24:41.480] End E009 | valid loss  4.682; ppl    107.97 | accu 0.2253 = 25995/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:24:46.654] End E009 |  test loss  9.071; ppl   8697.40 | accu 0.0545 = 6114/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:25:10.248] End E009 |  test loss  9.641; ppl  15375.15 | accu 0.0501 = 25374/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:25:10.248] Save: model.pt... 
[2022-04-13 12:25:10.675] Save: model.pt...Done. best_val_loss: 4.6819
[2022-04-13 12:25:10.675] Epoch 010/20 ==================================================
[2022-04-13 12:25:25.627] E010 |   200/731 batches | lr 20.0000 | loss  3.879 | ppl     48.39 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:25:41.780] E010 |   400/731 batches | lr 20.0000 | loss  3.898 | ppl     49.29 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:25:58.510] E010 |   600/731 batches | lr 20.0000 | loss  3.826 | ppl     45.87 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:26:08.497] E010 |   731/731 batches | lr 20.0000 | loss  3.811 | ppl     45.22 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:26:13.778] End E010 | valid loss  4.688; ppl    108.63 | accu 0.2208 = 25479/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:26:18.998] End E010 |  test loss  9.268; ppl  10591.81 | accu 0.0503 = 5650/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:26:42.793] End E010 |  test loss  9.971; ppl  21398.76 | accu 0.0446 = 22592/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:26:42.793] Epoch 011/20 ==================================================
[2022-04-13 12:26:57.787] E011 |   200/731 batches | lr 10.0000 | loss  3.768 | ppl     43.28 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:27:12.887] E011 |   400/731 batches | lr 10.0000 | loss  3.744 | ppl     42.25 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:27:28.031] E011 |   600/731 batches | lr 10.0000 | loss  3.637 | ppl     37.98 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:27:37.987] E011 |   731/731 batches | lr 10.0000 | loss  3.592 | ppl     36.32 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:27:43.309] End E011 | valid loss  4.604; ppl     99.93 | accu 0.2403 = 27728/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:27:48.560] End E011 |  test loss  9.362; ppl  11635.42 | accu 0.0560 = 6288/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:28:12.400] End E011 |  test loss 10.070; ppl  23620.69 | accu 0.0516 = 26148/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:28:12.400] Save: model.pt... 
[2022-04-13 12:28:12.832] Save: model.pt...Done. best_val_loss: 4.6044
[2022-04-13 12:28:12.833] Epoch 012/20 ==================================================
[2022-04-13 12:28:29.117] E012 |   200/731 batches | lr 10.0000 | loss  3.671 | ppl     39.30 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:28:44.979] E012 |   400/731 batches | lr 10.0000 | loss  3.673 | ppl     39.36 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:29:00.224] E012 |   600/731 batches | lr 10.0000 | loss  3.585 | ppl     36.05 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:29:10.432] E012 |   731/731 batches | lr 10.0000 | loss  3.553 | ppl     34.92 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:29:15.732] End E012 | valid loss  4.611; ppl    100.61 | accu 0.2402 = 27712/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:29:20.947] End E012 |  test loss  9.475; ppl  13036.16 | accu 0.0565 = 6337/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:29:44.737] End E012 |  test loss 10.223; ppl  27532.43 | accu 0.0530 = 26839/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:29:44.737] Epoch 013/20 ==================================================
[2022-04-13 12:29:59.803] E013 |   200/731 batches | lr 5.0000 | loss  3.603 | ppl     36.72 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:30:14.958] E013 |   400/731 batches | lr 5.0000 | loss  3.592 | ppl     36.32 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:30:30.069] E013 |   600/731 batches | lr 5.0000 | loss  3.483 | ppl     32.56 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:30:40.376] E013 |   731/731 batches | lr 5.0000 | loss  3.435 | ppl     31.04 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:30:46.705] End E013 | valid loss  4.609; ppl    100.34 | accu 0.2444 = 28197/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:30:52.969] End E013 |  test loss  9.605; ppl  14841.40 | accu 0.0571 = 6403/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:31:21.487] End E013 |  test loss 10.125; ppl  24957.40 | accu 0.0561 = 28444/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:31:21.488] Epoch 014/20 ==================================================
[2022-04-13 12:31:37.290] E014 |   200/731 batches | lr 2.5000 | loss  3.548 | ppl     34.75 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:31:53.081] E014 |   400/731 batches | lr 2.5000 | loss  3.541 | ppl     34.51 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:32:08.871] E014 |   600/731 batches | lr 2.5000 | loss  3.426 | ppl     30.75 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:32:19.303] E014 |   731/731 batches | lr 2.5000 | loss  3.377 | ppl     29.28 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:32:25.613] End E014 | valid loss  4.596; ppl     99.07 | accu 0.2474 = 28542/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:32:31.879] End E014 |  test loss  9.575; ppl  14402.20 | accu 0.0609 = 6831/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:33:00.352] End E014 |  test loss  9.984; ppl  21677.93 | accu 0.0607 = 30758/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:33:00.352] Save: model.pt... 
[2022-04-13 12:33:00.787] Save: model.pt...Done. best_val_loss: 4.5958
[2022-04-13 12:33:00.788] Epoch 015/20 ==================================================
[2022-04-13 12:33:16.526] E015 |   200/731 batches | lr 2.5000 | loss  3.515 | ppl     33.63 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:33:32.250] E015 |   400/731 batches | lr 2.5000 | loss  3.517 | ppl     33.68 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:33:47.771] E015 |   600/731 batches | lr 2.5000 | loss  3.410 | ppl     30.27 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:33:57.827] E015 |   731/731 batches | lr 2.5000 | loss  3.365 | ppl     28.94 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:34:03.121] End E015 | valid loss  4.596; ppl     99.13 | accu 0.2477 = 28575/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:34:08.336] End E015 |  test loss  9.621; ppl  15085.10 | accu 0.0612 = 6865/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:34:32.183] End E015 |  test loss 10.087; ppl  24030.01 | accu 0.0599 = 30345/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:34:32.183] Epoch 016/20 ==================================================
[2022-04-13 12:34:47.364] E016 |   200/731 batches | lr 1.2500 | loss  3.499 | ppl     33.10 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:35:02.565] E016 |   400/731 batches | lr 1.2500 | loss  3.491 | ppl     32.83 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:35:17.765] E016 |   600/731 batches | lr 1.2500 | loss  3.380 | ppl     29.36 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:35:27.736] E016 |   731/731 batches | lr 1.2500 | loss  3.329 | ppl     27.91 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:35:33.034] End E016 | valid loss  4.593; ppl     98.76 | accu 0.2486 = 28678/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:35:38.275] End E016 |  test loss  9.632; ppl  15251.15 | accu 0.0628 = 7044/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:36:01.977] End E016 |  test loss 10.064; ppl  23476.11 | accu 0.0624 = 31610/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:36:01.978] Save: model.pt... 
[2022-04-13 12:36:02.414] Save: model.pt...Done. best_val_loss: 4.5927
[2022-04-13 12:36:02.415] Epoch 017/20 ==================================================
[2022-04-13 12:36:17.441] E017 |   200/731 batches | lr 1.2500 | loss  3.481 | ppl     32.50 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:36:32.570] E017 |   400/731 batches | lr 1.2500 | loss  3.480 | ppl     32.47 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:36:47.718] E017 |   600/731 batches | lr 1.2500 | loss  3.369 | ppl     29.05 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:36:57.630] E017 |   731/731 batches | lr 1.2500 | loss  3.328 | ppl     27.88 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:37:02.937] End E017 | valid loss  4.595; ppl     99.03 | accu 0.2487 = 28694/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:37:08.159] End E017 |  test loss  9.673; ppl  15877.81 | accu 0.0613 = 6874/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:37:31.973] End E017 |  test loss 10.076; ppl  23760.96 | accu 0.0614 = 31130/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:37:31.973] Epoch 018/20 ==================================================
[2022-04-13 12:37:47.091] E018 |   200/731 batches | lr 0.6250 | loss  3.470 | ppl     32.14 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:38:02.316] E018 |   400/731 batches | lr 0.6250 | loss  3.470 | ppl     32.13 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:38:17.485] E018 |   600/731 batches | lr 0.6250 | loss  3.358 | ppl     28.72 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:38:27.386] E018 |   731/731 batches | lr 0.6250 | loss  3.311 | ppl     27.41 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:38:32.665] End E018 | valid loss  4.591; ppl     98.57 | accu 0.2492 = 28751/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:38:37.877] End E018 |  test loss  9.645; ppl  15448.97 | accu 0.0630 = 7071/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:39:01.684] End E018 |  test loss 10.045; ppl  23042.40 | accu 0.0629 = 31874/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:39:01.684] Save: model.pt... 
[2022-04-13 12:39:02.116] Save: model.pt...Done. best_val_loss: 4.5908
[2022-04-13 12:39:02.116] Epoch 019/20 ==================================================
[2022-04-13 12:39:17.165] E019 |   200/731 batches | lr 0.6250 | loss  3.462 | ppl     31.87 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:39:32.481] E019 |   400/731 batches | lr 0.6250 | loss  3.457 | ppl     31.72 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:39:48.756] E019 |   600/731 batches | lr 0.6250 | loss  3.357 | ppl     28.70 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:39:58.652] E019 |   731/731 batches | lr 0.6250 | loss  3.307 | ppl     27.31 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:40:03.956] End E019 | valid loss  4.589; ppl     98.42 | accu 0.2492 = 28753/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:40:09.212] End E019 |  test loss  9.653; ppl  15566.12 | accu 0.0628 = 7043/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:40:33.097] End E019 |  test loss 10.058; ppl  23350.17 | accu 0.0626 = 31719/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:40:33.097] Save: model.pt... 
[2022-04-13 12:40:33.537] Save: model.pt...Done. best_val_loss: 4.5893
[2022-04-13 12:40:33.537] Epoch 020/20 ==================================================
[2022-04-13 12:40:49.275] E020 |   200/731 batches | lr 0.6250 | loss  3.455 | ppl     31.64 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:41:04.475] E020 |   400/731 batches | lr 0.6250 | loss  3.456 | ppl     31.69 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:41:19.730] E020 |   600/731 batches | lr 0.6250 | loss  3.351 | ppl     28.54 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:41:29.613] E020 |   731/731 batches | lr 0.6250 | loss  3.308 | ppl     27.32 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:41:34.878] End E020 | valid loss  4.589; ppl     98.44 | accu 0.2493 = 28764/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:41:40.079] End E020 |  test loss  9.652; ppl  15557.68 | accu 0.0634 = 7117/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:42:03.727] End E020 |  test loss 10.083; ppl  23942.22 | accu 0.0627 = 31780/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:42:09.039] End. test loss  9.65; ppl 15566.12 | accu 0.0628 = 7043/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:42:32.847] End. test loss 10.06; ppl 23350.17 | accu 0.0626 = 31719/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:42:32.847] =========================================================================================
[2022-04-13 12:42:32.847] valid_loss
[2022-04-13 12:42:32.847]  5.36, 5.04, 4.88, 4.79, 4.76, 4.73, 4.70, 4.68, 4.68, 4.69, 4.60, 4.61, 4.61, 4.60, 4.60, 4.59, 4.60, 4.59, 4.59, 4.59
[2022-04-13 12:42:32.847] valid_loss ppl
[2022-04-13 12:42:32.848]   212.44,  153.89,  132.28,  119.94,  116.37,  113.10,  109.90,  108.14,  107.97,  108.63,   99.93,  100.61,  100.34,   99.07,   99.13,   98.76,   99.03,   98.57,   98.42,   98.44
[2022-04-13 12:42:32.848] test_loss of ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:42:32.848]  8.90, 8.77, 8.75, 8.98, 8.84, 8.71, 8.93, 9.02, 9.07, 9.27, 9.36, 9.48, 9.61, 9.58, 9.62, 9.63, 9.67, 9.65, 9.65, 9.65
[2022-04-13 12:42:32.848] test_loss of ../data/sample_500k/adolescent_valid.txt ppl
[2022-04-13 12:42:32.856]  7344.12, 6427.16, 6311.87, 7955.31, 6881.28, 6078.37, 7518.89, 8231.56, 8697.40,10591.81,11635.42,13036.16,14841.40,14402.20,15085.10,15251.15,15877.81,15448.97,15566.12,15557.68
[2022-04-13 12:42:32.856] test_loss of ../data/sample_500k/adult_test.txt
[2022-04-13 12:42:32.856]  9.04, 9.04, 9.06, 9.30, 9.04, 9.19, 9.32, 9.38, 9.64, 9.97,10.07,10.22,10.12, 9.98,10.09,10.06,10.08,10.05,10.06,10.08
[2022-04-13 12:42:32.856] test_loss of ../data/sample_500k/adult_test.txt ppl
[2022-04-13 12:42:32.856]  8435.13, 8455.80, 8631.42,10958.35, 8393.73, 9837.60,11160.73,11888.98,15375.15,21398.76,23620.69,27532.43,24957.40,21677.93,24030.01,23476.11,23760.96,23042.40,23350.17,23942.22
[2022-04-13 12:42:32.857] 
[2022-04-13 12:42:32.857] 
[2022-04-13 12:42:32.857] 
Log file: ./output_wsm_Subword.200_fam_CNN.log closed.
Log file: ./output_wsm_Subword.200_fam_LSTM.log open...
[2022-04-13 12:42:32.868] corpus.train_file_list: 1
[2022-04-13 12:42:32.868]         ../data/sample_500k/cbt_train.txt
[2022-04-13 12:42:32.868] corpus.valid_file_list: 1
[2022-04-13 12:42:32.868]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 12:42:32.868] corpus.test_file_list: 2
[2022-04-13 12:42:32.868]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:42:32.869]         ../data/sample_500k/adult_test.txt
[2022-04-13 12:42:32.869] corpus.subword_vocab_size: 0
[2022-04-13 12:42:32.869] corpus.subword_model = None. Corpus will not use subword.
[2022-04-13 12:42:32.869] corpus tokenize...
[2022-04-13 12:42:33.523]         train tokens: 511735  ../data/sample_500k/cbt_train.txt
[2022-04-13 12:42:33.657]         valid tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-13 12:42:33.898]         test  tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:42:34.510]         test  tokens: 506878  ../data/sample_500k/adult_test.txt
[2022-04-13 12:42:34.510] corpus.ntokens      : 73236
[2022-04-13 12:42:34.510] corpus.char_count   : 157
[2022-04-13 12:42:34.511] corpus.char_cnt_dict: 157
[2022-04-13 12:42:34.511] corpus.char_id_dict : 157
[2022-04-13 12:42:34.520] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 12:42:34.520]         tokens_all: 511735
[2022-04-13 12:42:34.520]         batched   :  25586
[2022-04-13 12:42:34.520]         ../data/sample_500k/cbt_train.txt
[2022-04-13 12:42:34.524] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 12:42:34.524]         tokens_all: 115417
[2022-04-13 12:42:34.524]         batched   :   5770
[2022-04-13 12:42:34.524]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 12:42:34.526] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 12:42:34.526]         tokens_all: 112256
[2022-04-13 12:42:34.526]         batched   :   5612
[2022-04-13 12:42:34.526]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:42:34.529] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 12:42:34.530]         tokens_all: 506878
[2022-04-13 12:42:34.530]         batched   :  25343
[2022-04-13 12:42:34.530]         ../data/sample_500k/adult_test.txt
[2022-04-13 12:42:34.531] subword_adapter will be generated due to word_split_mode='Subword.200'
[2022-04-13 12:42:34.531] SubwordAdapter.file_list: 2
[2022-04-13 12:42:34.531]         ../data/sample_500k/cbt_train.txt
[2022-04-13 12:42:34.531]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 12:42:34.531] SubwordAdapter.subword_vocab_size: 200
[2022-04-13 12:42:34.531] SubwordAdapter.subword_model.train(2 files)...
[2022-04-13 12:42:34.758] SubwordAdapter.subword_model.train(2 files)...Done
[2022-04-13 12:42:35.419] RNNModel.rnn_type: LSTM
[2022-04-13 12:42:35.420] RNNModel.ntoken  : 73236
[2022-04-13 12:42:35.420] RNNModel.ninp    : 200
[2022-04-13 12:42:35.420] RNNModel.nhid    : 200
[2022-04-13 12:42:35.420] RNNModel.nlayers : 2
[2022-04-13 12:42:35.420] RNNModel.dropout : 0.2
[2022-04-13 12:42:35.420] RNNModel.tie_weights: False
[2022-04-13 12:42:35.420] RNNModel.fragment_aggregate_mode: LSTM
[2022-04-13 12:42:35.420] RNNModel.fragment_cnt           : 202
[2022-04-13 12:42:35.421] RNNModel.fragment_emsize        : 25
[2022-04-13 12:42:35.421] RNNModel.fragment_nhid          : 200
[2022-04-13 12:42:35.421] RNNModel.fragment_embeds     : created
[2022-04-13 12:42:35.425] RNNModel.fragment_lstm       : created
[2022-04-13 12:42:35.425] RNNModel.fragment_lstm_linear: created
[2022-04-13 12:42:35.457] Epoch 001/20 ==================================================
[2022-04-13 12:43:40.758] E001 |   200/731 batches | lr 20.0000 | loss  7.352 | ppl   1558.90 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:44:43.149] E001 |   400/731 batches | lr 20.0000 | loss  6.003 | ppl    404.61 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:45:44.935] E001 |   600/731 batches | lr 20.0000 | loss  5.403 | ppl    222.17 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:46:27.423] E001 |   731/731 batches | lr 20.0000 | loss  5.229 | ppl    186.58 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:46:43.532] End E001 | valid loss  5.337; ppl    207.99 | accu 0.1651 = 19049/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:46:58.163] End E001 |  test loss  8.927; ppl   7534.73 | accu 0.0346 = 3884/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:48:09.696] End E001 |  test loss  9.034; ppl   8384.89 | accu 0.0323 = 16392/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:48:09.696] Save: model.pt... 
[2022-04-13 12:48:10.134] Save: model.pt...Done. best_val_loss: 5.3375
[2022-04-13 12:48:10.134] Epoch 002/20 ==================================================
[2022-04-13 12:49:19.032] E002 |   200/731 batches | lr 20.0000 | loss  5.078 | ppl    160.43 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:50:27.884] E002 |   400/731 batches | lr 20.0000 | loss  4.977 | ppl    145.00 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:51:33.320] E002 |   600/731 batches | lr 20.0000 | loss  4.772 | ppl    118.11 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:52:17.720] E002 |   731/731 batches | lr 20.0000 | loss  4.720 | ppl    112.19 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:52:32.431] End E002 | valid loss  5.063; ppl    158.08 | accu 0.1789 = 20638/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:52:46.913] End E002 |  test loss  8.694; ppl   5968.06 | accu 0.0429 = 4813/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:53:51.845] End E002 |  test loss  8.893; ppl   7282.42 | accu 0.0410 = 20776/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:53:51.845] Save: model.pt... 
[2022-04-13 12:53:52.299] Save: model.pt...Done. best_val_loss: 5.0631
[2022-04-13 12:53:52.299] Epoch 003/20 ==================================================
[2022-04-13 12:54:58.425] E003 |   200/731 batches | lr 20.0000 | loss  4.669 | ppl    106.58 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 12:56:03.084] E003 |   400/731 batches | lr 20.0000 | loss  4.649 | ppl    104.47 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 12:57:06.615] E003 |   600/731 batches | lr 20.0000 | loss  4.508 | ppl     90.70 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 12:57:48.500] E003 |   731/731 batches | lr 20.0000 | loss  4.477 | ppl     87.96 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 12:58:02.652] End E003 | valid loss  4.816; ppl    123.41 | accu 0.2117 = 24422/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 12:58:16.571] End E003 |  test loss  8.707; ppl   6046.13 | accu 0.0603 = 6763/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 12:59:24.697] End E003 |  test loss  8.953; ppl   7734.77 | accu 0.0604 = 30592/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 12:59:24.697] Save: model.pt... 
[2022-04-13 12:59:25.149] Save: model.pt...Done. best_val_loss: 4.8155
[2022-04-13 12:59:25.149] Epoch 004/20 ==================================================
[2022-04-13 13:00:30.758] E004 |   200/731 batches | lr 20.0000 | loss  4.457 | ppl     86.20 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 13:01:33.523] E004 |   400/731 batches | lr 20.0000 | loss  4.453 | ppl     85.87 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 13:02:37.344] E004 |   600/731 batches | lr 20.0000 | loss  4.338 | ppl     76.59 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 13:03:18.794] E004 |   731/731 batches | lr 20.0000 | loss  4.309 | ppl     74.34 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 13:03:33.073] End E004 | valid loss  4.852; ppl    128.05 | accu 0.2012 = 23218/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 13:03:47.411] End E004 |  test loss  8.712; ppl   6073.33 | accu 0.0556 = 6234/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:04:51.983] End E004 |  test loss  9.019; ppl   8261.05 | accu 0.0548 = 27767/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 13:04:51.984] Epoch 005/20 ==================================================
[2022-04-13 13:05:56.375] E005 |   200/731 batches | lr 10.0000 | loss  4.240 | ppl     69.44 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 13:06:59.563] E005 |   400/731 batches | lr 10.0000 | loss  4.215 | ppl     67.70 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 13:08:04.294] E005 |   600/731 batches | lr 10.0000 | loss  4.096 | ppl     60.09 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 13:08:45.556] E005 |   731/731 batches | lr 10.0000 | loss  4.063 | ppl     58.14 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 13:08:59.636] End E005 | valid loss  4.653; ppl    104.88 | accu 0.2320 = 26765/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 13:09:13.490] End E005 |  test loss  8.988; ppl   8004.26 | accu 0.0577 = 6470/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:10:16.623] End E005 |  test loss  9.216; ppl  10058.27 | accu 0.0568 = 28801/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 13:10:16.623] Save: model.pt... 
[2022-04-13 13:10:17.056] Save: model.pt...Done. best_val_loss: 4.6528
[2022-04-13 13:10:17.056] Epoch 006/20 ==================================================
[2022-04-13 13:11:24.352] E006 |   200/731 batches | lr 10.0000 | loss  4.126 | ppl     61.91 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 13:12:29.167] E006 |   400/731 batches | lr 10.0000 | loss  4.124 | ppl     61.82 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 13:13:34.756] E006 |   600/731 batches | lr 10.0000 | loss  4.020 | ppl     55.71 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 13:14:17.707] E006 |   731/731 batches | lr 10.0000 | loss  3.994 | ppl     54.29 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 13:14:32.001] End E006 | valid loss  4.641; ppl    103.62 | accu 0.2335 = 26944/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 13:14:46.063] End E006 |  test loss  9.158; ppl   9494.35 | accu 0.0551 = 6178/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:15:49.327] End E006 |  test loss  9.396; ppl  12039.29 | accu 0.0561 = 28434/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 13:15:49.327] Save: model.pt... 
[2022-04-13 13:15:49.757] Save: model.pt...Done. best_val_loss: 4.6407
[2022-04-13 13:15:49.757] Epoch 007/20 ==================================================
[2022-04-13 13:16:58.045] E007 |   200/731 batches | lr 10.0000 | loss  4.045 | ppl     57.12 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 13:18:01.815] E007 |   400/731 batches | lr 10.0000 | loss  4.052 | ppl     57.53 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 13:19:07.321] E007 |   600/731 batches | lr 10.0000 | loss  3.954 | ppl     52.14 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 13:19:51.336] E007 |   731/731 batches | lr 10.0000 | loss  3.928 | ppl     50.79 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 13:20:05.619] End E007 | valid loss  4.631; ppl    102.57 | accu 0.2337 = 26967/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 13:20:19.895] End E007 |  test loss  9.070; ppl   8689.10 | accu 0.0595 = 6672/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:21:26.127] End E007 |  test loss  9.234; ppl  10236.03 | accu 0.0593 = 30073/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 13:21:26.127] Save: model.pt... 
[2022-04-13 13:21:26.556] Save: model.pt...Done. best_val_loss: 4.6306
[2022-04-13 13:21:26.557] Epoch 008/20 ==================================================
[2022-04-13 13:22:33.533] E008 |   200/731 batches | lr 10.0000 | loss  3.971 | ppl     53.02 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 13:23:38.094] E008 |   400/731 batches | lr 10.0000 | loss  3.985 | ppl     53.79 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 13:24:42.845] E008 |   600/731 batches | lr 10.0000 | loss  3.890 | ppl     48.92 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 13:25:26.862] E008 |   731/731 batches | lr 10.0000 | loss  3.865 | ppl     47.72 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 13:25:41.211] End E008 | valid loss  4.623; ppl    101.77 | accu 0.2365 = 27289/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 13:25:57.711] End E008 |  test loss  9.384; ppl  11897.02 | accu 0.0543 = 6089/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:27:05.536] End E008 |  test loss  9.763; ppl  17381.17 | accu 0.0539 = 27312/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 13:27:05.536] Save: model.pt... 
[2022-04-13 13:27:05.971] Save: model.pt...Done. best_val_loss: 4.6227
[2022-04-13 13:27:05.971] Epoch 009/20 ==================================================
[2022-04-13 13:28:12.030] E009 |   200/731 batches | lr 10.0000 | loss  3.909 | ppl     49.83 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 13:29:15.463] E009 |   400/731 batches | lr 10.0000 | loss  3.924 | ppl     50.63 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 13:30:20.525] E009 |   600/731 batches | lr 10.0000 | loss  3.833 | ppl     46.21 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 13:31:03.506] E009 |   731/731 batches | lr 10.0000 | loss  3.813 | ppl     45.29 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 13:31:20.158] End E009 | valid loss  4.633; ppl    102.82 | accu 0.2345 = 27054/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 13:31:37.995] End E009 |  test loss  9.399; ppl  12077.62 | accu 0.0525 = 5895/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:32:53.225] End E009 |  test loss  9.627; ppl  15175.55 | accu 0.0556 = 28205/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 13:32:53.225] Epoch 010/20 ==================================================
[2022-04-13 13:33:58.451] E010 |   200/731 batches | lr 5.0000 | loss  3.833 | ppl     46.22 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 13:35:02.118] E010 |   400/731 batches | lr 5.0000 | loss  3.826 | ppl     45.90 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 13:36:04.297] E010 |   600/731 batches | lr 5.0000 | loss  3.714 | ppl     41.00 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 13:36:47.315] E010 |   731/731 batches | lr 5.0000 | loss  3.674 | ppl     39.40 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 13:37:01.518] End E010 | valid loss  4.600; ppl     99.53 | accu 0.2414 = 27857/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 13:37:15.495] End E010 |  test loss  9.470; ppl  12962.08 | accu 0.0554 = 6212/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:38:24.766] End E010 |  test loss  9.871; ppl  19366.03 | accu 0.0555 = 28130/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 13:38:24.767] Save: model.pt... 
[2022-04-13 13:38:25.267] Save: model.pt...Done. best_val_loss: 4.6004
[2022-04-13 13:38:25.267] Epoch 011/20 ==================================================
[2022-04-13 13:39:32.745] E011 |   200/731 batches | lr 5.0000 | loss  3.767 | ppl     43.24 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 13:40:36.999] E011 |   400/731 batches | lr 5.0000 | loss  3.782 | ppl     43.90 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 13:41:39.573] E011 |   600/731 batches | lr 5.0000 | loss  3.675 | ppl     39.47 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 13:42:22.617] E011 |   731/731 batches | lr 5.0000 | loss  3.644 | ppl     38.24 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 13:42:36.898] End E011 | valid loss  4.603; ppl     99.80 | accu 0.2404 = 27732/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 13:42:50.978] End E011 |  test loss  9.488; ppl  13196.31 | accu 0.0564 = 6332/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:43:57.478] End E011 |  test loss  9.929; ppl  20526.07 | accu 0.0555 = 28148/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 13:43:57.479] Epoch 012/20 ==================================================
[2022-04-13 13:45:06.235] E012 |   200/731 batches | lr 2.5000 | loss  3.726 | ppl     41.53 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 13:46:12.297] E012 |   400/731 batches | lr 2.5000 | loss  3.725 | ppl     41.48 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 13:47:17.036] E012 |   600/731 batches | lr 2.5000 | loss  3.612 | ppl     37.04 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 13:47:59.784] E012 |   731/731 batches | lr 2.5000 | loss  3.575 | ppl     35.70 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 13:48:14.046] End E012 | valid loss  4.592; ppl     98.65 | accu 0.2439 = 28143/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 13:48:28.110] End E012 |  test loss  9.504; ppl  13418.82 | accu 0.0595 = 6674/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:49:36.859] End E012 |  test loss  9.966; ppl  21283.39 | accu 0.0590 = 29897/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 13:49:36.859] Save: model.pt... 
[2022-04-13 13:49:37.296] Save: model.pt...Done. best_val_loss: 4.5916
[2022-04-13 13:49:37.297] Epoch 013/20 ==================================================
[2022-04-13 13:50:43.729] E013 |   200/731 batches | lr 2.5000 | loss  3.692 | ppl     40.12 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 13:51:51.468] E013 |   400/731 batches | lr 2.5000 | loss  3.699 | ppl     40.42 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 13:52:58.892] E013 |   600/731 batches | lr 2.5000 | loss  3.592 | ppl     36.32 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 13:53:44.317] E013 |   731/731 batches | lr 2.5000 | loss  3.554 | ppl     34.97 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 13:54:02.539] End E013 | valid loss  4.594; ppl     98.85 | accu 0.2444 = 28198/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 13:54:18.569] End E013 |  test loss  9.591; ppl  14633.26 | accu 0.0593 = 6658/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 13:55:26.262] End E013 |  test loss 10.062; ppl  23444.75 | accu 0.0591 = 29936/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 13:55:26.262] Epoch 014/20 ==================================================
[2022-04-13 13:56:33.444] E014 |   200/731 batches | lr 1.2500 | loss  3.673 | ppl     39.38 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 13:57:39.408] E014 |   400/731 batches | lr 1.2500 | loss  3.672 | ppl     39.32 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 13:58:42.733] E014 |   600/731 batches | lr 1.2500 | loss  3.562 | ppl     35.22 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 13:59:24.931] E014 |   731/731 batches | lr 1.2500 | loss  3.517 | ppl     33.67 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 13:59:39.135] End E014 | valid loss  4.589; ppl     98.43 | accu 0.2457 = 28348/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 13:59:53.139] End E014 |  test loss  9.574; ppl  14389.77 | accu 0.0605 = 6791/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:01:02.821] End E014 |  test loss  9.985; ppl  21701.12 | accu 0.0608 = 30802/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:01:02.821] Save: model.pt... 
[2022-04-13 14:01:03.252] Save: model.pt...Done. best_val_loss: 4.5894
[2022-04-13 14:01:03.252] Epoch 015/20 ==================================================
[2022-04-13 14:02:10.833] E015 |   200/731 batches | lr 1.2500 | loss  3.652 | ppl     38.56 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 14:03:15.606] E015 |   400/731 batches | lr 1.2500 | loss  3.662 | ppl     38.94 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 14:04:19.060] E015 |   600/731 batches | lr 1.2500 | loss  3.550 | ppl     34.80 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 14:05:01.142] E015 |   731/731 batches | lr 1.2500 | loss  3.511 | ppl     33.50 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 14:05:15.526] End E015 | valid loss  4.591; ppl     98.58 | accu 0.2451 = 28282/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 14:05:29.937] End E015 |  test loss  9.599; ppl  14746.56 | accu 0.0619 = 6946/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:06:37.868] End E015 |  test loss 10.045; ppl  23036.31 | accu 0.0614 = 31141/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:06:37.868] Epoch 016/20 ==================================================
[2022-04-13 14:07:44.035] E016 |   200/731 batches | lr 0.6250 | loss  3.643 | ppl     38.21 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 14:08:48.456] E016 |   400/731 batches | lr 0.6250 | loss  3.646 | ppl     38.31 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 14:09:52.185] E016 |   600/731 batches | lr 0.6250 | loss  3.536 | ppl     34.31 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 14:10:36.887] E016 |   731/731 batches | lr 0.6250 | loss  3.494 | ppl     32.90 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 14:10:55.304] End E016 | valid loss  4.588; ppl     98.29 | accu 0.2462 = 28406/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 14:11:10.327] End E016 |  test loss  9.571; ppl  14345.56 | accu 0.0629 = 7063/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:12:14.754] End E016 |  test loss  9.967; ppl  21304.44 | accu 0.0632 = 32032/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:12:14.755] Save: model.pt... 
[2022-04-13 14:12:15.200] Save: model.pt...Done. best_val_loss: 4.5880
[2022-04-13 14:12:15.200] Epoch 017/20 ==================================================
[2022-04-13 14:13:28.722] E017 |   200/731 batches | lr 0.6250 | loss  3.633 | ppl     37.81 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 14:14:35.084] E017 |   400/731 batches | lr 0.6250 | loss  3.638 | ppl     38.03 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 14:15:39.068] E017 |   600/731 batches | lr 0.6250 | loss  3.530 | ppl     34.14 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 14:16:24.530] E017 |   731/731 batches | lr 0.6250 | loss  3.490 | ppl     32.78 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 14:16:38.860] End E017 | valid loss  4.589; ppl     98.35 | accu 0.2460 = 28379/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 14:16:55.248] End E017 |  test loss  9.578; ppl  14448.58 | accu 0.0628 = 7042/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:17:59.244] End E017 |  test loss 10.009; ppl  22235.94 | accu 0.0626 = 31743/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:17:59.244] Epoch 018/20 ==================================================
[2022-04-13 14:19:06.869] E018 |   200/731 batches | lr 0.3125 | loss  3.632 | ppl     37.78 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 14:20:10.314] E018 |   400/731 batches | lr 0.3125 | loss  3.634 | ppl     37.86 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 14:21:15.518] E018 |   600/731 batches | lr 0.3125 | loss  3.524 | ppl     33.93 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 14:22:00.379] E018 |   731/731 batches | lr 0.3125 | loss  3.481 | ppl     32.48 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 14:22:14.744] End E018 | valid loss  4.588; ppl     98.26 | accu 0.2466 = 28449/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 14:22:28.856] End E018 |  test loss  9.551; ppl  14062.41 | accu 0.0636 = 7133/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:23:33.515] End E018 |  test loss  9.877; ppl  19469.64 | accu 0.0641 = 32474/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:23:33.515] Save: model.pt... 
[2022-04-13 14:23:33.950] Save: model.pt...Done. best_val_loss: 4.5876
[2022-04-13 14:23:33.951] Epoch 019/20 ==================================================
[2022-04-13 14:24:40.894] E019 |   200/731 batches | lr 0.3125 | loss  3.624 | ppl     37.48 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 14:25:44.611] E019 |   400/731 batches | lr 0.3125 | loss  3.629 | ppl     37.66 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 14:26:48.067] E019 |   600/731 batches | lr 0.3125 | loss  3.520 | ppl     33.80 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 14:27:33.340] E019 |   731/731 batches | lr 0.3125 | loss  3.478 | ppl     32.38 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 14:27:47.512] End E019 | valid loss  4.587; ppl     98.15 | accu 0.2466 = 28454/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 14:28:01.612] End E019 |  test loss  9.579; ppl  14462.03 | accu 0.0632 = 7094/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:29:08.483] End E019 |  test loss  9.956; ppl  21084.46 | accu 0.0638 = 32344/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:29:08.484] Save: model.pt... 
[2022-04-13 14:29:08.913] Save: model.pt...Done. best_val_loss: 4.5865
[2022-04-13 14:29:08.913] Epoch 020/20 ==================================================
[2022-04-13 14:30:14.890] E020 |   200/731 batches | lr 0.3125 | loss  3.619 | ppl     37.29 frag_cnt/word_cnt=2.164=302933/140000
[2022-04-13 14:31:19.443] E020 |   400/731 batches | lr 0.3125 | loss  3.624 | ppl     37.49 frag_cnt/word_cnt=2.172=304046/140000
[2022-04-13 14:32:26.410] E020 |   600/731 batches | lr 0.3125 | loss  3.517 | ppl     33.69 frag_cnt/word_cnt=2.148=300690/140000
[2022-04-13 14:33:08.789] E020 |   731/731 batches | lr 0.3125 | loss  3.480 | ppl     32.46 frag_cnt/word_cnt=2.150=197171/91700
[2022-04-13 14:33:23.535] End E020 | valid loss  4.587; ppl     98.20 | accu 0.2467 = 28461/115380 | w_len 2.1181 = 244384/115380
[2022-04-13 14:33:38.423] End E020 |  test loss  9.585; ppl  14546.97 | accu 0.0629 = 7057/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:34:42.880] End E020 |  test loss  9.927; ppl  20485.01 | accu 0.0639 = 32364/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:34:57.983] End. test loss  9.58; ppl 14462.03 | accu 0.0632 = 7094/112220 | w_len 2.7297 = 306328/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:36:04.930] End. test loss  9.96; ppl 21084.46 | accu 0.0638 = 32344/506840 | w_len 3.0106 = 1525890/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:36:04.930] =========================================================================================
[2022-04-13 14:36:04.931] valid_loss
[2022-04-13 14:36:04.931]  5.34, 5.06, 4.82, 4.85, 4.65, 4.64, 4.63, 4.62, 4.63, 4.60, 4.60, 4.59, 4.59, 4.59, 4.59, 4.59, 4.59, 4.59, 4.59, 4.59
[2022-04-13 14:36:04.931] valid_loss ppl
[2022-04-13 14:36:04.931]   207.99,  158.08,  123.41,  128.05,  104.88,  103.62,  102.57,  101.77,  102.82,   99.53,   99.80,   98.65,   98.85,   98.43,   98.58,   98.29,   98.35,   98.26,   98.15,   98.20
[2022-04-13 14:36:04.931] test_loss of ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:36:04.931]  8.93, 8.69, 8.71, 8.71, 8.99, 9.16, 9.07, 9.38, 9.40, 9.47, 9.49, 9.50, 9.59, 9.57, 9.60, 9.57, 9.58, 9.55, 9.58, 9.59
[2022-04-13 14:36:04.931] test_loss of ../data/sample_500k/adolescent_valid.txt ppl
[2022-04-13 14:36:04.931]  7534.73, 5968.06, 6046.13, 6073.33, 8004.26, 9494.35, 8689.10,11897.02,12077.62,12962.08,13196.31,13418.82,14633.26,14389.77,14746.56,14345.56,14448.58,14062.41,14462.03,14546.97
[2022-04-13 14:36:04.931] test_loss of ../data/sample_500k/adult_test.txt
[2022-04-13 14:36:04.931]  9.03, 8.89, 8.95, 9.02, 9.22, 9.40, 9.23, 9.76, 9.63, 9.87, 9.93, 9.97,10.06, 9.99,10.04, 9.97,10.01, 9.88, 9.96, 9.93
[2022-04-13 14:36:04.931] test_loss of ../data/sample_500k/adult_test.txt ppl
[2022-04-13 14:36:04.931]  8384.89, 7282.42, 7734.77, 8261.05,10058.27,12039.29,10236.03,17381.17,15175.55,19366.03,20526.07,21283.39,23444.75,21701.12,23036.31,21304.44,22235.94,19469.64,21084.46,20485.01
[2022-04-13 14:36:04.932] 
[2022-04-13 14:36:04.932] 
[2022-04-13 14:36:04.932] 
Log file: ./output_wsm_Subword.200_fam_LSTM.log closed.
Log file: ./output_wsm_Subword.500_fam_CNN.log open...
[2022-04-13 14:36:04.942] corpus.train_file_list: 1
[2022-04-13 14:36:04.942]         ../data/sample_500k/cbt_train.txt
[2022-04-13 14:36:04.943] corpus.valid_file_list: 1
[2022-04-13 14:36:04.943]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:36:04.943] corpus.test_file_list: 2
[2022-04-13 14:36:04.943]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:36:04.943]         ../data/sample_500k/adult_test.txt
[2022-04-13 14:36:04.943] corpus.subword_vocab_size: 0
[2022-04-13 14:36:04.943] corpus.subword_model = None. Corpus will not use subword.
[2022-04-13 14:36:04.943] corpus tokenize...
[2022-04-13 14:36:05.616]         train tokens: 511735  ../data/sample_500k/cbt_train.txt
[2022-04-13 14:36:05.753]         valid tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:36:05.987]         test  tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:36:06.610]         test  tokens: 506878  ../data/sample_500k/adult_test.txt
[2022-04-13 14:36:06.610] corpus.ntokens      : 73236
[2022-04-13 14:36:06.610] corpus.char_count   : 157
[2022-04-13 14:36:06.610] corpus.char_cnt_dict: 157
[2022-04-13 14:36:06.611] corpus.char_id_dict : 157
[2022-04-13 14:36:06.621] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 14:36:06.621]         tokens_all: 511735
[2022-04-13 14:36:06.621]         batched   :  25586
[2022-04-13 14:36:06.621]         ../data/sample_500k/cbt_train.txt
[2022-04-13 14:36:06.623] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 14:36:06.623]         tokens_all: 115417
[2022-04-13 14:36:06.623]         batched   :   5770
[2022-04-13 14:36:06.624]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:36:06.625] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 14:36:06.625]         tokens_all: 112256
[2022-04-13 14:36:06.625]         batched   :   5612
[2022-04-13 14:36:06.625]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:36:06.629] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 14:36:06.629]         tokens_all: 506878
[2022-04-13 14:36:06.629]         batched   :  25343
[2022-04-13 14:36:06.629]         ../data/sample_500k/adult_test.txt
[2022-04-13 14:36:06.630] subword_adapter will be generated due to word_split_mode='Subword.500'
[2022-04-13 14:36:06.630] SubwordAdapter.file_list: 2
[2022-04-13 14:36:06.630]         ../data/sample_500k/cbt_train.txt
[2022-04-13 14:36:06.630]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 14:36:06.630] SubwordAdapter.subword_vocab_size: 500
[2022-04-13 14:36:06.630] SubwordAdapter.subword_model.train(2 files)...
[2022-04-13 14:36:06.921] SubwordAdapter.subword_model.train(2 files)...Done
[2022-04-13 14:36:07.503] RNNModel.rnn_type: LSTM
[2022-04-13 14:36:07.503] RNNModel.ntoken  : 73236
[2022-04-13 14:36:07.503] RNNModel.ninp    : 200
[2022-04-13 14:36:07.503] RNNModel.nhid    : 200
[2022-04-13 14:36:07.503] RNNModel.nlayers : 2
[2022-04-13 14:36:07.503] RNNModel.dropout : 0.2
[2022-04-13 14:36:07.503] RNNModel.tie_weights: False
[2022-04-13 14:36:07.504] RNNModel.fragment_aggregate_mode: CNN
[2022-04-13 14:36:07.504] RNNModel.fragment_cnt           : 502
[2022-04-13 14:36:07.504] RNNModel.fragment_emsize        : 25
[2022-04-13 14:36:07.504] RNNModel.fragment_nhid          : 200
[2022-04-13 14:36:07.504] RNNModel.fragment_embeds     : created
[2022-04-13 14:36:07.505] RNNModel.fragment_cnn3       : created
[2022-04-13 14:36:07.530] Epoch 001/20 ==================================================
[2022-04-13 14:36:22.752] E001 |   200/731 batches | lr 20.0000 | loss  7.354 | ppl   1561.76 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:36:37.791] E001 |   400/731 batches | lr 20.0000 | loss  5.994 | ppl    401.14 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:36:52.905] E001 |   600/731 batches | lr 20.0000 | loss  5.371 | ppl    215.03 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:37:02.778] E001 |   731/731 batches | lr 20.0000 | loss  5.190 | ppl    179.41 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 14:37:08.067] End E001 | valid loss  5.420; ppl    225.96 | accu 0.1522 = 17556/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 14:37:13.301] End E001 |  test loss  8.983; ppl   7965.40 | accu 0.0340 = 3811/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:37:37.122] End E001 |  test loss  9.006; ppl   8153.03 | accu 0.0337 = 17095/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:37:37.123] Save: model.pt... 
[2022-04-13 14:37:37.569] Save: model.pt...Done. best_val_loss: 5.4203
[2022-04-13 14:37:37.569] Epoch 002/20 ==================================================
[2022-04-13 14:37:52.631] E002 |   200/731 batches | lr 20.0000 | loss  5.053 | ppl    156.57 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:38:07.738] E002 |   400/731 batches | lr 20.0000 | loss  4.947 | ppl    140.75 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:38:23.020] E002 |   600/731 batches | lr 20.0000 | loss  4.752 | ppl    115.82 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:38:32.893] E002 |   731/731 batches | lr 20.0000 | loss  4.704 | ppl    110.37 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 14:38:38.148] End E002 | valid loss  5.072; ppl    159.51 | accu 0.1747 = 20159/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 14:38:43.396] End E002 |  test loss  8.697; ppl   5982.88 | accu 0.0367 = 4122/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:39:07.171] End E002 |  test loss  8.883; ppl   7206.27 | accu 0.0349 = 17707/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:39:07.172] Save: model.pt... 
[2022-04-13 14:39:07.605] Save: model.pt...Done. best_val_loss: 5.0721
[2022-04-13 14:39:07.605] Epoch 003/20 ==================================================
[2022-04-13 14:39:22.567] E003 |   200/731 batches | lr 20.0000 | loss  4.656 | ppl    105.19 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:39:37.785] E003 |   400/731 batches | lr 20.0000 | loss  4.627 | ppl    102.25 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:39:53.792] E003 |   600/731 batches | lr 20.0000 | loss  4.493 | ppl     89.39 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:40:03.598] E003 |   731/731 batches | lr 20.0000 | loss  4.471 | ppl     87.44 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 14:40:08.846] End E003 | valid loss  4.898; ppl    133.96 | accu 0.1979 = 22829/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 14:40:14.047] End E003 |  test loss  8.649; ppl   5701.62 | accu 0.0556 = 6237/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:40:40.081] End E003 |  test loss  8.909; ppl   7395.41 | accu 0.0517 = 26183/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:40:40.081] Save: model.pt... 
[2022-04-13 14:40:40.506] Save: model.pt...Done. best_val_loss: 4.8975
[2022-04-13 14:40:40.506] Epoch 004/20 ==================================================
[2022-04-13 14:40:55.517] E004 |   200/731 batches | lr 20.0000 | loss  4.451 | ppl     85.74 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:41:10.592] E004 |   400/731 batches | lr 20.0000 | loss  4.443 | ppl     85.05 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:41:25.808] E004 |   600/731 batches | lr 20.0000 | loss  4.333 | ppl     76.17 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:41:35.714] E004 |   731/731 batches | lr 20.0000 | loss  4.312 | ppl     74.58 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 14:41:40.964] End E004 | valid loss  4.803; ppl    121.89 | accu 0.2012 = 23211/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 14:41:46.159] End E004 |  test loss  8.715; ppl   6091.86 | accu 0.0517 = 5798/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:42:09.919] End E004 |  test loss  8.976; ppl   7909.25 | accu 0.0489 = 24770/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:42:09.920] Save: model.pt... 
[2022-04-13 14:42:10.357] Save: model.pt...Done. best_val_loss: 4.8031
[2022-04-13 14:42:10.357] Epoch 005/20 ==================================================
[2022-04-13 14:42:25.579] E005 |   200/731 batches | lr 20.0000 | loss  4.308 | ppl     74.31 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:42:41.291] E005 |   400/731 batches | lr 20.0000 | loss  4.313 | ppl     74.63 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:42:56.630] E005 |   600/731 batches | lr 20.0000 | loss  4.215 | ppl     67.71 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:43:07.225] E005 |   731/731 batches | lr 20.0000 | loss  4.198 | ppl     66.53 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 14:43:12.530] End E005 | valid loss  4.746; ppl    115.07 | accu 0.2080 = 24003/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 14:43:17.772] End E005 |  test loss  8.824; ppl   6796.65 | accu 0.0530 = 5952/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:43:41.574] End E005 |  test loss  9.049; ppl   8509.43 | accu 0.0500 = 25350/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:43:41.574] Save: model.pt... 
[2022-04-13 14:43:42.013] Save: model.pt...Done. best_val_loss: 4.7455
[2022-04-13 14:43:42.013] Epoch 006/20 ==================================================
[2022-04-13 14:43:57.087] E006 |   200/731 batches | lr 20.0000 | loss  4.203 | ppl     66.90 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:44:13.035] E006 |   400/731 batches | lr 20.0000 | loss  4.209 | ppl     67.31 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:44:28.355] E006 |   600/731 batches | lr 20.0000 | loss  4.123 | ppl     61.74 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:44:39.382] E006 |   731/731 batches | lr 20.0000 | loss  4.109 | ppl     60.86 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 14:44:45.726] End E006 | valid loss  4.723; ppl    112.50 | accu 0.2098 = 24203/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 14:44:51.998] End E006 |  test loss  8.697; ppl   5982.31 | accu 0.0527 = 5918/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:45:20.581] End E006 |  test loss  9.006; ppl   8151.17 | accu 0.0506 = 25637/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:45:20.582] Save: model.pt... 
[2022-04-13 14:45:21.010] Save: model.pt...Done. best_val_loss: 4.7230
[2022-04-13 14:45:21.011] Epoch 007/20 ==================================================
[2022-04-13 14:45:36.248] E007 |   200/731 batches | lr 20.0000 | loss  4.110 | ppl     60.96 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:45:51.479] E007 |   400/731 batches | lr 20.0000 | loss  4.124 | ppl     61.79 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:46:07.783] E007 |   600/731 batches | lr 20.0000 | loss  4.040 | ppl     56.85 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:46:17.770] E007 |   731/731 batches | lr 20.0000 | loss  4.023 | ppl     55.85 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 14:46:23.018] End E007 | valid loss  4.683; ppl    108.12 | accu 0.2185 = 25216/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 14:46:28.238] End E007 |  test loss  8.886; ppl   7227.06 | accu 0.0567 = 6361/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:46:51.959] End E007 |  test loss  9.125; ppl   9180.14 | accu 0.0515 = 26100/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:46:51.959] Save: model.pt... 
[2022-04-13 14:46:52.394] Save: model.pt...Done. best_val_loss: 4.6832
[2022-04-13 14:46:52.394] Epoch 008/20 ==================================================
[2022-04-13 14:47:07.905] E008 |   200/731 batches | lr 20.0000 | loss  4.031 | ppl     56.30 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:47:23.220] E008 |   400/731 batches | lr 20.0000 | loss  4.048 | ppl     57.31 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:47:39.046] E008 |   600/731 batches | lr 20.0000 | loss  3.969 | ppl     52.93 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:47:48.935] E008 |   731/731 batches | lr 20.0000 | loss  3.950 | ppl     51.93 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 14:47:54.221] End E008 | valid loss  4.699; ppl    109.80 | accu 0.2165 = 24978/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 14:47:59.461] End E008 |  test loss  8.941; ppl   7639.17 | accu 0.0541 = 6076/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:48:23.467] End E008 |  test loss  9.268; ppl  10593.58 | accu 0.0499 = 25304/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:48:23.467] Epoch 009/20 ==================================================
[2022-04-13 14:48:38.881] E009 |   200/731 batches | lr 10.0000 | loss  3.904 | ppl     49.62 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:48:54.081] E009 |   400/731 batches | lr 10.0000 | loss  3.882 | ppl     48.53 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:49:09.412] E009 |   600/731 batches | lr 10.0000 | loss  3.768 | ppl     43.29 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:49:19.363] E009 |   731/731 batches | lr 10.0000 | loss  3.726 | ppl     41.53 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 14:49:24.622] End E009 | valid loss  4.599; ppl     99.37 | accu 0.2389 = 27559/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 14:49:29.829] End E009 |  test loss  9.325; ppl  11212.85 | accu 0.0556 = 6238/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:49:53.569] End E009 |  test loss  9.328; ppl  11248.46 | accu 0.0557 = 28253/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:49:53.570] Save: model.pt... 
[2022-04-13 14:49:54.087] Save: model.pt...Done. best_val_loss: 4.5988
[2022-04-13 14:49:54.088] Epoch 010/20 ==================================================
[2022-04-13 14:50:09.170] E010 |   200/731 batches | lr 10.0000 | loss  3.806 | ppl     44.98 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:50:24.858] E010 |   400/731 batches | lr 10.0000 | loss  3.807 | ppl     45.03 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:50:40.118] E010 |   600/731 batches | lr 10.0000 | loss  3.709 | ppl     40.81 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:50:50.161] E010 |   731/731 batches | lr 10.0000 | loss  3.676 | ppl     39.48 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 14:50:55.387] End E010 | valid loss  4.603; ppl     99.83 | accu 0.2399 = 27678/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 14:51:00.608] End E010 |  test loss  9.258; ppl  10484.80 | accu 0.0552 = 6197/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:51:24.395] End E010 |  test loss  9.448; ppl  12685.48 | accu 0.0544 = 27590/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:51:24.395] Epoch 011/20 ==================================================
[2022-04-13 14:51:39.679] E011 |   200/731 batches | lr 5.0000 | loss  3.730 | ppl     41.68 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:51:54.881] E011 |   400/731 batches | lr 5.0000 | loss  3.718 | ppl     41.18 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:52:10.651] E011 |   600/731 batches | lr 5.0000 | loss  3.600 | ppl     36.60 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:52:20.338] E011 |   731/731 batches | lr 5.0000 | loss  3.554 | ppl     34.95 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 14:52:25.613] End E011 | valid loss  4.582; ppl     97.73 | accu 0.2453 = 28299/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 14:52:30.849] End E011 |  test loss  9.523; ppl  13671.20 | accu 0.0543 = 6093/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:52:56.606] End E011 |  test loss  9.514; ppl  13553.74 | accu 0.0570 = 28902/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:52:56.606] Save: model.pt... 
[2022-04-13 14:52:57.070] Save: model.pt...Done. best_val_loss: 4.5822
[2022-04-13 14:52:57.070] Epoch 012/20 ==================================================
[2022-04-13 14:53:12.326] E012 |   200/731 batches | lr 5.0000 | loss  3.671 | ppl     39.28 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:53:27.572] E012 |   400/731 batches | lr 5.0000 | loss  3.671 | ppl     39.28 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:53:42.747] E012 |   600/731 batches | lr 5.0000 | loss  3.564 | ppl     35.32 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:53:52.722] E012 |   731/731 batches | lr 5.0000 | loss  3.531 | ppl     34.15 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 14:53:58.022] End E012 | valid loss  4.586; ppl     98.13 | accu 0.2445 = 28208/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 14:54:03.282] End E012 |  test loss  9.519; ppl  13622.34 | accu 0.0558 = 6265/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:54:27.285] End E012 |  test loss  9.607; ppl  14867.77 | accu 0.0567 = 28744/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:54:27.286] Epoch 013/20 ==================================================
[2022-04-13 14:54:42.391] E013 |   200/731 batches | lr 2.5000 | loss  3.635 | ppl     37.91 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:54:57.976] E013 |   400/731 batches | lr 2.5000 | loss  3.630 | ppl     37.70 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:55:13.301] E013 |   600/731 batches | lr 2.5000 | loss  3.509 | ppl     33.42 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:55:23.323] E013 |   731/731 batches | lr 2.5000 | loss  3.460 | ppl     31.83 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 14:55:28.624] End E013 | valid loss  4.581; ppl     97.63 | accu 0.2464 = 28424/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 14:55:33.860] End E013 |  test loss  9.531; ppl  13784.57 | accu 0.0576 = 6468/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:55:57.675] End E013 |  test loss  9.557; ppl  14139.90 | accu 0.0597 = 30274/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:55:57.675] Save: model.pt... 
[2022-04-13 14:55:58.145] Save: model.pt...Done. best_val_loss: 4.5811
[2022-04-13 14:55:58.145] Epoch 014/20 ==================================================
[2022-04-13 14:56:13.473] E014 |   200/731 batches | lr 2.5000 | loss  3.598 | ppl     36.51 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:56:28.619] E014 |   400/731 batches | lr 2.5000 | loss  3.601 | ppl     36.65 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:56:43.975] E014 |   600/731 batches | lr 2.5000 | loss  3.495 | ppl     32.94 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:56:53.989] E014 |   731/731 batches | lr 2.5000 | loss  3.452 | ppl     31.57 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 14:56:59.285] End E014 | valid loss  4.582; ppl     97.69 | accu 0.2467 = 28464/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 14:57:04.502] End E014 |  test loss  9.510; ppl  13492.08 | accu 0.0580 = 6507/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:57:28.473] End E014 |  test loss  9.616; ppl  15006.98 | accu 0.0594 = 30131/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:57:28.474] Epoch 015/20 ==================================================
[2022-04-13 14:57:43.965] E015 |   200/731 batches | lr 1.2500 | loss  3.583 | ppl     35.98 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:57:59.277] E015 |   400/731 batches | lr 1.2500 | loss  3.581 | ppl     35.92 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:58:14.802] E015 |   600/731 batches | lr 1.2500 | loss  3.464 | ppl     31.93 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:58:25.892] E015 |   731/731 batches | lr 1.2500 | loss  3.414 | ppl     30.39 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 14:58:32.324] End E015 | valid loss  4.578; ppl     97.33 | accu 0.2474 = 28547/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 14:58:38.582] End E015 |  test loss  9.434; ppl  12503.07 | accu 0.0603 = 6765/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 14:59:02.310] End E015 |  test loss  9.573; ppl  14369.21 | accu 0.0616 = 31207/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 14:59:02.310] Save: model.pt... 
[2022-04-13 14:59:02.772] Save: model.pt...Done. best_val_loss: 4.5781
[2022-04-13 14:59:02.772] Epoch 016/20 ==================================================
[2022-04-13 14:59:17.954] E016 |   200/731 batches | lr 1.2500 | loss  3.565 | ppl     35.35 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 14:59:33.130] E016 |   400/731 batches | lr 1.2500 | loss  3.563 | ppl     35.25 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 14:59:48.388] E016 |   600/731 batches | lr 1.2500 | loss  3.455 | ppl     31.65 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 14:59:58.402] E016 |   731/731 batches | lr 1.2500 | loss  3.408 | ppl     30.22 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 15:00:03.664] End E016 | valid loss  4.577; ppl     97.27 | accu 0.2480 = 28616/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 15:00:08.883] End E016 |  test loss  9.386; ppl  11921.11 | accu 0.0614 = 6892/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:00:32.645] End E016 |  test loss  9.579; ppl  14454.77 | accu 0.0625 = 31692/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:00:32.645] Save: model.pt... 
[2022-04-13 15:00:33.104] Save: model.pt...Done. best_val_loss: 4.5775
[2022-04-13 15:00:33.104] Epoch 017/20 ==================================================
[2022-04-13 15:00:48.351] E017 |   200/731 batches | lr 1.2500 | loss  3.547 | ppl     34.69 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 15:01:03.792] E017 |   400/731 batches | lr 1.2500 | loss  3.551 | ppl     34.84 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 15:01:19.095] E017 |   600/731 batches | lr 1.2500 | loss  3.447 | ppl     31.40 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 15:01:29.251] E017 |   731/731 batches | lr 1.2500 | loss  3.406 | ppl     30.15 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 15:01:34.482] End E017 | valid loss  4.579; ppl     97.39 | accu 0.2479 = 28604/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 15:01:39.694] End E017 |  test loss  9.361; ppl  11628.66 | accu 0.0620 = 6956/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:02:03.531] End E017 |  test loss  9.572; ppl  14351.17 | accu 0.0624 = 31637/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:02:03.531] Epoch 018/20 ==================================================
[2022-04-13 15:02:18.655] E018 |   200/731 batches | lr 0.6250 | loss  3.544 | ppl     34.60 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 15:02:33.796] E018 |   400/731 batches | lr 0.6250 | loss  3.545 | ppl     34.65 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 15:02:49.079] E018 |   600/731 batches | lr 0.6250 | loss  3.429 | ppl     30.85 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 15:02:59.068] E018 |   731/731 batches | lr 0.6250 | loss  3.386 | ppl     29.55 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 15:03:04.358] End E018 | valid loss  4.575; ppl     97.03 | accu 0.2486 = 28683/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 15:03:09.564] End E018 |  test loss  9.320; ppl  11158.05 | accu 0.0634 = 7111/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:03:33.343] End E018 |  test loss  9.573; ppl  14367.25 | accu 0.0631 = 31975/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:03:33.343] Save: model.pt... 
[2022-04-13 15:03:33.801] Save: model.pt...Done. best_val_loss: 4.5750
[2022-04-13 15:03:33.802] Epoch 019/20 ==================================================
[2022-04-13 15:03:49.055] E019 |   200/731 batches | lr 0.6250 | loss  3.531 | ppl     34.17 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 15:04:04.747] E019 |   400/731 batches | lr 0.6250 | loss  3.537 | ppl     34.35 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 15:04:20.157] E019 |   600/731 batches | lr 0.6250 | loss  3.430 | ppl     30.87 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 15:04:30.639] E019 |   731/731 batches | lr 0.6250 | loss  3.384 | ppl     29.50 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 15:04:35.915] End E019 | valid loss  4.576; ppl     97.13 | accu 0.2481 = 28621/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 15:04:41.142] End E019 |  test loss  9.311; ppl  11061.27 | accu 0.0633 = 7108/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:05:04.957] End E019 |  test loss  9.566; ppl  14270.29 | accu 0.0632 = 32038/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:05:04.957] Epoch 020/20 ==================================================
[2022-04-13 15:05:20.038] E020 |   200/731 batches | lr 0.3125 | loss  3.527 | ppl     34.03 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 15:05:35.237] E020 |   400/731 batches | lr 0.3125 | loss  3.532 | ppl     34.20 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 15:05:50.569] E020 |   600/731 batches | lr 0.3125 | loss  3.418 | ppl     30.50 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 15:06:00.488] E020 |   731/731 batches | lr 0.3125 | loss  3.374 | ppl     29.21 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 15:06:05.753] End E020 | valid loss  4.573; ppl     96.84 | accu 0.2484 = 28656/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 15:06:10.964] End E020 |  test loss  9.298; ppl  10911.75 | accu 0.0639 = 7175/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:06:34.970] End E020 |  test loss  9.539; ppl  13894.94 | accu 0.0638 = 32340/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:06:34.971] Save: model.pt... 
[2022-04-13 15:06:35.413] Save: model.pt...Done. best_val_loss: 4.5731
[2022-04-13 15:06:40.840] End. test loss  9.30; ppl 10911.75 | accu 0.0639 = 7175/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:07:04.655] End. test loss  9.54; ppl 13894.94 | accu 0.0638 = 32340/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:07:04.655] =========================================================================================
[2022-04-13 15:07:04.655] valid_loss
[2022-04-13 15:07:04.655]  5.42, 5.07, 4.90, 4.80, 4.75, 4.72, 4.68, 4.70, 4.60, 4.60, 4.58, 4.59, 4.58, 4.58, 4.58, 4.58, 4.58, 4.57, 4.58, 4.57
[2022-04-13 15:07:04.655] valid_loss ppl
[2022-04-13 15:07:04.655]   225.96,  159.51,  133.96,  121.89,  115.07,  112.50,  108.12,  109.80,   99.37,   99.83,   97.73,   98.13,   97.63,   97.69,   97.33,   97.27,   97.39,   97.03,   97.13,   96.84
[2022-04-13 15:07:04.655] test_loss of ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:07:04.655]  8.98, 8.70, 8.65, 8.71, 8.82, 8.70, 8.89, 8.94, 9.32, 9.26, 9.52, 9.52, 9.53, 9.51, 9.43, 9.39, 9.36, 9.32, 9.31, 9.30
[2022-04-13 15:07:04.656] test_loss of ../data/sample_500k/adolescent_valid.txt ppl
[2022-04-13 15:07:04.656]  7965.40, 5982.88, 5701.62, 6091.86, 6796.65, 5982.31, 7227.06, 7639.17,11212.85,10484.80,13671.20,13622.34,13784.57,13492.08,12503.07,11921.11,11628.66,11158.05,11061.27,10911.75
[2022-04-13 15:07:04.656] test_loss of ../data/sample_500k/adult_test.txt
[2022-04-13 15:07:04.656]  9.01, 8.88, 8.91, 8.98, 9.05, 9.01, 9.12, 9.27, 9.33, 9.45, 9.51, 9.61, 9.56, 9.62, 9.57, 9.58, 9.57, 9.57, 9.57, 9.54
[2022-04-13 15:07:04.656] test_loss of ../data/sample_500k/adult_test.txt ppl
[2022-04-13 15:07:04.656]  8153.03, 7206.27, 7395.41, 7909.25, 8509.43, 8151.17, 9180.14,10593.58,11248.46,12685.48,13553.74,14867.77,14139.90,15006.98,14369.21,14454.77,14351.17,14367.25,14270.29,13894.94
[2022-04-13 15:07:04.656] 
[2022-04-13 15:07:04.656] 
[2022-04-13 15:07:04.656] 
Log file: ./output_wsm_Subword.500_fam_CNN.log closed.
Log file: ./output_wsm_Subword.500_fam_LSTM.log open...
[2022-04-13 15:07:04.665] corpus.train_file_list: 1
[2022-04-13 15:07:04.665]         ../data/sample_500k/cbt_train.txt
[2022-04-13 15:07:04.665] corpus.valid_file_list: 1
[2022-04-13 15:07:04.665]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:07:04.665] corpus.test_file_list: 2
[2022-04-13 15:07:04.665]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:07:04.665]         ../data/sample_500k/adult_test.txt
[2022-04-13 15:07:04.665] corpus.subword_vocab_size: 0
[2022-04-13 15:07:04.665] corpus.subword_model = None. Corpus will not use subword.
[2022-04-13 15:07:04.665] corpus tokenize...
[2022-04-13 15:07:05.320]         train tokens: 511735  ../data/sample_500k/cbt_train.txt
[2022-04-13 15:07:05.456]         valid tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:07:05.682]         test  tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:07:06.291]         test  tokens: 506878  ../data/sample_500k/adult_test.txt
[2022-04-13 15:07:06.291] corpus.ntokens      : 73236
[2022-04-13 15:07:06.291] corpus.char_count   : 157
[2022-04-13 15:07:06.291] corpus.char_cnt_dict: 157
[2022-04-13 15:07:06.291] corpus.char_id_dict : 157
[2022-04-13 15:07:06.295] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 15:07:06.295]         tokens_all: 511735
[2022-04-13 15:07:06.295]         batched   :  25586
[2022-04-13 15:07:06.295]         ../data/sample_500k/cbt_train.txt
[2022-04-13 15:07:06.297] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 15:07:06.297]         tokens_all: 115417
[2022-04-13 15:07:06.297]         batched   :   5770
[2022-04-13 15:07:06.298]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:07:06.299] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 15:07:06.299]         tokens_all: 112256
[2022-04-13 15:07:06.299]         batched   :   5612
[2022-04-13 15:07:06.299]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:07:06.303] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 15:07:06.303]         tokens_all: 506878
[2022-04-13 15:07:06.303]         batched   :  25343
[2022-04-13 15:07:06.303]         ../data/sample_500k/adult_test.txt
[2022-04-13 15:07:06.304] subword_adapter will be generated due to word_split_mode='Subword.500'
[2022-04-13 15:07:06.304] SubwordAdapter.file_list: 2
[2022-04-13 15:07:06.304]         ../data/sample_500k/cbt_train.txt
[2022-04-13 15:07:06.304]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 15:07:06.304] SubwordAdapter.subword_vocab_size: 500
[2022-04-13 15:07:06.304] SubwordAdapter.subword_model.train(2 files)...
[2022-04-13 15:07:06.591] SubwordAdapter.subword_model.train(2 files)...Done
[2022-04-13 15:07:07.218] RNNModel.rnn_type: LSTM
[2022-04-13 15:07:07.218] RNNModel.ntoken  : 73236
[2022-04-13 15:07:07.219] RNNModel.ninp    : 200
[2022-04-13 15:07:07.219] RNNModel.nhid    : 200
[2022-04-13 15:07:07.219] RNNModel.nlayers : 2
[2022-04-13 15:07:07.219] RNNModel.dropout : 0.2
[2022-04-13 15:07:07.219] RNNModel.tie_weights: False
[2022-04-13 15:07:07.219] RNNModel.fragment_aggregate_mode: LSTM
[2022-04-13 15:07:07.219] RNNModel.fragment_cnt           : 502
[2022-04-13 15:07:07.219] RNNModel.fragment_emsize        : 25
[2022-04-13 15:07:07.219] RNNModel.fragment_nhid          : 200
[2022-04-13 15:07:07.220] RNNModel.fragment_embeds     : created
[2022-04-13 15:07:07.223] RNNModel.fragment_lstm       : created
[2022-04-13 15:07:07.223] RNNModel.fragment_lstm_linear: created
[2022-04-13 15:07:07.251] Epoch 001/20 ==================================================
[2022-04-13 15:08:10.439] E001 |   200/731 batches | lr 20.0000 | loss  7.318 | ppl   1506.53 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 15:09:12.112] E001 |   400/731 batches | lr 20.0000 | loss  5.987 | ppl    398.11 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 15:10:12.127] E001 |   600/731 batches | lr 20.0000 | loss  5.368 | ppl    214.44 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 15:10:55.224] E001 |   731/731 batches | lr 20.0000 | loss  5.211 | ppl    183.25 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 15:11:09.472] End E001 | valid loss  5.405; ppl    222.54 | accu 0.1539 = 17758/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 15:11:23.611] End E001 |  test loss  8.907; ppl   7380.43 | accu 0.0266 = 2989/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:12:26.916] End E001 |  test loss  9.048; ppl   8499.26 | accu 0.0277 = 14024/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:12:26.916] Save: model.pt... 
[2022-04-13 15:12:27.371] Save: model.pt...Done. best_val_loss: 5.4051
[2022-04-13 15:12:27.371] Epoch 002/20 ==================================================
[2022-04-13 15:13:33.523] E002 |   200/731 batches | lr 20.0000 | loss  5.057 | ppl    157.14 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 15:14:40.806] E002 |   400/731 batches | lr 20.0000 | loss  4.960 | ppl    142.55 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 15:15:46.597] E002 |   600/731 batches | lr 20.0000 | loss  4.751 | ppl    115.75 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 15:16:30.204] E002 |   731/731 batches | lr 20.0000 | loss  4.701 | ppl    110.10 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 15:16:44.612] End E002 | valid loss  5.049; ppl    155.81 | accu 0.1828 = 21089/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 15:16:58.530] End E002 |  test loss  8.747; ppl   6293.55 | accu 0.0428 = 4807/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:18:08.255] End E002 |  test loss  8.959; ppl   7779.08 | accu 0.0436 = 22096/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:18:08.255] Save: model.pt... 
[2022-04-13 15:18:08.698] Save: model.pt...Done. best_val_loss: 5.0486
[2022-04-13 15:18:08.698] Epoch 003/20 ==================================================
[2022-04-13 15:19:13.315] E003 |   200/731 batches | lr 20.0000 | loss  4.655 | ppl    105.06 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 15:20:19.107] E003 |   400/731 batches | lr 20.0000 | loss  4.624 | ppl    101.88 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 15:21:22.804] E003 |   600/731 batches | lr 20.0000 | loss  4.483 | ppl     88.53 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 15:22:07.995] E003 |   731/731 batches | lr 20.0000 | loss  4.460 | ppl     86.45 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 15:22:22.088] End E003 | valid loss  4.881; ppl    131.75 | accu 0.1997 = 23040/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 15:22:35.987] End E003 |  test loss  8.616; ppl   5519.60 | accu 0.0509 = 5716/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:23:46.622] End E003 |  test loss  8.924; ppl   7510.15 | accu 0.0504 = 25557/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:23:46.622] Save: model.pt... 
[2022-04-13 15:23:47.064] Save: model.pt...Done. best_val_loss: 4.8809
[2022-04-13 15:23:47.065] Epoch 004/20 ==================================================
[2022-04-13 15:24:51.013] E004 |   200/731 batches | lr 20.0000 | loss  4.433 | ppl     84.19 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 15:25:54.231] E004 |   400/731 batches | lr 20.0000 | loss  4.425 | ppl     83.53 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 15:27:00.838] E004 |   600/731 batches | lr 20.0000 | loss  4.314 | ppl     74.75 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 15:27:43.045] E004 |   731/731 batches | lr 20.0000 | loss  4.294 | ppl     73.25 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 15:27:57.498] End E004 | valid loss  4.842; ppl    126.72 | accu 0.2034 = 23467/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 15:28:11.565] End E004 |  test loss  8.693; ppl   5960.07 | accu 0.0506 = 5676/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:29:19.338] End E004 |  test loss  9.085; ppl   8824.05 | accu 0.0500 = 25343/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:29:19.338] Save: model.pt... 
[2022-04-13 15:29:19.777] Save: model.pt...Done. best_val_loss: 4.8420
[2022-04-13 15:29:19.777] Epoch 005/20 ==================================================
[2022-04-13 15:30:25.566] E005 |   200/731 batches | lr 20.0000 | loss  4.282 | ppl     72.37 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 15:31:28.319] E005 |   400/731 batches | lr 20.0000 | loss  4.286 | ppl     72.70 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 15:32:32.801] E005 |   600/731 batches | lr 20.0000 | loss  4.187 | ppl     65.83 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 15:33:16.547] E005 |   731/731 batches | lr 20.0000 | loss  4.170 | ppl     64.71 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 15:33:33.883] End E005 | valid loss  4.731; ppl    113.43 | accu 0.2124 = 24510/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 15:33:49.189] End E005 |  test loss  8.605; ppl   5457.48 | accu 0.0559 = 6268/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:34:57.119] End E005 |  test loss  9.038; ppl   8415.52 | accu 0.0553 = 28027/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:34:57.119] Save: model.pt... 
[2022-04-13 15:34:57.565] Save: model.pt...Done. best_val_loss: 4.7312
[2022-04-13 15:34:57.565] Epoch 006/20 ==================================================
[2022-04-13 15:36:05.383] E006 |   200/731 batches | lr 20.0000 | loss  4.161 | ppl     64.12 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 15:37:08.626] E006 |   400/731 batches | lr 20.0000 | loss  4.174 | ppl     64.99 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 15:38:11.483] E006 |   600/731 batches | lr 20.0000 | loss  4.088 | ppl     59.63 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 15:38:54.121] E006 |   731/731 batches | lr 20.0000 | loss  4.067 | ppl     58.37 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 15:39:08.393] End E006 | valid loss  4.709; ppl    110.93 | accu 0.2119 = 24450/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 15:39:22.468] End E006 |  test loss  8.654; ppl   5734.90 | accu 0.0513 = 5757/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:40:26.662] End E006 |  test loss  9.206; ppl   9954.82 | accu 0.0464 = 23538/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:40:26.662] Save: model.pt... 
[2022-04-13 15:40:27.099] Save: model.pt...Done. best_val_loss: 4.7089
[2022-04-13 15:40:27.100] Epoch 007/20 ==================================================
[2022-04-13 15:41:33.394] E007 |   200/731 batches | lr 20.0000 | loss  4.066 | ppl     58.31 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 15:42:37.025] E007 |   400/731 batches | lr 20.0000 | loss  4.082 | ppl     59.27 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 15:43:41.878] E007 |   600/731 batches | lr 20.0000 | loss  3.993 | ppl     54.21 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 15:44:22.958] E007 |   731/731 batches | lr 20.0000 | loss  3.980 | ppl     53.51 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 15:44:38.957] End E007 | valid loss  4.680; ppl    107.81 | accu 0.2226 = 25683/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 15:44:56.876] End E007 |  test loss  8.649; ppl   5704.33 | accu 0.0574 = 6439/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:46:02.148] End E007 |  test loss  9.239; ppl  10291.58 | accu 0.0553 = 28004/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:46:02.148] Save: model.pt... 
[2022-04-13 15:46:02.585] Save: model.pt...Done. best_val_loss: 4.6804
[2022-04-13 15:46:02.585] Epoch 008/20 ==================================================
[2022-04-13 15:47:08.083] E008 |   200/731 batches | lr 20.0000 | loss  3.981 | ppl     53.57 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 15:48:13.383] E008 |   400/731 batches | lr 20.0000 | loss  3.997 | ppl     54.45 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 15:49:16.775] E008 |   600/731 batches | lr 20.0000 | loss  3.918 | ppl     50.28 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 15:49:59.599] E008 |   731/731 batches | lr 20.0000 | loss  3.903 | ppl     49.54 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 15:50:14.007] End E008 | valid loss  4.676; ppl    107.38 | accu 0.2212 = 25522/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 15:50:28.187] End E008 |  test loss  8.685; ppl   5913.01 | accu 0.0573 = 6431/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:51:32.803] End E008 |  test loss  9.207; ppl   9969.32 | accu 0.0547 = 27744/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:51:32.803] Save: model.pt... 
[2022-04-13 15:51:33.241] Save: model.pt...Done. best_val_loss: 4.6764
[2022-04-13 15:51:33.241] Epoch 009/20 ==================================================
[2022-04-13 15:52:38.405] E009 |   200/731 batches | lr 20.0000 | loss  3.907 | ppl     49.73 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 15:53:44.382] E009 |   400/731 batches | lr 20.0000 | loss  3.927 | ppl     50.76 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 15:54:50.855] E009 |   600/731 batches | lr 20.0000 | loss  3.847 | ppl     46.85 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 15:55:35.418] E009 |   731/731 batches | lr 20.0000 | loss  3.830 | ppl     46.07 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 15:55:49.859] End E009 | valid loss  4.658; ppl    105.45 | accu 0.2257 = 26039/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 15:56:04.322] End E009 |  test loss  8.749; ppl   6305.36 | accu 0.0599 = 6718/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 15:57:10.666] End E009 |  test loss  9.280; ppl  10724.75 | accu 0.0590 = 29894/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 15:57:10.667] Save: model.pt... 
[2022-04-13 15:57:11.108] Save: model.pt...Done. best_val_loss: 4.6583
[2022-04-13 15:57:11.108] Epoch 010/20 ==================================================
[2022-04-13 15:58:21.110] E010 |   200/731 batches | lr 20.0000 | loss  3.837 | ppl     46.39 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 15:59:25.350] E010 |   400/731 batches | lr 20.0000 | loss  3.861 | ppl     47.51 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 16:00:29.227] E010 |   600/731 batches | lr 20.0000 | loss  3.787 | ppl     44.14 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 16:01:11.922] E010 |   731/731 batches | lr 20.0000 | loss  3.763 | ppl     43.09 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 16:01:26.221] End E010 | valid loss  4.671; ppl    106.78 | accu 0.2283 = 26342/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 16:01:40.249] End E010 |  test loss  8.833; ppl   6854.64 | accu 0.0554 = 6217/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:02:46.350] End E010 |  test loss  9.411; ppl  12218.47 | accu 0.0525 = 26593/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:02:46.350] Epoch 011/20 ==================================================
[2022-04-13 16:03:52.427] E011 |   200/731 batches | lr 10.0000 | loss  3.728 | ppl     41.58 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 16:04:59.485] E011 |   400/731 batches | lr 10.0000 | loss  3.706 | ppl     40.70 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 16:06:02.847] E011 |   600/731 batches | lr 10.0000 | loss  3.596 | ppl     36.45 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 16:06:46.554] E011 |   731/731 batches | lr 10.0000 | loss  3.548 | ppl     34.76 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 16:07:01.111] End E011 | valid loss  4.631; ppl    102.61 | accu 0.2396 = 27646/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 16:07:15.256] End E011 |  test loss  9.040; ppl   8434.79 | accu 0.0601 = 6739/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:08:20.471] End E011 |  test loss  9.637; ppl  15323.00 | accu 0.0591 = 29954/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:08:20.472] Save: model.pt... 
[2022-04-13 16:08:20.921] Save: model.pt...Done. best_val_loss: 4.6310
[2022-04-13 16:08:20.922] Epoch 012/20 ==================================================
[2022-04-13 16:09:29.095] E012 |   200/731 batches | lr 10.0000 | loss  3.622 | ppl     37.42 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 16:10:33.664] E012 |   400/731 batches | lr 10.0000 | loss  3.639 | ppl     38.05 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 16:11:38.836] E012 |   600/731 batches | lr 10.0000 | loss  3.541 | ppl     34.51 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 16:12:26.755] E012 |   731/731 batches | lr 10.0000 | loss  3.515 | ppl     33.61 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 16:12:41.158] End E012 | valid loss  4.628; ppl    102.27 | accu 0.2404 = 27733/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 16:12:55.348] End E012 |  test loss  9.128; ppl   9210.44 | accu 0.0594 = 6666/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:14:01.311] End E012 |  test loss  9.738; ppl  16948.08 | accu 0.0589 = 29836/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:14:01.311] Save: model.pt... 
[2022-04-13 16:14:01.754] Save: model.pt...Done. best_val_loss: 4.6276
[2022-04-13 16:14:01.754] Epoch 013/20 ==================================================
[2022-04-13 16:15:08.834] E013 |   200/731 batches | lr 10.0000 | loss  3.578 | ppl     35.79 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 16:16:12.305] E013 |   400/731 batches | lr 10.0000 | loss  3.591 | ppl     36.28 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 16:17:17.186] E013 |   600/731 batches | lr 10.0000 | loss  3.504 | ppl     33.24 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 16:18:00.777] E013 |   731/731 batches | lr 10.0000 | loss  3.475 | ppl     32.30 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 16:18:16.159] End E013 | valid loss  4.634; ppl    102.96 | accu 0.2408 = 27785/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 16:18:31.026] End E013 |  test loss  9.193; ppl   9829.65 | accu 0.0602 = 6757/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:19:41.707] End E013 |  test loss  9.760; ppl  17321.74 | accu 0.0591 = 29975/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:19:41.708] Epoch 014/20 ==================================================
[2022-04-13 16:20:46.556] E014 |   200/731 batches | lr 5.0000 | loss  3.518 | ppl     33.72 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 16:21:49.720] E014 |   400/731 batches | lr 5.0000 | loss  3.513 | ppl     33.56 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 16:22:58.089] E014 |   600/731 batches | lr 5.0000 | loss  3.405 | ppl     30.10 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 16:23:40.960] E014 |   731/731 batches | lr 5.0000 | loss  3.357 | ppl     28.71 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 16:23:57.723] End E014 | valid loss  4.633; ppl    102.81 | accu 0.2436 = 28104/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 16:24:16.007] End E014 |  test loss  9.318; ppl  11133.01 | accu 0.0595 = 6680/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:25:23.953] End E014 |  test loss  9.920; ppl  20332.05 | accu 0.0594 = 30097/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:25:23.954] Epoch 015/20 ==================================================
[2022-04-13 16:26:30.418] E015 |   200/731 batches | lr 2.5000 | loss  3.472 | ppl     32.19 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 16:27:33.906] E015 |   400/731 batches | lr 2.5000 | loss  3.466 | ppl     32.02 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 16:28:38.339] E015 |   600/731 batches | lr 2.5000 | loss  3.349 | ppl     28.47 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 16:29:21.674] E015 |   731/731 batches | lr 2.5000 | loss  3.302 | ppl     27.15 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 16:29:39.408] End E015 | valid loss  4.621; ppl    101.60 | accu 0.2456 = 28339/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 16:29:54.890] End E015 |  test loss  9.398; ppl  12058.59 | accu 0.0609 = 6834/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:31:00.052] End E015 |  test loss 10.050; ppl  23160.56 | accu 0.0607 = 30767/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:31:00.052] Save: model.pt... 
[2022-04-13 16:31:00.488] Save: model.pt...Done. best_val_loss: 4.6211
[2022-04-13 16:31:00.488] Epoch 016/20 ==================================================
[2022-04-13 16:32:07.650] E016 |   200/731 batches | lr 2.5000 | loss  3.439 | ppl     31.16 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 16:33:12.629] E016 |   400/731 batches | lr 2.5000 | loss  3.442 | ppl     31.25 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 16:34:20.895] E016 |   600/731 batches | lr 2.5000 | loss  3.335 | ppl     28.09 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 16:35:03.374] E016 |   731/731 batches | lr 2.5000 | loss  3.286 | ppl     26.74 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 16:35:18.529] End E016 | valid loss  4.623; ppl    101.84 | accu 0.2455 = 28322/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 16:35:34.967] End E016 |  test loss  9.433; ppl  12487.88 | accu 0.0614 = 6885/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:36:40.070] End E016 |  test loss 10.051; ppl  23177.78 | accu 0.0613 = 31047/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:36:40.071] Epoch 017/20 ==================================================
[2022-04-13 16:37:44.186] E017 |   200/731 batches | lr 1.2500 | loss  3.422 | ppl     30.62 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 16:38:55.104] E017 |   400/731 batches | lr 1.2500 | loss  3.424 | ppl     30.71 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 16:39:59.879] E017 |   600/731 batches | lr 1.2500 | loss  3.307 | ppl     27.30 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 16:40:45.298] E017 |   731/731 batches | lr 1.2500 | loss  3.259 | ppl     26.02 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 16:41:00.311] End E017 | valid loss  4.623; ppl    101.84 | accu 0.2471 = 28509/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 16:41:15.047] End E017 |  test loss  9.482; ppl  13122.59 | accu 0.0625 = 7018/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:42:22.475] End E017 |  test loss 10.119; ppl  24807.70 | accu 0.0619 = 31392/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:42:22.476] Epoch 018/20 ==================================================
[2022-04-13 16:43:27.554] E018 |   200/731 batches | lr 0.6250 | loss  3.412 | ppl     30.33 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 16:44:29.249] E018 |   400/731 batches | lr 0.6250 | loss  3.412 | ppl     30.33 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 16:45:33.315] E018 |   600/731 batches | lr 0.6250 | loss  3.295 | ppl     26.99 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 16:46:15.471] E018 |   731/731 batches | lr 0.6250 | loss  3.243 | ppl     25.60 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 16:46:29.920] End E018 | valid loss  4.617; ppl    101.17 | accu 0.2484 = 28660/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 16:46:44.598] End E018 |  test loss  9.469; ppl  12955.71 | accu 0.0633 = 7107/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:47:49.213] End E018 |  test loss 10.065; ppl  23497.50 | accu 0.0635 = 32198/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:47:49.213] Save: model.pt... 
[2022-04-13 16:47:49.711] Save: model.pt...Done. best_val_loss: 4.6168
[2022-04-13 16:47:49.711] Epoch 019/20 ==================================================
[2022-04-13 16:48:54.351] E019 |   200/731 batches | lr 0.6250 | loss  3.394 | ppl     29.80 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 16:49:56.193] E019 |   400/731 batches | lr 0.6250 | loss  3.401 | ppl     30.00 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 16:51:01.369] E019 |   600/731 batches | lr 0.6250 | loss  3.294 | ppl     26.95 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 16:51:45.271] E019 |   731/731 batches | lr 0.6250 | loss  3.241 | ppl     25.55 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 16:51:59.975] End E019 | valid loss  4.617; ppl    101.14 | accu 0.2483 = 28654/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 16:52:14.204] End E019 |  test loss  9.488; ppl  13205.54 | accu 0.0637 = 7154/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:53:18.577] End E019 |  test loss 10.061; ppl  23414.42 | accu 0.0636 = 32227/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:53:18.577] Save: model.pt... 
[2022-04-13 16:53:19.068] Save: model.pt...Done. best_val_loss: 4.6165
[2022-04-13 16:53:19.068] Epoch 020/20 ==================================================
[2022-04-13 16:54:25.681] E020 |   200/731 batches | lr 0.6250 | loss  3.389 | ppl     29.63 frag_cnt/word_cnt=1.735=242953/140000
[2022-04-13 16:55:32.423] E020 |   400/731 batches | lr 0.6250 | loss  3.398 | ppl     29.89 frag_cnt/word_cnt=1.736=243037/140000
[2022-04-13 16:56:37.130] E020 |   600/731 batches | lr 0.6250 | loss  3.287 | ppl     26.75 frag_cnt/word_cnt=1.722=241109/140000
[2022-04-13 16:57:20.982] E020 |   731/731 batches | lr 0.6250 | loss  3.236 | ppl     25.43 frag_cnt/word_cnt=1.726=158301/91700
[2022-04-13 16:57:35.374] End E020 | valid loss  4.620; ppl    101.54 | accu 0.2476 = 28565/115380 | w_len 1.6742 = 193174/115380
[2022-04-13 16:57:49.825] End E020 |  test loss  9.461; ppl  12849.26 | accu 0.0640 = 7181/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 16:58:55.890] End E020 |  test loss 10.066; ppl  23532.57 | accu 0.0635 = 32204/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 16:59:10.296] End. test loss  9.49; ppl 13205.54 | accu 0.0637 = 7154/112220 | w_len 2.2517 = 252690/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:00:15.299] End. test loss 10.06; ppl 23414.42 | accu 0.0636 = 32227/506840 | w_len 2.4540 = 1243777/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:00:15.299] =========================================================================================
[2022-04-13 17:00:15.299] valid_loss
[2022-04-13 17:00:15.299]  5.41, 5.05, 4.88, 4.84, 4.73, 4.71, 4.68, 4.68, 4.66, 4.67, 4.63, 4.63, 4.63, 4.63, 4.62, 4.62, 4.62, 4.62, 4.62, 4.62
[2022-04-13 17:00:15.299] valid_loss ppl
[2022-04-13 17:00:15.300]   222.54,  155.81,  131.75,  126.72,  113.43,  110.93,  107.81,  107.38,  105.45,  106.78,  102.61,  102.27,  102.96,  102.81,  101.60,  101.84,  101.84,  101.17,  101.14,  101.54
[2022-04-13 17:00:15.300] test_loss of ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:00:15.300]  8.91, 8.75, 8.62, 8.69, 8.60, 8.65, 8.65, 8.68, 8.75, 8.83, 9.04, 9.13, 9.19, 9.32, 9.40, 9.43, 9.48, 9.47, 9.49, 9.46
[2022-04-13 17:00:15.300] test_loss of ../data/sample_500k/adolescent_valid.txt ppl
[2022-04-13 17:00:15.300]  7380.43, 6293.55, 5519.60, 5960.07, 5457.48, 5734.90, 5704.33, 5913.01, 6305.36, 6854.64, 8434.79, 9210.44, 9829.65,11133.01,12058.59,12487.88,13122.59,12955.71,13205.54,12849.26
[2022-04-13 17:00:15.300] test_loss of ../data/sample_500k/adult_test.txt
[2022-04-13 17:00:15.300]  9.05, 8.96, 8.92, 9.09, 9.04, 9.21, 9.24, 9.21, 9.28, 9.41, 9.64, 9.74, 9.76, 9.92,10.05,10.05,10.12,10.06,10.06,10.07
[2022-04-13 17:00:15.300] test_loss of ../data/sample_500k/adult_test.txt ppl
[2022-04-13 17:00:15.300]  8499.26, 7779.08, 7510.15, 8824.05, 8415.52, 9954.82,10291.58, 9969.32,10724.75,12218.47,15323.00,16948.08,17321.74,20332.05,23160.56,23177.78,24807.70,23497.50,23414.42,23532.57
[2022-04-13 17:00:15.300] 
[2022-04-13 17:00:15.300] 
[2022-04-13 17:00:15.300] 
Log file: ./output_wsm_Subword.500_fam_LSTM.log closed.
Log file: ./output_wsm_Subword.1000_fam_CNN.log open...
[2022-04-13 17:00:15.310] corpus.train_file_list: 1
[2022-04-13 17:00:15.310]         ../data/sample_500k/cbt_train.txt
[2022-04-13 17:00:15.310] corpus.valid_file_list: 1
[2022-04-13 17:00:15.310]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 17:00:15.310] corpus.test_file_list: 2
[2022-04-13 17:00:15.310]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:00:15.310]         ../data/sample_500k/adult_test.txt
[2022-04-13 17:00:15.310] corpus.subword_vocab_size: 0
[2022-04-13 17:00:15.310] corpus.subword_model = None. Corpus will not use subword.
[2022-04-13 17:00:15.310] corpus tokenize...
[2022-04-13 17:00:15.976]         train tokens: 511735  ../data/sample_500k/cbt_train.txt
[2022-04-13 17:00:16.118]         valid tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-13 17:00:16.352]         test  tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:00:16.967]         test  tokens: 506878  ../data/sample_500k/adult_test.txt
[2022-04-13 17:00:16.967] corpus.ntokens      : 73236
[2022-04-13 17:00:16.967] corpus.char_count   : 157
[2022-04-13 17:00:16.967] corpus.char_cnt_dict: 157
[2022-04-13 17:00:16.967] corpus.char_id_dict : 157
[2022-04-13 17:00:16.973] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 17:00:16.973]         tokens_all: 511735
[2022-04-13 17:00:16.973]         batched   :  25586
[2022-04-13 17:00:16.973]         ../data/sample_500k/cbt_train.txt
[2022-04-13 17:00:16.975] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 17:00:16.975]         tokens_all: 115417
[2022-04-13 17:00:16.975]         batched   :   5770
[2022-04-13 17:00:16.975]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 17:00:16.976] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 17:00:16.977]         tokens_all: 112256
[2022-04-13 17:00:16.977]         batched   :   5612
[2022-04-13 17:00:16.977]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:00:16.980] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 17:00:16.980]         tokens_all: 506878
[2022-04-13 17:00:16.981]         batched   :  25343
[2022-04-13 17:00:16.981]         ../data/sample_500k/adult_test.txt
[2022-04-13 17:00:16.981] subword_adapter will be generated due to word_split_mode='Subword.1000'
[2022-04-13 17:00:16.982] SubwordAdapter.file_list: 2
[2022-04-13 17:00:16.982]         ../data/sample_500k/cbt_train.txt
[2022-04-13 17:00:16.982]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 17:00:16.982] SubwordAdapter.subword_vocab_size: 1000
[2022-04-13 17:00:16.982] SubwordAdapter.subword_model.train(2 files)...
[2022-04-13 17:00:17.347] SubwordAdapter.subword_model.train(2 files)...Done
[2022-04-13 17:00:17.928] RNNModel.rnn_type: LSTM
[2022-04-13 17:00:17.928] RNNModel.ntoken  : 73236
[2022-04-13 17:00:17.928] RNNModel.ninp    : 200
[2022-04-13 17:00:17.928] RNNModel.nhid    : 200
[2022-04-13 17:00:17.928] RNNModel.nlayers : 2
[2022-04-13 17:00:17.928] RNNModel.dropout : 0.2
[2022-04-13 17:00:17.928] RNNModel.tie_weights: False
[2022-04-13 17:00:17.928] RNNModel.fragment_aggregate_mode: CNN
[2022-04-13 17:00:17.928] RNNModel.fragment_cnt           : 1002
[2022-04-13 17:00:17.929] RNNModel.fragment_emsize        : 25
[2022-04-13 17:00:17.929] RNNModel.fragment_nhid          : 200
[2022-04-13 17:00:17.929] RNNModel.fragment_embeds     : created
[2022-04-13 17:00:17.930] RNNModel.fragment_cnn3       : created
[2022-04-13 17:00:17.979] Epoch 001/20 ==================================================
[2022-04-13 17:00:33.126] E001 |   200/731 batches | lr 20.0000 | loss  7.322 | ppl   1513.46 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:00:48.298] E001 |   400/731 batches | lr 20.0000 | loss  5.943 | ppl    381.17 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:01:05.254] E001 |   600/731 batches | lr 20.0000 | loss  5.342 | ppl    209.02 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:01:16.412] E001 |   731/731 batches | lr 20.0000 | loss  5.168 | ppl    175.58 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:01:22.843] End E001 | valid loss  5.305; ppl    201.31 | accu 0.1712 = 19751/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:01:29.214] End E001 |  test loss  8.864; ppl   7069.30 | accu 0.0383 = 4303/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:01:54.135] End E001 |  test loss  9.156; ppl   9474.36 | accu 0.0322 = 16344/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:01:54.135] Save: model.pt... 
[2022-04-13 17:01:54.609] Save: model.pt...Done. best_val_loss: 5.3049
[2022-04-13 17:01:54.609] Epoch 002/20 ==================================================
[2022-04-13 17:02:09.734] E002 |   200/731 batches | lr 20.0000 | loss  5.022 | ppl    151.66 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:02:24.827] E002 |   400/731 batches | lr 20.0000 | loss  4.931 | ppl    138.50 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:02:39.946] E002 |   600/731 batches | lr 20.0000 | loss  4.735 | ppl    113.82 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:02:49.802] E002 |   731/731 batches | lr 20.0000 | loss  4.690 | ppl    108.88 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:02:55.081] End E002 | valid loss  4.909; ppl    135.56 | accu 0.2020 = 23307/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:03:00.303] End E002 |  test loss  8.657; ppl   5749.82 | accu 0.0533 = 5980/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:03:24.083] End E002 |  test loss  8.924; ppl   7507.99 | accu 0.0508 = 25757/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:03:24.083] Save: model.pt... 
[2022-04-13 17:03:24.547] Save: model.pt...Done. best_val_loss: 4.9094
[2022-04-13 17:03:24.548] Epoch 003/20 ==================================================
[2022-04-13 17:03:39.504] E003 |   200/731 batches | lr 20.0000 | loss  4.641 | ppl    103.65 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:03:54.763] E003 |   400/731 batches | lr 20.0000 | loss  4.618 | ppl    101.30 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:04:10.070] E003 |   600/731 batches | lr 20.0000 | loss  4.483 | ppl     88.47 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:04:19.991] E003 |   731/731 batches | lr 20.0000 | loss  4.456 | ppl     86.15 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:04:25.362] End E003 | valid loss  4.825; ppl    124.58 | accu 0.2032 = 23442/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:04:30.615] End E003 |  test loss  8.594; ppl   5400.54 | accu 0.0528 = 5927/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:04:54.518] End E003 |  test loss  8.951; ppl   7711.82 | accu 0.0522 = 26433/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:04:54.519] Save: model.pt... 
[2022-04-13 17:04:55.015] Save: model.pt...Done. best_val_loss: 4.8249
[2022-04-13 17:04:55.015] Epoch 004/20 ==================================================
[2022-04-13 17:05:10.062] E004 |   200/731 batches | lr 20.0000 | loss  4.438 | ppl     84.60 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:05:25.244] E004 |   400/731 batches | lr 20.0000 | loss  4.432 | ppl     84.07 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:05:40.395] E004 |   600/731 batches | lr 20.0000 | loss  4.319 | ppl     75.08 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:05:50.820] E004 |   731/731 batches | lr 20.0000 | loss  4.299 | ppl     73.65 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:05:57.311] End E004 | valid loss  4.805; ppl    122.11 | accu 0.2049 = 23646/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:06:03.674] End E004 |  test loss  8.608; ppl   5476.18 | accu 0.0553 = 6206/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:06:32.556] End E004 |  test loss  8.934; ppl   7587.00 | accu 0.0578 = 29294/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:06:32.556] Save: model.pt... 
[2022-04-13 17:06:33.030] Save: model.pt...Done. best_val_loss: 4.8049
[2022-04-13 17:06:33.030] Epoch 005/20 ==================================================
[2022-04-13 17:06:48.847] E005 |   200/731 batches | lr 20.0000 | loss  4.293 | ppl     73.20 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:07:03.983] E005 |   400/731 batches | lr 20.0000 | loss  4.295 | ppl     73.35 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:07:19.171] E005 |   600/731 batches | lr 20.0000 | loss  4.196 | ppl     66.44 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:07:29.847] E005 |   731/731 batches | lr 20.0000 | loss  4.184 | ppl     65.66 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:07:36.279] End E005 | valid loss  4.761; ppl    116.91 | accu 0.2077 = 23962/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:07:42.665] End E005 |  test loss  8.635; ppl   5625.32 | accu 0.0545 = 6119/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:08:11.854] End E005 |  test loss  8.998; ppl   8089.13 | accu 0.0537 = 27230/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:08:11.854] Save: model.pt... 
[2022-04-13 17:08:12.339] Save: model.pt...Done. best_val_loss: 4.7614
[2022-04-13 17:08:12.339] Epoch 006/20 ==================================================
[2022-04-13 17:08:27.560] E006 |   200/731 batches | lr 20.0000 | loss  4.176 | ppl     65.13 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:08:42.852] E006 |   400/731 batches | lr 20.0000 | loss  4.190 | ppl     66.04 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:08:57.959] E006 |   600/731 batches | lr 20.0000 | loss  4.101 | ppl     60.40 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:09:07.894] E006 |   731/731 batches | lr 20.0000 | loss  4.086 | ppl     59.48 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:09:13.297] End E006 | valid loss  4.745; ppl    115.04 | accu 0.2125 = 24523/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:09:19.641] End E006 |  test loss  8.631; ppl   5601.39 | accu 0.0572 = 6414/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:09:49.033] End E006 |  test loss  8.996; ppl   8070.74 | accu 0.0565 = 28652/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:09:49.034] Save: model.pt... 
[2022-04-13 17:09:49.538] Save: model.pt...Done. best_val_loss: 4.7453
[2022-04-13 17:09:49.538] Epoch 007/20 ==================================================
[2022-04-13 17:10:05.546] E007 |   200/731 batches | lr 20.0000 | loss  4.088 | ppl     59.64 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:10:21.538] E007 |   400/731 batches | lr 20.0000 | loss  4.101 | ppl     60.38 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:10:37.045] E007 |   600/731 batches | lr 20.0000 | loss  4.017 | ppl     55.54 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:10:47.030] E007 |   731/731 batches | lr 20.0000 | loss  4.000 | ppl     54.59 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:10:52.343] End E007 | valid loss  4.708; ppl    110.83 | accu 0.2142 = 24720/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:10:57.622] End E007 |  test loss  8.851; ppl   6979.39 | accu 0.0545 = 6111/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:11:21.704] End E007 |  test loss  9.242; ppl  10323.99 | accu 0.0535 = 27091/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:11:21.704] Save: model.pt... 
[2022-04-13 17:11:22.207] Save: model.pt...Done. best_val_loss: 4.7080
[2022-04-13 17:11:22.207] Epoch 008/20 ==================================================
[2022-04-13 17:11:39.111] E008 |   200/731 batches | lr 20.0000 | loss  4.006 | ppl     54.94 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:11:55.029] E008 |   400/731 batches | lr 20.0000 | loss  4.027 | ppl     56.07 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:12:10.219] E008 |   600/731 batches | lr 20.0000 | loss  3.943 | ppl     51.56 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:12:20.174] E008 |   731/731 batches | lr 20.0000 | loss  3.934 | ppl     51.13 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:12:25.481] End E008 | valid loss  4.688; ppl    108.67 | accu 0.2194 = 25319/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:12:30.730] End E008 |  test loss  9.044; ppl   8467.94 | accu 0.0493 = 5535/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:12:54.793] End E008 |  test loss  9.561; ppl  14202.81 | accu 0.0497 = 25202/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:12:54.793] Save: model.pt... 
[2022-04-13 17:12:55.288] Save: model.pt...Done. best_val_loss: 4.6883
[2022-04-13 17:12:55.288] Epoch 009/20 ==================================================
[2022-04-13 17:13:11.084] E009 |   200/731 batches | lr 20.0000 | loss  3.943 | ppl     51.58 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:13:26.396] E009 |   400/731 batches | lr 20.0000 | loss  3.958 | ppl     52.33 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:13:41.637] E009 |   600/731 batches | lr 20.0000 | loss  3.888 | ppl     48.82 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:13:51.402] E009 |   731/731 batches | lr 20.0000 | loss  3.868 | ppl     47.85 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:13:56.751] End E009 | valid loss  4.700; ppl    109.90 | accu 0.2165 = 24984/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:14:02.059] End E009 |  test loss  9.026; ppl   8320.44 | accu 0.0571 = 6406/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:14:26.198] End E009 |  test loss  9.565; ppl  14256.14 | accu 0.0535 = 27115/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:14:26.198] Epoch 010/20 ==================================================
[2022-04-13 17:14:41.431] E010 |   200/731 batches | lr 10.0000 | loss  3.819 | ppl     45.56 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:14:56.680] E010 |   400/731 batches | lr 10.0000 | loss  3.793 | ppl     44.38 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:15:11.951] E010 |   600/731 batches | lr 10.0000 | loss  3.687 | ppl     39.94 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:15:22.446] E010 |   731/731 batches | lr 10.0000 | loss  3.643 | ppl     38.20 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:15:27.737] End E010 | valid loss  4.616; ppl    101.05 | accu 0.2377 = 27428/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:15:33.017] End E010 |  test loss  9.196; ppl   9854.03 | accu 0.0605 = 6784/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:15:57.043] End E010 |  test loss  9.898; ppl  19890.74 | accu 0.0590 = 29901/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:15:57.043] Save: model.pt... 
[2022-04-13 17:15:57.530] Save: model.pt...Done. best_val_loss: 4.6156
[2022-04-13 17:15:57.530] Epoch 011/20 ==================================================
[2022-04-13 17:16:13.767] E011 |   200/731 batches | lr 10.0000 | loss  3.719 | ppl     41.24 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:16:29.028] E011 |   400/731 batches | lr 10.0000 | loss  3.728 | ppl     41.60 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:16:44.263] E011 |   600/731 batches | lr 10.0000 | loss  3.640 | ppl     38.08 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:16:54.248] E011 |   731/731 batches | lr 10.0000 | loss  3.605 | ppl     36.80 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:16:59.582] End E011 | valid loss  4.619; ppl    101.37 | accu 0.2381 = 27477/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:17:04.873] End E011 |  test loss  9.346; ppl  11450.21 | accu 0.0580 = 6509/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:17:29.016] End E011 |  test loss 10.058; ppl  23331.68 | accu 0.0570 = 28894/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:17:29.016] Epoch 012/20 ==================================================
[2022-04-13 17:17:44.615] E012 |   200/731 batches | lr 5.0000 | loss  3.655 | ppl     38.65 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:18:00.801] E012 |   400/731 batches | lr 5.0000 | loss  3.643 | ppl     38.20 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:18:16.631] E012 |   600/731 batches | lr 5.0000 | loss  3.534 | ppl     34.25 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:18:27.455] E012 |   731/731 batches | lr 5.0000 | loss  3.480 | ppl     32.46 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:18:33.937] End E012 | valid loss  4.603; ppl     99.74 | accu 0.2420 = 27921/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:18:40.397] End E012 |  test loss  9.409; ppl  12196.41 | accu 0.0603 = 6770/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:19:09.489] End E012 |  test loss 10.095; ppl  24220.08 | accu 0.0595 = 30156/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:19:09.489] Save: model.pt... 
[2022-04-13 17:19:09.986] Save: model.pt...Done. best_val_loss: 4.6026
[2022-04-13 17:19:09.986] Epoch 013/20 ==================================================
[2022-04-13 17:19:26.711] E013 |   200/731 batches | lr 5.0000 | loss  3.591 | ppl     36.28 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:19:43.846] E013 |   400/731 batches | lr 5.0000 | loss  3.596 | ppl     36.44 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:20:00.348] E013 |   600/731 batches | lr 5.0000 | loss  3.503 | ppl     33.22 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:20:10.390] E013 |   731/731 batches | lr 5.0000 | loss  3.465 | ppl     31.98 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:20:15.744] End E013 | valid loss  4.604; ppl     99.88 | accu 0.2429 = 28031/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:20:21.042] End E013 |  test loss  9.454; ppl  12764.20 | accu 0.0609 = 6835/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:20:45.132] End E013 |  test loss 10.187; ppl  26548.08 | accu 0.0586 = 29691/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:20:45.132] Epoch 014/20 ==================================================
[2022-04-13 17:21:01.442] E014 |   200/731 batches | lr 2.5000 | loss  3.564 | ppl     35.31 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:21:16.850] E014 |   400/731 batches | lr 2.5000 | loss  3.556 | ppl     35.01 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:21:32.100] E014 |   600/731 batches | lr 2.5000 | loss  3.447 | ppl     31.42 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:21:42.108] E014 |   731/731 batches | lr 2.5000 | loss  3.396 | ppl     29.86 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:21:47.426] End E014 | valid loss  4.600; ppl     99.50 | accu 0.2457 = 28350/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:21:52.715] End E014 |  test loss  9.456; ppl  12778.37 | accu 0.0628 = 7047/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:22:19.480] End E014 |  test loss 10.091; ppl  24118.43 | accu 0.0611 = 30958/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:22:19.480] Save: model.pt... 
[2022-04-13 17:22:19.969] Save: model.pt...Done. best_val_loss: 4.6001
[2022-04-13 17:22:19.969] Epoch 015/20 ==================================================
[2022-04-13 17:22:35.628] E015 |   200/731 batches | lr 2.5000 | loss  3.529 | ppl     34.08 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:22:50.885] E015 |   400/731 batches | lr 2.5000 | loss  3.533 | ppl     34.21 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:23:06.155] E015 |   600/731 batches | lr 2.5000 | loss  3.426 | ppl     30.74 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:23:16.160] E015 |   731/731 batches | lr 2.5000 | loss  3.387 | ppl     29.57 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:23:21.466] End E015 | valid loss  4.603; ppl     99.79 | accu 0.2450 = 28264/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:23:26.747] End E015 |  test loss  9.542; ppl  13934.02 | accu 0.0631 = 7084/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:23:50.670] End E015 |  test loss 10.176; ppl  26254.83 | accu 0.0616 = 31215/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:23:50.670] Epoch 016/20 ==================================================
[2022-04-13 17:24:05.761] E016 |   200/731 batches | lr 1.2500 | loss  3.514 | ppl     33.60 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:24:20.970] E016 |   400/731 batches | lr 1.2500 | loss  3.512 | ppl     33.52 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:24:37.107] E016 |   600/731 batches | lr 1.2500 | loss  3.400 | ppl     29.97 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:24:47.223] E016 |   731/731 batches | lr 1.2500 | loss  3.348 | ppl     28.45 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:24:52.522] End E016 | valid loss  4.599; ppl     99.40 | accu 0.2464 = 28435/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:24:57.768] End E016 |  test loss  9.540; ppl  13907.81 | accu 0.0644 = 7225/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:25:21.672] End E016 |  test loss 10.102; ppl  24403.05 | accu 0.0630 = 31912/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:25:21.672] Save: model.pt... 
[2022-04-13 17:25:22.149] Save: model.pt...Done. best_val_loss: 4.5991
[2022-04-13 17:25:22.149] Epoch 017/20 ==================================================
[2022-04-13 17:25:37.277] E017 |   200/731 batches | lr 1.2500 | loss  3.496 | ppl     32.98 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:25:52.558] E017 |   400/731 batches | lr 1.2500 | loss  3.495 | ppl     32.94 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:26:07.398] E017 |   600/731 batches | lr 1.2500 | loss  3.390 | ppl     29.67 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:26:17.058] E017 |   731/731 batches | lr 1.2500 | loss  3.352 | ppl     28.56 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:26:22.393] End E017 | valid loss  4.600; ppl     99.47 | accu 0.2467 = 28462/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:26:27.671] End E017 |  test loss  9.572; ppl  14355.51 | accu 0.0642 = 7204/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:26:51.690] End E017 |  test loss 10.227; ppl  27652.68 | accu 0.0622 = 31544/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:26:51.690] Epoch 018/20 ==================================================
[2022-04-13 17:27:06.312] E018 |   200/731 batches | lr 0.6250 | loss  3.487 | ppl     32.69 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:27:21.023] E018 |   400/731 batches | lr 0.6250 | loss  3.486 | ppl     32.66 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:27:36.278] E018 |   600/731 batches | lr 0.6250 | loss  3.379 | ppl     29.33 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:27:46.300] E018 |   731/731 batches | lr 0.6250 | loss  3.325 | ppl     27.79 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:27:51.573] End E018 | valid loss  4.597; ppl     99.18 | accu 0.2472 = 28525/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:27:56.844] End E018 |  test loss  9.568; ppl  14298.20 | accu 0.0645 = 7237/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:28:20.774] End E018 |  test loss 10.154; ppl  25704.05 | accu 0.0629 = 31855/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:28:20.775] Save: model.pt... 
[2022-04-13 17:28:21.299] Save: model.pt...Done. best_val_loss: 4.5969
[2022-04-13 17:28:21.299] Epoch 019/20 ==================================================
[2022-04-13 17:28:37.834] E019 |   200/731 batches | lr 0.6250 | loss  3.476 | ppl     32.32 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:28:53.744] E019 |   400/731 batches | lr 0.6250 | loss  3.479 | ppl     32.43 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:29:09.005] E019 |   600/731 batches | lr 0.6250 | loss  3.370 | ppl     29.09 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:29:20.073] E019 |   731/731 batches | lr 0.6250 | loss  3.326 | ppl     27.84 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:29:26.575] End E019 | valid loss  4.598; ppl     99.26 | accu 0.2476 = 28568/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:29:32.939] End E019 |  test loss  9.570; ppl  14326.02 | accu 0.0646 = 7247/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:30:01.924] End E019 |  test loss 10.192; ppl  26696.64 | accu 0.0629 = 31878/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:30:01.924] Epoch 020/20 ==================================================
[2022-04-13 17:30:18.583] E020 |   200/731 batches | lr 0.3125 | loss  3.478 | ppl     32.39 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:30:34.610] E020 |   400/731 batches | lr 0.3125 | loss  3.474 | ppl     32.27 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:30:49.850] E020 |   600/731 batches | lr 0.3125 | loss  3.363 | ppl     28.88 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:31:00.652] E020 |   731/731 batches | lr 0.3125 | loss  3.322 | ppl     27.71 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:31:07.189] End E020 | valid loss  4.595; ppl     98.96 | accu 0.2481 = 28622/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:31:13.556] End E020 |  test loss  9.566; ppl  14271.19 | accu 0.0649 = 7286/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:31:40.257] End E020 |  test loss 10.210; ppl  27161.06 | accu 0.0634 = 32143/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:31:40.257] Save: model.pt... 
[2022-04-13 17:31:40.740] Save: model.pt...Done. best_val_loss: 4.5947
[2022-04-13 17:31:46.277] End. test loss  9.57; ppl 14271.19 | accu 0.0649 = 7286/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:32:10.212] End. test loss 10.21; ppl 27161.06 | accu 0.0634 = 32143/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:32:10.212] =========================================================================================
[2022-04-13 17:32:10.213] valid_loss
[2022-04-13 17:32:10.213]  5.30, 4.91, 4.82, 4.80, 4.76, 4.75, 4.71, 4.69, 4.70, 4.62, 4.62, 4.60, 4.60, 4.60, 4.60, 4.60, 4.60, 4.60, 4.60, 4.59
[2022-04-13 17:32:10.213] valid_loss ppl
[2022-04-13 17:32:10.213]   201.31,  135.56,  124.58,  122.11,  116.91,  115.04,  110.83,  108.67,  109.90,  101.05,  101.37,   99.74,   99.88,   99.50,   99.79,   99.40,   99.47,   99.18,   99.26,   98.96
[2022-04-13 17:32:10.213] test_loss of ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:32:10.213]  8.86, 8.66, 8.59, 8.61, 8.64, 8.63, 8.85, 9.04, 9.03, 9.20, 9.35, 9.41, 9.45, 9.46, 9.54, 9.54, 9.57, 9.57, 9.57, 9.57
[2022-04-13 17:32:10.213] test_loss of ../data/sample_500k/adolescent_valid.txt ppl
[2022-04-13 17:32:10.213]  7069.30, 5749.82, 5400.54, 5476.18, 5625.32, 5601.39, 6979.39, 8467.94, 8320.44, 9854.03,11450.21,12196.41,12764.20,12778.37,13934.02,13907.81,14355.51,14298.20,14326.02,14271.19
[2022-04-13 17:32:10.213] test_loss of ../data/sample_500k/adult_test.txt
[2022-04-13 17:32:10.213]  9.16, 8.92, 8.95, 8.93, 9.00, 9.00, 9.24, 9.56, 9.56, 9.90,10.06,10.09,10.19,10.09,10.18,10.10,10.23,10.15,10.19,10.21
[2022-04-13 17:32:10.213] test_loss of ../data/sample_500k/adult_test.txt ppl
[2022-04-13 17:32:10.213]  9474.36, 7507.99, 7711.82, 7587.00, 8089.13, 8070.74,10323.99,14202.81,14256.14,19890.74,23331.68,24220.08,26548.08,24118.43,26254.83,24403.05,27652.68,25704.05,26696.64,27161.06
[2022-04-13 17:32:10.213] 
[2022-04-13 17:32:10.213] 
[2022-04-13 17:32:10.213] 
Log file: ./output_wsm_Subword.1000_fam_CNN.log closed.
Log file: ./output_wsm_Subword.1000_fam_LSTM.log open...
[2022-04-13 17:32:10.222] corpus.train_file_list: 1
[2022-04-13 17:32:10.222]         ../data/sample_500k/cbt_train.txt
[2022-04-13 17:32:10.222] corpus.valid_file_list: 1
[2022-04-13 17:32:10.222]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 17:32:10.222] corpus.test_file_list: 2
[2022-04-13 17:32:10.222]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:32:10.222]         ../data/sample_500k/adult_test.txt
[2022-04-13 17:32:10.222] corpus.subword_vocab_size: 0
[2022-04-13 17:32:10.222] corpus.subword_model = None. Corpus will not use subword.
[2022-04-13 17:32:10.222] corpus tokenize...
[2022-04-13 17:32:10.881]         train tokens: 511735  ../data/sample_500k/cbt_train.txt
[2022-04-13 17:32:11.018]         valid tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-13 17:32:11.250]         test  tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:32:11.863]         test  tokens: 506878  ../data/sample_500k/adult_test.txt
[2022-04-13 17:32:11.863] corpus.ntokens      : 73236
[2022-04-13 17:32:11.863] corpus.char_count   : 157
[2022-04-13 17:32:11.863] corpus.char_cnt_dict: 157
[2022-04-13 17:32:11.863] corpus.char_id_dict : 157
[2022-04-13 17:32:11.867] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 17:32:11.867]         tokens_all: 511735
[2022-04-13 17:32:11.867]         batched   :  25586
[2022-04-13 17:32:11.867]         ../data/sample_500k/cbt_train.txt
[2022-04-13 17:32:11.869] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 17:32:11.869]         tokens_all: 115417
[2022-04-13 17:32:11.869]         batched   :   5770
[2022-04-13 17:32:11.870]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 17:32:11.871] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 17:32:11.871]         tokens_all: 112256
[2022-04-13 17:32:11.871]         batched   :   5612
[2022-04-13 17:32:11.871]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:32:11.875] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 17:32:11.875]         tokens_all: 506878
[2022-04-13 17:32:11.875]         batched   :  25343
[2022-04-13 17:32:11.875]         ../data/sample_500k/adult_test.txt
[2022-04-13 17:32:11.876] subword_adapter will be generated due to word_split_mode='Subword.1000'
[2022-04-13 17:32:11.876] SubwordAdapter.file_list: 2
[2022-04-13 17:32:11.876]         ../data/sample_500k/cbt_train.txt
[2022-04-13 17:32:11.876]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 17:32:11.876] SubwordAdapter.subword_vocab_size: 1000
[2022-04-13 17:32:11.876] SubwordAdapter.subword_model.train(2 files)...
[2022-04-13 17:32:12.225] SubwordAdapter.subword_model.train(2 files)...Done
[2022-04-13 17:32:12.761] RNNModel.rnn_type: LSTM
[2022-04-13 17:32:12.761] RNNModel.ntoken  : 73236
[2022-04-13 17:32:12.761] RNNModel.ninp    : 200
[2022-04-13 17:32:12.762] RNNModel.nhid    : 200
[2022-04-13 17:32:12.762] RNNModel.nlayers : 2
[2022-04-13 17:32:12.762] RNNModel.dropout : 0.2
[2022-04-13 17:32:12.762] RNNModel.tie_weights: False
[2022-04-13 17:32:12.762] RNNModel.fragment_aggregate_mode: LSTM
[2022-04-13 17:32:12.762] RNNModel.fragment_cnt           : 1002
[2022-04-13 17:32:12.762] RNNModel.fragment_emsize        : 25
[2022-04-13 17:32:12.762] RNNModel.fragment_nhid          : 200
[2022-04-13 17:32:12.763] RNNModel.fragment_embeds     : created
[2022-04-13 17:32:12.766] RNNModel.fragment_lstm       : created
[2022-04-13 17:32:12.766] RNNModel.fragment_lstm_linear: created
[2022-04-13 17:32:12.795] Epoch 001/20 ==================================================
[2022-04-13 17:33:13.472] E001 |   200/731 batches | lr 20.0000 | loss  7.372 | ppl   1590.29 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:34:13.509] E001 |   400/731 batches | lr 20.0000 | loss  6.045 | ppl    421.81 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:35:16.087] E001 |   600/731 batches | lr 20.0000 | loss  5.378 | ppl    216.56 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:35:58.155] E001 |   731/731 batches | lr 20.0000 | loss  5.203 | ppl    181.76 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:36:13.068] End E001 | valid loss  5.425; ppl    227.10 | accu 0.1501 = 17317/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:36:27.258] End E001 |  test loss  8.760; ppl   6374.20 | accu 0.0332 = 3730/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:37:36.992] End E001 |  test loss  8.901; ppl   7340.78 | accu 0.0290 = 14683/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:37:36.993] Save: model.pt... 
[2022-04-13 17:37:37.455] Save: model.pt...Done. best_val_loss: 5.4254
[2022-04-13 17:37:37.455] Epoch 002/20 ==================================================
[2022-04-13 17:38:38.771] E002 |   200/731 batches | lr 20.0000 | loss  5.061 | ppl    157.82 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:39:38.862] E002 |   400/731 batches | lr 20.0000 | loss  4.966 | ppl    143.44 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:40:39.239] E002 |   600/731 batches | lr 20.0000 | loss  4.773 | ppl    118.32 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:41:20.773] E002 |   731/731 batches | lr 20.0000 | loss  4.726 | ppl    112.86 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:41:35.550] End E002 | valid loss  5.064; ppl    158.24 | accu 0.1816 = 20956/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:41:49.654] End E002 |  test loss  8.541; ppl   5118.78 | accu 0.0538 = 6032/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:42:53.658] End E002 |  test loss  8.755; ppl   6342.91 | accu 0.0539 = 27343/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:42:53.658] Save: model.pt... 
[2022-04-13 17:42:54.123] Save: model.pt...Done. best_val_loss: 5.0641
[2022-04-13 17:42:54.123] Epoch 003/20 ==================================================
[2022-04-13 17:43:55.493] E003 |   200/731 batches | lr 20.0000 | loss  4.673 | ppl    106.99 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:44:59.208] E003 |   400/731 batches | lr 20.0000 | loss  4.645 | ppl    104.04 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:46:07.187] E003 |   600/731 batches | lr 20.0000 | loss  4.503 | ppl     90.32 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:46:47.188] E003 |   731/731 batches | lr 20.0000 | loss  4.478 | ppl     88.10 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:47:02.066] End E003 | valid loss  4.919; ppl    136.88 | accu 0.1932 = 22287/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:47:16.385] End E003 |  test loss  8.529; ppl   5060.22 | accu 0.0542 = 6077/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:48:22.829] End E003 |  test loss  8.905; ppl   7367.84 | accu 0.0463 = 23453/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:48:22.830] Save: model.pt... 
[2022-04-13 17:48:23.292] Save: model.pt...Done. best_val_loss: 4.9191
[2022-04-13 17:48:23.293] Epoch 004/20 ==================================================
[2022-04-13 17:49:27.356] E004 |   200/731 batches | lr 20.0000 | loss  4.454 | ppl     85.93 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:50:30.236] E004 |   400/731 batches | lr 20.0000 | loss  4.454 | ppl     85.94 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:51:35.370] E004 |   600/731 batches | lr 20.0000 | loss  4.330 | ppl     75.92 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:52:16.937] E004 |   731/731 batches | lr 20.0000 | loss  4.319 | ppl     75.11 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:52:31.631] End E004 | valid loss  4.818; ppl    123.69 | accu 0.2007 = 23151/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:52:45.881] End E004 |  test loss  8.416; ppl   4516.90 | accu 0.0592 = 6640/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:53:55.143] End E004 |  test loss  8.827; ppl   6813.39 | accu 0.0517 = 26215/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:53:55.143] Save: model.pt... 
[2022-04-13 17:53:55.607] Save: model.pt...Done. best_val_loss: 4.8177
[2022-04-13 17:53:55.607] Epoch 005/20 ==================================================
[2022-04-13 17:55:01.902] E005 |   200/731 batches | lr 20.0000 | loss  4.306 | ppl     74.13 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 17:56:07.680] E005 |   400/731 batches | lr 20.0000 | loss  4.307 | ppl     74.23 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 17:57:09.935] E005 |   600/731 batches | lr 20.0000 | loss  4.200 | ppl     66.68 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 17:57:49.504] E005 |   731/731 batches | lr 20.0000 | loss  4.187 | ppl     65.81 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 17:58:03.767] End E005 | valid loss  4.776; ppl    118.60 | accu 0.2080 = 24000/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 17:58:17.938] End E005 |  test loss  8.547; ppl   5149.66 | accu 0.0625 = 7009/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 17:59:26.392] End E005 |  test loss  8.900; ppl   7335.27 | accu 0.0569 = 28846/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 17:59:26.392] Save: model.pt... 
[2022-04-13 17:59:26.920] Save: model.pt...Done. best_val_loss: 4.7757
[2022-04-13 17:59:26.920] Epoch 006/20 ==================================================
[2022-04-13 18:00:31.670] E006 |   200/731 batches | lr 20.0000 | loss  4.179 | ppl     65.33 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 18:01:34.527] E006 |   400/731 batches | lr 20.0000 | loss  4.196 | ppl     66.39 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 18:02:38.460] E006 |   600/731 batches | lr 20.0000 | loss  4.092 | ppl     59.88 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 18:03:20.670] E006 |   731/731 batches | lr 20.0000 | loss  4.077 | ppl     58.97 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 18:03:35.106] End E006 | valid loss  4.726; ppl    112.82 | accu 0.2143 = 24726/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 18:03:49.419] End E006 |  test loss  8.640; ppl   5653.29 | accu 0.0607 = 6812/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:05:02.549] End E006 |  test loss  9.158; ppl   9487.73 | accu 0.0547 = 27747/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 18:05:02.549] Save: model.pt... 
[2022-04-13 18:05:03.095] Save: model.pt...Done. best_val_loss: 4.7258
[2022-04-13 18:05:03.095] Epoch 007/20 ==================================================
[2022-04-13 18:06:05.694] E007 |   200/731 batches | lr 20.0000 | loss  4.082 | ppl     59.26 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 18:07:13.194] E007 |   400/731 batches | lr 20.0000 | loss  4.097 | ppl     60.15 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 18:08:15.051] E007 |   600/731 batches | lr 20.0000 | loss  4.005 | ppl     54.86 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 18:08:56.401] E007 |   731/731 batches | lr 20.0000 | loss  3.988 | ppl     53.92 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 18:09:11.284] End E007 | valid loss  4.714; ppl    111.49 | accu 0.2171 = 25053/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 18:09:25.488] End E007 |  test loss  8.687; ppl   5923.48 | accu 0.0632 = 7093/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:10:29.544] End E007 |  test loss  9.199; ppl   9888.83 | accu 0.0562 = 28482/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 18:10:29.544] Save: model.pt... 
[2022-04-13 18:10:30.086] Save: model.pt...Done. best_val_loss: 4.7139
[2022-04-13 18:10:30.086] Epoch 008/20 ==================================================
[2022-04-13 18:11:35.535] E008 |   200/731 batches | lr 20.0000 | loss  3.991 | ppl     54.10 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 18:12:41.259] E008 |   400/731 batches | lr 20.0000 | loss  4.016 | ppl     55.47 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 18:13:44.916] E008 |   600/731 batches | lr 20.0000 | loss  3.928 | ppl     50.78 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 18:14:25.906] E008 |   731/731 batches | lr 20.0000 | loss  3.912 | ppl     49.99 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 18:14:40.253] End E008 | valid loss  4.691; ppl    109.01 | accu 0.2226 = 25679/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 18:14:54.513] End E008 |  test loss  8.669; ppl   5820.10 | accu 0.0635 = 7131/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:15:58.814] End E008 |  test loss  9.163; ppl   9535.09 | accu 0.0573 = 29056/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 18:15:58.814] Save: model.pt... 
[2022-04-13 18:15:59.322] Save: model.pt...Done. best_val_loss: 4.6914
[2022-04-13 18:15:59.322] Epoch 009/20 ==================================================
[2022-04-13 18:17:00.347] E009 |   200/731 batches | lr 20.0000 | loss  3.920 | ppl     50.38 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 18:18:02.363] E009 |   400/731 batches | lr 20.0000 | loss  3.938 | ppl     51.34 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 18:19:06.031] E009 |   600/731 batches | lr 20.0000 | loss  3.861 | ppl     47.52 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 18:19:47.074] E009 |   731/731 batches | lr 20.0000 | loss  3.837 | ppl     46.39 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 18:20:01.620] End E009 | valid loss  4.673; ppl    106.99 | accu 0.2229 = 25716/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 18:20:15.845] End E009 |  test loss  8.665; ppl   5798.23 | accu 0.0697 = 7826/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:21:22.872] End E009 |  test loss  9.187; ppl   9769.39 | accu 0.0603 = 30572/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 18:21:22.872] Save: model.pt... 
[2022-04-13 18:21:23.381] Save: model.pt...Done. best_val_loss: 4.6727
[2022-04-13 18:21:23.382] Epoch 010/20 ==================================================
[2022-04-13 18:22:29.919] E010 |   200/731 batches | lr 20.0000 | loss  3.853 | ppl     47.15 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 18:23:39.151] E010 |   400/731 batches | lr 20.0000 | loss  3.884 | ppl     48.61 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 18:24:40.612] E010 |   600/731 batches | lr 20.0000 | loss  3.794 | ppl     44.43 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 18:25:21.222] E010 |   731/731 batches | lr 20.0000 | loss  3.775 | ppl     43.58 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 18:25:35.459] End E010 | valid loss  4.681; ppl    107.89 | accu 0.2232 = 25752/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 18:25:50.124] End E010 |  test loss  8.868; ppl   7099.80 | accu 0.0656 = 7360/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:27:02.113] End E010 |  test loss  9.375; ppl  11793.96 | accu 0.0586 = 29693/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 18:27:02.113] Epoch 011/20 ==================================================
[2022-04-13 18:28:07.732] E011 |   200/731 batches | lr 10.0000 | loss  3.740 | ppl     42.08 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 18:29:07.157] E011 |   400/731 batches | lr 10.0000 | loss  3.727 | ppl     41.55 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 18:30:14.107] E011 |   600/731 batches | lr 10.0000 | loss  3.605 | ppl     36.79 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 18:30:55.230] E011 |   731/731 batches | lr 10.0000 | loss  3.561 | ppl     35.21 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 18:31:09.742] End E011 | valid loss  4.633; ppl    102.77 | accu 0.2398 = 27664/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 18:31:24.153] End E011 |  test loss  9.028; ppl   8331.97 | accu 0.0636 = 7141/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:32:34.350] End E011 |  test loss  9.696; ppl  16244.46 | accu 0.0584 = 29575/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 18:32:34.350] Save: model.pt... 
[2022-04-13 18:32:34.859] Save: model.pt...Done. best_val_loss: 4.6325
[2022-04-13 18:32:34.859] Epoch 012/20 ==================================================
[2022-04-13 18:33:38.367] E012 |   200/731 batches | lr 10.0000 | loss  3.640 | ppl     38.09 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 18:34:43.328] E012 |   400/731 batches | lr 10.0000 | loss  3.655 | ppl     38.69 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 18:35:48.052] E012 |   600/731 batches | lr 10.0000 | loss  3.555 | ppl     34.99 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 18:36:33.551] E012 |   731/731 batches | lr 10.0000 | loss  3.518 | ppl     33.73 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 18:36:47.799] End E012 | valid loss  4.635; ppl    102.99 | accu 0.2394 = 27624/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 18:37:02.114] End E012 |  test loss  9.103; ppl   8981.97 | accu 0.0636 = 7134/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:38:06.222] End E012 |  test loss  9.722; ppl  16679.01 | accu 0.0591 = 29973/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 18:38:06.222] Epoch 013/20 ==================================================
[2022-04-13 18:39:08.217] E013 |   200/731 batches | lr 5.0000 | loss  3.578 | ppl     35.82 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 18:40:16.772] E013 |   400/731 batches | lr 5.0000 | loss  3.576 | ppl     35.72 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 18:41:21.068] E013 |   600/731 batches | lr 5.0000 | loss  3.454 | ppl     31.62 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 18:42:04.844] E013 |   731/731 batches | lr 5.0000 | loss  3.400 | ppl     29.95 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 18:42:19.423] End E013 | valid loss  4.635; ppl    103.00 | accu 0.2432 = 28056/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 18:42:33.716] End E013 |  test loss  9.242; ppl  10323.91 | accu 0.0639 = 7174/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:43:37.927] End E013 |  test loss  9.959; ppl  21134.14 | accu 0.0597 = 30242/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 18:43:37.927] Epoch 014/20 ==================================================
[2022-04-13 18:44:41.818] E014 |   200/731 batches | lr 2.5000 | loss  3.527 | ppl     34.04 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 18:45:45.923] E014 |   400/731 batches | lr 2.5000 | loss  3.528 | ppl     34.04 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 18:46:51.854] E014 |   600/731 batches | lr 2.5000 | loss  3.395 | ppl     29.81 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 18:47:32.370] E014 |   731/731 batches | lr 2.5000 | loss  3.340 | ppl     28.23 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 18:47:48.341] End E014 | valid loss  4.622; ppl    101.71 | accu 0.2458 = 28365/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 18:48:02.460] End E014 |  test loss  9.253; ppl  10436.23 | accu 0.0657 = 7376/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:49:10.910] End E014 |  test loss  9.963; ppl  21231.33 | accu 0.0611 = 30988/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 18:49:10.911] Save: model.pt... 
[2022-04-13 18:49:11.413] Save: model.pt...Done. best_val_loss: 4.6221
[2022-04-13 18:49:11.414] Epoch 015/20 ==================================================
[2022-04-13 18:50:15.247] E015 |   200/731 batches | lr 2.5000 | loss  3.490 | ppl     32.78 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 18:51:20.242] E015 |   400/731 batches | lr 2.5000 | loss  3.500 | ppl     33.12 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 18:52:26.019] E015 |   600/731 batches | lr 2.5000 | loss  3.376 | ppl     29.25 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 18:53:07.825] E015 |   731/731 batches | lr 2.5000 | loss  3.330 | ppl     27.94 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 18:53:23.448] End E015 | valid loss  4.625; ppl    102.04 | accu 0.2451 = 28282/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 18:53:39.630] End E015 |  test loss  9.270; ppl  10618.77 | accu 0.0649 = 7280/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 18:54:43.231] End E015 |  test loss  9.997; ppl  21968.08 | accu 0.0600 = 30390/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 18:54:43.232] Epoch 016/20 ==================================================
[2022-04-13 18:55:44.920] E016 |   200/731 batches | lr 1.2500 | loss  3.477 | ppl     32.36 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 18:56:45.745] E016 |   400/731 batches | lr 1.2500 | loss  3.479 | ppl     32.42 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 18:57:46.078] E016 |   600/731 batches | lr 1.2500 | loss  3.350 | ppl     28.50 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 18:58:26.754] E016 |   731/731 batches | lr 1.2500 | loss  3.300 | ppl     27.12 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 18:58:41.175] End E016 | valid loss  4.625; ppl    101.95 | accu 0.2465 = 28443/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 18:58:55.230] End E016 |  test loss  9.309; ppl  11042.25 | accu 0.0667 = 7480/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:00:04.139] End E016 |  test loss 10.049; ppl  23129.25 | accu 0.0618 = 31333/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:00:04.139] Epoch 017/20 ==================================================
[2022-04-13 19:01:06.060] E017 |   200/731 batches | lr 0.6250 | loss  3.461 | ppl     31.85 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 19:02:16.276] E017 |   400/731 batches | lr 0.6250 | loss  3.467 | ppl     32.03 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 19:03:16.834] E017 |   600/731 batches | lr 0.6250 | loss  3.337 | ppl     28.14 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 19:03:59.256] E017 |   731/731 batches | lr 0.6250 | loss  3.277 | ppl     26.51 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 19:04:13.554] End E017 | valid loss  4.623; ppl    101.79 | accu 0.2470 = 28494/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 19:04:27.825] End E017 |  test loss  9.302; ppl  10965.07 | accu 0.0671 = 7529/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:05:35.437] End E017 |  test loss 10.071; ppl  23645.38 | accu 0.0621 = 31490/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:05:35.437] Epoch 018/20 ==================================================
[2022-04-13 19:06:37.074] E018 |   200/731 batches | lr 0.3125 | loss  3.450 | ppl     31.50 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 19:07:42.034] E018 |   400/731 batches | lr 0.3125 | loss  3.456 | ppl     31.68 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 19:08:45.242] E018 |   600/731 batches | lr 0.3125 | loss  3.327 | ppl     27.86 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 19:09:30.446] E018 |   731/731 batches | lr 0.3125 | loss  3.272 | ppl     26.35 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 19:09:46.678] End E018 | valid loss  4.616; ppl    101.08 | accu 0.2475 = 28556/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 19:10:04.201] End E018 |  test loss  9.310; ppl  11042.51 | accu 0.0671 = 7530/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:11:07.555] End E018 |  test loss 10.069; ppl  23602.05 | accu 0.0626 = 31706/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:11:07.556] Save: model.pt... 
[2022-04-13 19:11:08.056] Save: model.pt...Done. best_val_loss: 4.6159
[2022-04-13 19:11:08.056] Epoch 019/20 ==================================================
[2022-04-13 19:12:10.463] E019 |   200/731 batches | lr 0.3125 | loss  3.446 | ppl     31.36 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 19:13:15.725] E019 |   400/731 batches | lr 0.3125 | loss  3.452 | ppl     31.57 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 19:14:17.526] E019 |   600/731 batches | lr 0.3125 | loss  3.323 | ppl     27.74 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 19:14:58.172] E019 |   731/731 batches | lr 0.3125 | loss  3.271 | ppl     26.33 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 19:15:12.486] End E019 | valid loss  4.617; ppl    101.17 | accu 0.2470 = 28501/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 19:15:26.597] End E019 |  test loss  9.308; ppl  11023.80 | accu 0.0670 = 7520/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:16:33.401] End E019 |  test loss 10.058; ppl  23340.76 | accu 0.0627 = 31804/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:16:33.402] Epoch 020/20 ==================================================
[2022-04-13 19:17:33.409] E020 |   200/731 batches | lr 0.1562 | loss  3.442 | ppl     31.25 frag_cnt/word_cnt=1.517=212422/140000
[2022-04-13 19:18:35.194] E020 |   400/731 batches | lr 0.1562 | loss  3.448 | ppl     31.43 frag_cnt/word_cnt=1.515=212107/140000
[2022-04-13 19:19:47.013] E020 |   600/731 batches | lr 0.1562 | loss  3.322 | ppl     27.73 frag_cnt/word_cnt=1.514=211977/140000
[2022-04-13 19:20:33.075] E020 |   731/731 batches | lr 0.1562 | loss  3.270 | ppl     26.32 frag_cnt/word_cnt=1.516=139054/91700
[2022-04-13 19:20:47.530] End E020 | valid loss  4.613; ppl    100.77 | accu 0.2474 = 28544/115380 | w_len 1.4664 = 169194/115380
[2022-04-13 19:21:01.690] End E020 |  test loss  9.304; ppl  10987.11 | accu 0.0674 = 7562/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:22:05.633] End E020 |  test loss 10.041; ppl  22937.38 | accu 0.0632 = 32040/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:22:05.633] Save: model.pt... 
[2022-04-13 19:22:06.124] Save: model.pt...Done. best_val_loss: 4.6128
[2022-04-13 19:22:20.701] End. test loss  9.30; ppl 10987.11 | accu 0.0674 = 7562/112220 | w_len 2.0324 = 228077/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:23:26.840] End. test loss 10.04; ppl 22937.38 | accu 0.0632 = 32040/506840 | w_len 2.1714 = 1100537/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:23:26.840] =========================================================================================
[2022-04-13 19:23:26.840] valid_loss
[2022-04-13 19:23:26.840]  5.43, 5.06, 4.92, 4.82, 4.78, 4.73, 4.71, 4.69, 4.67, 4.68, 4.63, 4.63, 4.63, 4.62, 4.63, 4.62, 4.62, 4.62, 4.62, 4.61
[2022-04-13 19:23:26.840] valid_loss ppl
[2022-04-13 19:23:26.840]   227.10,  158.24,  136.88,  123.69,  118.60,  112.82,  111.49,  109.01,  106.99,  107.89,  102.77,  102.99,  103.00,  101.71,  102.04,  101.95,  101.79,  101.08,  101.17,  100.77
[2022-04-13 19:23:26.840] test_loss of ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:23:26.840]  8.76, 8.54, 8.53, 8.42, 8.55, 8.64, 8.69, 8.67, 8.67, 8.87, 9.03, 9.10, 9.24, 9.25, 9.27, 9.31, 9.30, 9.31, 9.31, 9.30
[2022-04-13 19:23:26.840] test_loss of ../data/sample_500k/adolescent_valid.txt ppl
[2022-04-13 19:23:26.840]  6374.20, 5118.78, 5060.22, 4516.90, 5149.66, 5653.29, 5923.48, 5820.10, 5798.23, 7099.80, 8331.97, 8981.97,10323.91,10436.23,10618.77,11042.25,10965.07,11042.51,11023.80,10987.11
[2022-04-13 19:23:26.841] test_loss of ../data/sample_500k/adult_test.txt
[2022-04-13 19:23:26.841]  8.90, 8.76, 8.90, 8.83, 8.90, 9.16, 9.20, 9.16, 9.19, 9.38, 9.70, 9.72, 9.96, 9.96,10.00,10.05,10.07,10.07,10.06,10.04
[2022-04-13 19:23:26.841] test_loss of ../data/sample_500k/adult_test.txt ppl
[2022-04-13 19:23:26.841]  7340.78, 6342.91, 7367.84, 6813.39, 7335.27, 9487.73, 9888.83, 9535.09, 9769.39,11793.96,16244.46,16679.01,21134.14,21231.33,21968.08,23129.25,23645.38,23602.05,23340.76,22937.38
[2022-04-13 19:23:26.841] 
[2022-04-13 19:23:26.841] 
[2022-04-13 19:23:26.841] 
Log file: ./output_wsm_Subword.1000_fam_LSTM.log closed.
Log file: ./output_wsm_Subword.2000_fam_CNN.log open...
[2022-04-13 19:23:26.851] corpus.train_file_list: 1
[2022-04-13 19:23:26.851]         ../data/sample_500k/cbt_train.txt
[2022-04-13 19:23:26.852] corpus.valid_file_list: 1
[2022-04-13 19:23:26.852]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:23:26.852] corpus.test_file_list: 2
[2022-04-13 19:23:26.852]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:23:26.852]         ../data/sample_500k/adult_test.txt
[2022-04-13 19:23:26.852] corpus.subword_vocab_size: 0
[2022-04-13 19:23:26.852] corpus.subword_model = None. Corpus will not use subword.
[2022-04-13 19:23:26.852] corpus tokenize...
[2022-04-13 19:23:27.595]         train tokens: 511735  ../data/sample_500k/cbt_train.txt
[2022-04-13 19:23:27.745]         valid tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:23:28.026]         test  tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:23:28.643]         test  tokens: 506878  ../data/sample_500k/adult_test.txt
[2022-04-13 19:23:28.644] corpus.ntokens      : 73236
[2022-04-13 19:23:28.644] corpus.char_count   : 157
[2022-04-13 19:23:28.644] corpus.char_cnt_dict: 157
[2022-04-13 19:23:28.644] corpus.char_id_dict : 157
[2022-04-13 19:23:28.651] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 19:23:28.652]         tokens_all: 511735
[2022-04-13 19:23:28.652]         batched   :  25586
[2022-04-13 19:23:28.652]         ../data/sample_500k/cbt_train.txt
[2022-04-13 19:23:28.656] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 19:23:28.656]         tokens_all: 115417
[2022-04-13 19:23:28.657]         batched   :   5770
[2022-04-13 19:23:28.657]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:23:28.661] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 19:23:28.661]         tokens_all: 112256
[2022-04-13 19:23:28.661]         batched   :   5612
[2022-04-13 19:23:28.661]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:23:28.668] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 19:23:28.668]         tokens_all: 506878
[2022-04-13 19:23:28.668]         batched   :  25343
[2022-04-13 19:23:28.668]         ../data/sample_500k/adult_test.txt
[2022-04-13 19:23:28.669] subword_adapter will be generated due to word_split_mode='Subword.2000'
[2022-04-13 19:23:28.669] SubwordAdapter.file_list: 2
[2022-04-13 19:23:28.669]         ../data/sample_500k/cbt_train.txt
[2022-04-13 19:23:28.670]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:23:28.670] SubwordAdapter.subword_vocab_size: 2000
[2022-04-13 19:23:28.670] SubwordAdapter.subword_model.train(2 files)...
[2022-04-13 19:23:29.160] SubwordAdapter.subword_model.train(2 files)...Done
[2022-04-13 19:23:29.727] RNNModel.rnn_type: LSTM
[2022-04-13 19:23:29.728] RNNModel.ntoken  : 73236
[2022-04-13 19:23:29.728] RNNModel.ninp    : 200
[2022-04-13 19:23:29.728] RNNModel.nhid    : 200
[2022-04-13 19:23:29.728] RNNModel.nlayers : 2
[2022-04-13 19:23:29.728] RNNModel.dropout : 0.2
[2022-04-13 19:23:29.728] RNNModel.tie_weights: False
[2022-04-13 19:23:29.728] RNNModel.fragment_aggregate_mode: CNN
[2022-04-13 19:23:29.728] RNNModel.fragment_cnt           : 2002
[2022-04-13 19:23:29.728] RNNModel.fragment_emsize        : 25
[2022-04-13 19:23:29.728] RNNModel.fragment_nhid          : 200
[2022-04-13 19:23:29.730] RNNModel.fragment_embeds     : created
[2022-04-13 19:23:29.730] RNNModel.fragment_cnn3       : created
[2022-04-13 19:23:29.764] Epoch 001/20 ==================================================
[2022-04-13 19:23:45.029] E001 |   200/731 batches | lr 20.0000 | loss  7.405 | ppl   1644.69 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:24:00.588] E001 |   400/731 batches | lr 20.0000 | loss  6.068 | ppl    432.00 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:24:16.430] E001 |   600/731 batches | lr 20.0000 | loss  5.387 | ppl    218.55 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:24:26.309] E001 |   731/731 batches | lr 20.0000 | loss  5.195 | ppl    180.38 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:24:31.538] End E001 | valid loss  5.300; ppl    200.29 | accu 0.1708 = 19711/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:24:36.746] End E001 |  test loss  8.862; ppl   7059.75 | accu 0.0337 = 3784/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:25:00.687] End E001 |  test loss  8.949; ppl   7701.41 | accu 0.0276 = 13980/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:25:00.687] Save: model.pt... 
[2022-04-13 19:25:01.180] Save: model.pt...Done. best_val_loss: 5.2998
[2022-04-13 19:25:01.180] Epoch 002/20 ==================================================
[2022-04-13 19:25:16.802] E002 |   200/731 batches | lr 20.0000 | loss  5.048 | ppl    155.73 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:25:32.073] E002 |   400/731 batches | lr 20.0000 | loss  4.950 | ppl    141.14 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:25:47.108] E002 |   600/731 batches | lr 20.0000 | loss  4.750 | ppl    115.53 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:25:57.736] E002 |   731/731 batches | lr 20.0000 | loss  4.695 | ppl    109.44 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:26:04.118] End E002 | valid loss  5.050; ppl    156.04 | accu 0.1785 = 20592/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:26:10.424] End E002 |  test loss  8.541; ppl   5119.94 | accu 0.0471 = 5286/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:26:39.136] End E002 |  test loss  8.854; ppl   7003.90 | accu 0.0321 = 16286/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:26:39.136] Save: model.pt... 
[2022-04-13 19:26:39.630] Save: model.pt...Done. best_val_loss: 5.0501
[2022-04-13 19:26:39.630] Epoch 003/20 ==================================================
[2022-04-13 19:26:54.701] E003 |   200/731 batches | lr 20.0000 | loss  4.650 | ppl    104.56 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:27:09.713] E003 |   400/731 batches | lr 20.0000 | loss  4.622 | ppl    101.74 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:27:24.808] E003 |   600/731 batches | lr 20.0000 | loss  4.489 | ppl     88.99 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:27:34.669] E003 |   731/731 batches | lr 20.0000 | loss  4.460 | ppl     86.51 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:27:39.913] End E003 | valid loss  4.853; ppl    128.13 | accu 0.2018 = 23284/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:27:45.119] End E003 |  test loss  8.566; ppl   5249.97 | accu 0.0621 = 6971/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:28:08.999] End E003 |  test loss  8.979; ppl   7932.04 | accu 0.0550 = 27888/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:28:08.999] Save: model.pt... 
[2022-04-13 19:28:09.485] Save: model.pt...Done. best_val_loss: 4.8530
[2022-04-13 19:28:09.485] Epoch 004/20 ==================================================
[2022-04-13 19:28:24.397] E004 |   200/731 batches | lr 20.0000 | loss  4.441 | ppl     84.86 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:28:40.003] E004 |   400/731 batches | lr 20.0000 | loss  4.442 | ppl     84.92 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:28:56.136] E004 |   600/731 batches | lr 20.0000 | loss  4.328 | ppl     75.81 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:29:06.057] E004 |   731/731 batches | lr 20.0000 | loss  4.309 | ppl     74.33 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:29:11.318] End E004 | valid loss  4.792; ppl    120.55 | accu 0.2054 = 23694/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:29:16.551] End E004 |  test loss  8.522; ppl   5022.03 | accu 0.0660 = 7402/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:29:40.388] End E004 |  test loss  9.018; ppl   8249.69 | accu 0.0521 = 26411/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:29:40.388] Save: model.pt... 
[2022-04-13 19:29:40.875] Save: model.pt...Done. best_val_loss: 4.7920
[2022-04-13 19:29:40.875] Epoch 005/20 ==================================================
[2022-04-13 19:29:55.942] E005 |   200/731 batches | lr 20.0000 | loss  4.302 | ppl     73.82 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:30:10.979] E005 |   400/731 batches | lr 20.0000 | loss  4.311 | ppl     74.49 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:30:26.084] E005 |   600/731 batches | lr 20.0000 | loss  4.209 | ppl     67.31 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:30:35.973] E005 |   731/731 batches | lr 20.0000 | loss  4.191 | ppl     66.08 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:30:41.251] End E005 | valid loss  4.755; ppl    116.14 | accu 0.2077 = 23967/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:30:46.571] End E005 |  test loss  8.602; ppl   5444.83 | accu 0.0646 = 7245/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:31:10.425] End E005 |  test loss  9.064; ppl   8641.82 | accu 0.0555 = 28107/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:31:10.425] Save: model.pt... 
[2022-04-13 19:31:10.915] Save: model.pt...Done. best_val_loss: 4.7548
[2022-04-13 19:31:10.915] Epoch 006/20 ==================================================
[2022-04-13 19:31:25.855] E006 |   200/731 batches | lr 20.0000 | loss  4.196 | ppl     66.41 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:31:41.509] E006 |   400/731 batches | lr 20.0000 | loss  4.210 | ppl     67.33 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:31:57.070] E006 |   600/731 batches | lr 20.0000 | loss  4.113 | ppl     61.13 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:32:06.955] E006 |   731/731 batches | lr 20.0000 | loss  4.099 | ppl     60.25 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:32:12.228] End E006 | valid loss  4.743; ppl    114.83 | accu 0.2102 = 24251/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:32:17.482] End E006 |  test loss  8.690; ppl   5945.35 | accu 0.0603 = 6768/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:32:41.306] End E006 |  test loss  9.225; ppl  10143.37 | accu 0.0491 = 24887/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:32:41.306] Save: model.pt... 
[2022-04-13 19:32:41.750] Save: model.pt...Done. best_val_loss: 4.7434
[2022-04-13 19:32:41.750] Epoch 007/20 ==================================================
[2022-04-13 19:32:57.167] E007 |   200/731 batches | lr 20.0000 | loss  4.105 | ppl     60.66 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:33:13.263] E007 |   400/731 batches | lr 20.0000 | loss  4.125 | ppl     61.86 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:33:29.547] E007 |   600/731 batches | lr 20.0000 | loss  4.032 | ppl     56.36 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:33:39.545] E007 |   731/731 batches | lr 20.0000 | loss  4.021 | ppl     55.74 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:33:44.785] End E007 | valid loss  4.720; ppl    112.19 | accu 0.2132 = 24598/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:33:50.012] End E007 |  test loss  8.788; ppl   6554.22 | accu 0.0630 = 7070/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:34:13.724] End E007 |  test loss  9.290; ppl  10827.77 | accu 0.0543 = 27526/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:34:13.724] Save: model.pt... 
[2022-04-13 19:34:14.160] Save: model.pt...Done. best_val_loss: 4.7202
[2022-04-13 19:34:14.160] Epoch 008/20 ==================================================
[2022-04-13 19:34:29.556] E008 |   200/731 batches | lr 20.0000 | loss  4.025 | ppl     55.97 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:34:44.831] E008 |   400/731 batches | lr 20.0000 | loss  4.052 | ppl     57.54 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:35:00.424] E008 |   600/731 batches | lr 20.0000 | loss  3.962 | ppl     52.54 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:35:10.446] E008 |   731/731 batches | lr 20.0000 | loss  3.953 | ppl     52.09 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:35:15.744] End E008 | valid loss  4.702; ppl    110.17 | accu 0.2149 = 24793/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:35:20.966] End E008 |  test loss  8.766; ppl   6415.00 | accu 0.0615 = 6905/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:35:44.704] End E008 |  test loss  9.418; ppl  12306.65 | accu 0.0495 = 25077/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:35:44.705] Save: model.pt... 
[2022-04-13 19:35:45.144] Save: model.pt...Done. best_val_loss: 4.7020
[2022-04-13 19:35:45.144] Epoch 009/20 ==================================================
[2022-04-13 19:36:00.918] E009 |   200/731 batches | lr 20.0000 | loss  3.959 | ppl     52.42 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:36:16.132] E009 |   400/731 batches | lr 20.0000 | loss  3.992 | ppl     54.14 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:36:31.567] E009 |   600/731 batches | lr 20.0000 | loss  3.895 | ppl     49.17 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:36:41.565] E009 |   731/731 batches | lr 20.0000 | loss  3.890 | ppl     48.90 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:36:46.894] End E009 | valid loss  4.668; ppl    106.46 | accu 0.2258 = 26054/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:36:52.132] End E009 |  test loss  8.933; ppl   7581.68 | accu 0.0635 = 7123/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:37:15.949] End E009 |  test loss  9.590; ppl  14615.75 | accu 0.0532 = 26972/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:37:15.949] Save: model.pt... 
[2022-04-13 19:37:16.388] Save: model.pt...Done. best_val_loss: 4.6678
[2022-04-13 19:37:16.388] Epoch 010/20 ==================================================
[2022-04-13 19:37:31.558] E010 |   200/731 batches | lr 20.0000 | loss  3.900 | ppl     49.40 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:37:47.626] E010 |   400/731 batches | lr 20.0000 | loss  3.933 | ppl     51.05 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:38:03.563] E010 |   600/731 batches | lr 20.0000 | loss  3.841 | ppl     46.56 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:38:13.541] E010 |   731/731 batches | lr 20.0000 | loss  3.836 | ppl     46.33 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:38:18.797] End E010 | valid loss  4.671; ppl    106.82 | accu 0.2228 = 25710/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:38:24.031] End E010 |  test loss  8.875; ppl   7148.96 | accu 0.0650 = 7296/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:38:47.833] End E010 |  test loss  9.534; ppl  13823.06 | accu 0.0522 = 26438/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:38:47.833] Epoch 011/20 ==================================================
[2022-04-13 19:39:02.760] E011 |   200/731 batches | lr 10.0000 | loss  3.783 | ppl     43.96 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:39:17.947] E011 |   400/731 batches | lr 10.0000 | loss  3.773 | ppl     43.50 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:39:33.926] E011 |   600/731 batches | lr 10.0000 | loss  3.651 | ppl     38.53 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:39:45.101] E011 |   731/731 batches | lr 10.0000 | loss  3.614 | ppl     37.10 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:39:51.494] End E011 | valid loss  4.616; ppl    101.07 | accu 0.2375 = 27401/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:39:57.810] End E011 |  test loss  9.066; ppl   8653.10 | accu 0.0674 = 7562/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:40:22.784] End E011 |  test loss  9.645; ppl  15444.94 | accu 0.0604 = 30635/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:40:22.784] Save: model.pt... 
[2022-04-13 19:40:23.251] Save: model.pt...Done. best_val_loss: 4.6158
[2022-04-13 19:40:23.251] Epoch 012/20 ==================================================
[2022-04-13 19:40:38.895] E012 |   200/731 batches | lr 10.0000 | loss  3.686 | ppl     39.90 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:40:54.155] E012 |   400/731 batches | lr 10.0000 | loss  3.701 | ppl     40.50 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:41:09.263] E012 |   600/731 batches | lr 10.0000 | loss  3.596 | ppl     36.44 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:41:20.063] E012 |   731/731 batches | lr 10.0000 | loss  3.575 | ppl     35.70 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:41:26.460] End E012 | valid loss  4.629; ppl    102.40 | accu 0.2380 = 27462/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:41:32.798] End E012 |  test loss  9.098; ppl   8941.05 | accu 0.0661 = 7420/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:42:01.757] End E012 |  test loss  9.688; ppl  16130.01 | accu 0.0595 = 30156/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:42:01.757] Epoch 013/20 ==================================================
[2022-04-13 19:42:16.977] E013 |   200/731 batches | lr 5.0000 | loss  3.620 | ppl     37.33 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:42:32.099] E013 |   400/731 batches | lr 5.0000 | loss  3.618 | ppl     37.26 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:42:47.389] E013 |   600/731 batches | lr 5.0000 | loss  3.494 | ppl     32.91 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:42:57.167] E013 |   731/731 batches | lr 5.0000 | loss  3.459 | ppl     31.78 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:43:02.437] End E013 | valid loss  4.596; ppl     99.13 | accu 0.2438 = 28134/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:43:07.686] End E013 |  test loss  9.283; ppl  10752.26 | accu 0.0655 = 7350/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:43:31.504] End E013 |  test loss  9.926; ppl  20452.16 | accu 0.0596 = 30210/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:43:31.505] Save: model.pt... 
[2022-04-13 19:43:31.945] Save: model.pt...Done. best_val_loss: 4.5964
[2022-04-13 19:43:31.945] Epoch 014/20 ==================================================
[2022-04-13 19:43:47.161] E014 |   200/731 batches | lr 5.0000 | loss  3.562 | ppl     35.24 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:44:02.363] E014 |   400/731 batches | lr 5.0000 | loss  3.573 | ppl     35.64 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:44:17.508] E014 |   600/731 batches | lr 5.0000 | loss  3.463 | ppl     31.91 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:44:27.503] E014 |   731/731 batches | lr 5.0000 | loss  3.434 | ppl     31.00 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:44:32.758] End E014 | valid loss  4.599; ppl     99.43 | accu 0.2443 = 28192/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:44:37.969] End E014 |  test loss  9.340; ppl  11381.30 | accu 0.0658 = 7384/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:45:01.655] End E014 |  test loss 10.024; ppl  22570.50 | accu 0.0590 = 29919/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:45:01.655] Epoch 015/20 ==================================================
[2022-04-13 19:45:18.066] E015 |   200/731 batches | lr 2.5000 | loss  3.532 | ppl     34.20 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:45:33.976] E015 |   400/731 batches | lr 2.5000 | loss  3.530 | ppl     34.12 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:45:49.157] E015 |   600/731 batches | lr 2.5000 | loss  3.407 | ppl     30.17 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:45:59.092] E015 |   731/731 batches | lr 2.5000 | loss  3.368 | ppl     29.03 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:46:04.404] End E015 | valid loss  4.597; ppl     99.21 | accu 0.2463 = 28423/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:46:09.627] End E015 |  test loss  9.411; ppl  12216.43 | accu 0.0667 = 7488/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:46:33.543] End E015 |  test loss 10.117; ppl  24772.04 | accu 0.0603 = 30550/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:46:33.543] Epoch 016/20 ==================================================
[2022-04-13 19:46:48.659] E016 |   200/731 batches | lr 1.2500 | loss  3.506 | ppl     33.30 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:47:03.899] E016 |   400/731 batches | lr 1.2500 | loss  3.507 | ppl     33.36 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:47:19.044] E016 |   600/731 batches | lr 1.2500 | loss  3.381 | ppl     29.40 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:47:29.052] E016 |   731/731 batches | lr 1.2500 | loss  3.336 | ppl     28.12 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:47:34.326] End E016 | valid loss  4.598; ppl     99.27 | accu 0.2467 = 28459/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:47:39.552] End E016 |  test loss  9.401; ppl  12098.88 | accu 0.0680 = 7629/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:48:03.313] End E016 |  test loss 10.085; ppl  23985.41 | accu 0.0622 = 31544/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:48:03.313] Epoch 017/20 ==================================================
[2022-04-13 19:48:18.402] E017 |   200/731 batches | lr 0.6250 | loss  3.490 | ppl     32.79 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:48:33.606] E017 |   400/731 batches | lr 0.6250 | loss  3.491 | ppl     32.82 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:48:48.504] E017 |   600/731 batches | lr 0.6250 | loss  3.366 | ppl     28.98 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:48:57.537] E017 |   731/731 batches | lr 0.6250 | loss  3.322 | ppl     27.73 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:49:02.756] End E017 | valid loss  4.594; ppl     98.85 | accu 0.2475 = 28555/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:49:07.989] End E017 |  test loss  9.426; ppl  12410.18 | accu 0.0677 = 7595/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:49:31.900] End E017 |  test loss 10.097; ppl  24278.22 | accu 0.0627 = 31803/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:49:31.900] Save: model.pt... 
[2022-04-13 19:49:32.336] Save: model.pt...Done. best_val_loss: 4.5936
[2022-04-13 19:49:32.336] Epoch 018/20 ==================================================
[2022-04-13 19:49:47.503] E018 |   200/731 batches | lr 0.6250 | loss  3.476 | ppl     32.32 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:50:02.747] E018 |   400/731 batches | lr 0.6250 | loss  3.480 | ppl     32.45 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:50:18.364] E018 |   600/731 batches | lr 0.6250 | loss  3.362 | ppl     28.84 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:50:28.232] E018 |   731/731 batches | lr 0.6250 | loss  3.314 | ppl     27.50 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:50:33.571] End E018 | valid loss  4.591; ppl     98.57 | accu 0.2483 = 28645/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:50:38.881] End E018 |  test loss  9.430; ppl  12462.37 | accu 0.0680 = 7632/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:51:04.680] End E018 |  test loss 10.092; ppl  24155.98 | accu 0.0631 = 31976/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:51:04.680] Save: model.pt... 
[2022-04-13 19:51:05.132] Save: model.pt...Done. best_val_loss: 4.5907
[2022-04-13 19:51:05.132] Epoch 019/20 ==================================================
[2022-04-13 19:51:20.209] E019 |   200/731 batches | lr 0.6250 | loss  3.473 | ppl     32.22 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:51:35.479] E019 |   400/731 batches | lr 0.6250 | loss  3.475 | ppl     32.31 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:51:50.719] E019 |   600/731 batches | lr 0.6250 | loss  3.355 | ppl     28.63 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:52:00.716] E019 |   731/731 batches | lr 0.6250 | loss  3.320 | ppl     27.66 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:52:06.030] End E019 | valid loss  4.592; ppl     98.70 | accu 0.2482 = 28642/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:52:11.293] End E019 |  test loss  9.461; ppl  12849.01 | accu 0.0675 = 7573/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:52:35.497] End E019 |  test loss 10.121; ppl  24850.81 | accu 0.0628 = 31849/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:52:35.497] Epoch 020/20 ==================================================
[2022-04-13 19:52:50.663] E020 |   200/731 batches | lr 0.3125 | loss  3.464 | ppl     31.95 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:53:05.888] E020 |   400/731 batches | lr 0.3125 | loss  3.472 | ppl     32.20 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:53:21.215] E020 |   600/731 batches | lr 0.3125 | loss  3.344 | ppl     28.32 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:53:31.270] E020 |   731/731 batches | lr 0.3125 | loss  3.305 | ppl     27.26 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:53:36.606] End E020 | valid loss  4.590; ppl     98.50 | accu 0.2481 = 28629/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:53:41.906] End E020 |  test loss  9.468; ppl  12939.99 | accu 0.0678 = 7605/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:54:06.147] End E020 |  test loss 10.117; ppl  24761.00 | accu 0.0635 = 32170/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:54:06.147] Save: model.pt... 
[2022-04-13 19:54:06.600] Save: model.pt...Done. best_val_loss: 4.5900
[2022-04-13 19:54:12.098] End. test loss  9.47; ppl 12939.99 | accu 0.0678 = 7605/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:54:36.366] End. test loss 10.12; ppl 24761.00 | accu 0.0635 = 32170/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 19:54:36.366] =========================================================================================
[2022-04-13 19:54:36.366] valid_loss
[2022-04-13 19:54:36.366]  5.30, 5.05, 4.85, 4.79, 4.75, 4.74, 4.72, 4.70, 4.67, 4.67, 4.62, 4.63, 4.60, 4.60, 4.60, 4.60, 4.59, 4.59, 4.59, 4.59
[2022-04-13 19:54:36.366] valid_loss ppl
[2022-04-13 19:54:36.366]   200.29,  156.04,  128.13,  120.55,  116.14,  114.83,  112.19,  110.17,  106.46,  106.82,  101.07,  102.40,   99.13,   99.43,   99.21,   99.27,   98.85,   98.57,   98.70,   98.50
[2022-04-13 19:54:36.366] test_loss of ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:54:36.366]  8.86, 8.54, 8.57, 8.52, 8.60, 8.69, 8.79, 8.77, 8.93, 8.87, 9.07, 9.10, 9.28, 9.34, 9.41, 9.40, 9.43, 9.43, 9.46, 9.47
[2022-04-13 19:54:36.366] test_loss of ../data/sample_500k/adolescent_valid.txt ppl
[2022-04-13 19:54:36.366]  7059.75, 5119.94, 5249.97, 5022.03, 5444.83, 5945.35, 6554.22, 6415.00, 7581.68, 7148.96, 8653.10, 8941.05,10752.26,11381.30,12216.43,12098.88,12410.18,12462.37,12849.01,12939.99
[2022-04-13 19:54:36.366] test_loss of ../data/sample_500k/adult_test.txt
[2022-04-13 19:54:36.366]  8.95, 8.85, 8.98, 9.02, 9.06, 9.22, 9.29, 9.42, 9.59, 9.53, 9.65, 9.69, 9.93,10.02,10.12,10.09,10.10,10.09,10.12,10.12
[2022-04-13 19:54:36.367] test_loss of ../data/sample_500k/adult_test.txt ppl
[2022-04-13 19:54:36.367]  7701.41, 7003.90, 7932.04, 8249.69, 8641.82,10143.37,10827.77,12306.65,14615.75,13823.06,15444.94,16130.01,20452.16,22570.50,24772.04,23985.41,24278.22,24155.98,24850.81,24761.00
[2022-04-13 19:54:36.367] 
[2022-04-13 19:54:36.367] 
[2022-04-13 19:54:36.367] 
Log file: ./output_wsm_Subword.2000_fam_CNN.log closed.
Log file: ./output_wsm_Subword.2000_fam_LSTM.log open...
[2022-04-13 19:54:36.375] corpus.train_file_list: 1
[2022-04-13 19:54:36.375]         ../data/sample_500k/cbt_train.txt
[2022-04-13 19:54:36.375] corpus.valid_file_list: 1
[2022-04-13 19:54:36.375]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:54:36.375] corpus.test_file_list: 2
[2022-04-13 19:54:36.375]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:54:36.375]         ../data/sample_500k/adult_test.txt
[2022-04-13 19:54:36.375] corpus.subword_vocab_size: 0
[2022-04-13 19:54:36.375] corpus.subword_model = None. Corpus will not use subword.
[2022-04-13 19:54:36.375] corpus tokenize...
[2022-04-13 19:54:37.056]         train tokens: 511735  ../data/sample_500k/cbt_train.txt
[2022-04-13 19:54:37.193]         valid tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:54:37.422]         test  tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:54:38.071]         test  tokens: 506878  ../data/sample_500k/adult_test.txt
[2022-04-13 19:54:38.071] corpus.ntokens      : 73236
[2022-04-13 19:54:38.071] corpus.char_count   : 157
[2022-04-13 19:54:38.071] corpus.char_cnt_dict: 157
[2022-04-13 19:54:38.071] corpus.char_id_dict : 157
[2022-04-13 19:54:38.081] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 19:54:38.081]         tokens_all: 511735
[2022-04-13 19:54:38.081]         batched   :  25586
[2022-04-13 19:54:38.081]         ../data/sample_500k/cbt_train.txt
[2022-04-13 19:54:38.084] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 19:54:38.085]         tokens_all: 115417
[2022-04-13 19:54:38.085]         batched   :   5770
[2022-04-13 19:54:38.085]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:54:38.086] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 19:54:38.086]         tokens_all: 112256
[2022-04-13 19:54:38.086]         batched   :   5612
[2022-04-13 19:54:38.086]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 19:54:38.090] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 19:54:38.090]         tokens_all: 506878
[2022-04-13 19:54:38.090]         batched   :  25343
[2022-04-13 19:54:38.090]         ../data/sample_500k/adult_test.txt
[2022-04-13 19:54:38.091] subword_adapter will be generated due to word_split_mode='Subword.2000'
[2022-04-13 19:54:38.091] SubwordAdapter.file_list: 2
[2022-04-13 19:54:38.091]         ../data/sample_500k/cbt_train.txt
[2022-04-13 19:54:38.091]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 19:54:38.091] SubwordAdapter.subword_vocab_size: 2000
[2022-04-13 19:54:38.091] SubwordAdapter.subword_model.train(2 files)...
[2022-04-13 19:54:38.537] SubwordAdapter.subword_model.train(2 files)...Done
[2022-04-13 19:54:39.090] RNNModel.rnn_type: LSTM
[2022-04-13 19:54:39.090] RNNModel.ntoken  : 73236
[2022-04-13 19:54:39.091] RNNModel.ninp    : 200
[2022-04-13 19:54:39.091] RNNModel.nhid    : 200
[2022-04-13 19:54:39.091] RNNModel.nlayers : 2
[2022-04-13 19:54:39.091] RNNModel.dropout : 0.2
[2022-04-13 19:54:39.091] RNNModel.tie_weights: False
[2022-04-13 19:54:39.091] RNNModel.fragment_aggregate_mode: LSTM
[2022-04-13 19:54:39.091] RNNModel.fragment_cnt           : 2002
[2022-04-13 19:54:39.091] RNNModel.fragment_emsize        : 25
[2022-04-13 19:54:39.091] RNNModel.fragment_nhid          : 200
[2022-04-13 19:54:39.092] RNNModel.fragment_embeds     : created
[2022-04-13 19:54:39.096] RNNModel.fragment_lstm       : created
[2022-04-13 19:54:39.096] RNNModel.fragment_lstm_linear: created
[2022-04-13 19:54:39.122] Epoch 001/20 ==================================================
[2022-04-13 19:55:45.367] E001 |   200/731 batches | lr 20.0000 | loss  7.333 | ppl   1530.27 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 19:56:51.464] E001 |   400/731 batches | lr 20.0000 | loss  5.994 | ppl    400.82 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 19:57:54.548] E001 |   600/731 batches | lr 20.0000 | loss  5.376 | ppl    216.08 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 19:58:35.754] E001 |   731/731 batches | lr 20.0000 | loss  5.193 | ppl    180.04 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 19:58:50.265] End E001 | valid loss  5.423; ppl    226.48 | accu 0.1538 = 17748/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 19:59:04.574] End E001 |  test loss  9.051; ppl   8530.70 | accu 0.0282 = 3168/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 20:00:09.762] End E001 |  test loss  9.077; ppl   8751.83 | accu 0.0219 = 11102/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 20:00:09.762] Save: model.pt... 
[2022-04-13 20:00:10.225] Save: model.pt...Done. best_val_loss: 5.4227
[2022-04-13 20:00:10.225] Epoch 002/20 ==================================================
[2022-04-13 20:01:15.219] E002 |   200/731 batches | lr 20.0000 | loss  5.058 | ppl    157.22 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 20:02:21.325] E002 |   400/731 batches | lr 20.0000 | loss  4.963 | ppl    143.00 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 20:03:24.395] E002 |   600/731 batches | lr 20.0000 | loss  4.767 | ppl    117.52 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 20:04:04.434] E002 |   731/731 batches | lr 20.0000 | loss  4.704 | ppl    110.39 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 20:04:18.794] End E002 | valid loss  5.061; ppl    157.67 | accu 0.1715 = 19793/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 20:04:33.063] End E002 |  test loss  8.803; ppl   6656.54 | accu 0.0327 = 3667/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 20:05:36.865] End E002 |  test loss  9.000; ppl   8107.01 | accu 0.0287 = 14537/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 20:05:36.866] Save: model.pt... 
[2022-04-13 20:05:37.318] Save: model.pt...Done. best_val_loss: 5.0605
[2022-04-13 20:05:37.318] Epoch 003/20 ==================================================
[2022-04-13 20:06:37.700] E003 |   200/731 batches | lr 20.0000 | loss  4.658 | ppl    105.44 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 20:07:43.480] E003 |   400/731 batches | lr 20.0000 | loss  4.631 | ppl    102.61 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 20:08:45.301] E003 |   600/731 batches | lr 20.0000 | loss  4.495 | ppl     89.56 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 20:09:27.980] E003 |   731/731 batches | lr 20.0000 | loss  4.459 | ppl     86.38 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 20:09:42.537] End E003 | valid loss  4.897; ppl    133.83 | accu 0.1964 = 22665/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 20:09:58.098] End E003 |  test loss  8.582; ppl   5332.75 | accu 0.0555 = 6223/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 20:11:04.706] End E003 |  test loss  8.806; ppl   6676.55 | accu 0.0543 = 27509/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 20:11:04.706] Save: model.pt... 
[2022-04-13 20:11:05.186] Save: model.pt...Done. best_val_loss: 4.8966
[2022-04-13 20:11:05.187] Epoch 004/20 ==================================================
[2022-04-13 20:12:08.342] E004 |   200/731 batches | lr 20.0000 | loss  4.438 | ppl     84.59 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 20:13:09.852] E004 |   400/731 batches | lr 20.0000 | loss  4.436 | ppl     84.47 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 20:14:13.696] E004 |   600/731 batches | lr 20.0000 | loss  4.321 | ppl     75.28 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 20:14:54.629] E004 |   731/731 batches | lr 20.0000 | loss  4.303 | ppl     73.93 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 20:15:09.255] End E004 | valid loss  4.801; ppl    121.68 | accu 0.2063 = 23807/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 20:15:23.372] End E004 |  test loss  8.555; ppl   5193.30 | accu 0.0572 = 6419/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 20:16:29.177] End E004 |  test loss  8.934; ppl   7584.21 | accu 0.0542 = 27452/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 20:16:29.177] Save: model.pt... 
[2022-04-13 20:16:29.648] Save: model.pt...Done. best_val_loss: 4.8014
[2022-04-13 20:16:29.648] Epoch 005/20 ==================================================
[2022-04-13 20:17:30.667] E005 |   200/731 batches | lr 20.0000 | loss  4.290 | ppl     72.94 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 20:18:35.438] E005 |   400/731 batches | lr 20.0000 | loss  4.295 | ppl     73.35 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 20:19:40.038] E005 |   600/731 batches | lr 20.0000 | loss  4.192 | ppl     66.12 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 20:20:25.167] E005 |   731/731 batches | lr 20.0000 | loss  4.175 | ppl     65.02 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 20:20:41.766] End E005 | valid loss  4.770; ppl    117.97 | accu 0.2083 = 24037/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 20:20:59.435] End E005 |  test loss  8.601; ppl   5436.19 | accu 0.0564 = 6326/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 20:22:05.117] End E005 |  test loss  9.075; ppl   8737.22 | accu 0.0526 = 26636/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 20:22:05.117] Save: model.pt... 
[2022-04-13 20:22:05.586] Save: model.pt...Done. best_val_loss: 4.7704
[2022-04-13 20:22:05.586] Epoch 006/20 ==================================================
[2022-04-13 20:23:10.896] E006 |   200/731 batches | lr 20.0000 | loss  4.167 | ppl     64.52 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 20:24:14.288] E006 |   400/731 batches | lr 20.0000 | loss  4.183 | ppl     65.53 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 20:25:20.767] E006 |   600/731 batches | lr 20.0000 | loss  4.089 | ppl     59.70 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 20:26:01.662] E006 |   731/731 batches | lr 20.0000 | loss  4.069 | ppl     58.51 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 20:26:15.837] End E006 | valid loss  4.729; ppl    113.24 | accu 0.2137 = 24661/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 20:26:29.832] End E006 |  test loss  8.562; ppl   5231.19 | accu 0.0575 = 6454/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 20:27:33.809] End E006 |  test loss  9.141; ppl   9332.15 | accu 0.0504 = 25522/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 20:27:33.810] Save: model.pt... 
[2022-04-13 20:27:34.272] Save: model.pt...Done. best_val_loss: 4.7295
[2022-04-13 20:27:34.272] Epoch 007/20 ==================================================
[2022-04-13 20:28:36.059] E007 |   200/731 batches | lr 20.0000 | loss  4.068 | ppl     58.46 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 20:29:38.152] E007 |   400/731 batches | lr 20.0000 | loss  4.087 | ppl     59.59 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 20:30:41.209] E007 |   600/731 batches | lr 20.0000 | loss  3.999 | ppl     54.56 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 20:31:25.636] E007 |   731/731 batches | lr 20.0000 | loss  3.980 | ppl     53.51 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 20:31:40.003] End E007 | valid loss  4.724; ppl    112.56 | accu 0.2171 = 25052/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 20:31:54.106] End E007 |  test loss  8.640; ppl   5652.42 | accu 0.0618 = 6935/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 20:32:58.009] End E007 |  test loss  9.079; ppl   8771.78 | accu 0.0578 = 29293/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 20:32:58.009] Save: model.pt... 
[2022-04-13 20:32:58.467] Save: model.pt...Done. best_val_loss: 4.7235
[2022-04-13 20:32:58.467] Epoch 008/20 ==================================================
[2022-04-13 20:34:01.616] E008 |   200/731 batches | lr 20.0000 | loss  3.978 | ppl     53.41 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 20:35:05.255] E008 |   400/731 batches | lr 20.0000 | loss  4.004 | ppl     54.82 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 20:36:12.314] E008 |   600/731 batches | lr 20.0000 | loss  3.918 | ppl     50.31 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 20:36:53.964] E008 |   731/731 batches | lr 20.0000 | loss  3.895 | ppl     49.16 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 20:37:08.755] End E008 | valid loss  4.695; ppl    109.44 | accu 0.2202 = 25409/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 20:37:23.128] End E008 |  test loss  8.737; ppl   6226.69 | accu 0.0588 = 6604/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 20:38:27.236] End E008 |  test loss  9.218; ppl  10081.25 | accu 0.0570 = 28903/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 20:38:27.236] Save: model.pt... 
[2022-04-13 20:38:27.716] Save: model.pt...Done. best_val_loss: 4.6954
[2022-04-13 20:38:27.716] Epoch 009/20 ==================================================
[2022-04-13 20:39:32.050] E009 |   200/731 batches | lr 20.0000 | loss  3.903 | ppl     49.56 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 20:40:39.765] E009 |   400/731 batches | lr 20.0000 | loss  3.930 | ppl     50.91 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 20:41:42.447] E009 |   600/731 batches | lr 20.0000 | loss  3.848 | ppl     46.92 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 20:42:23.915] E009 |   731/731 batches | lr 20.0000 | loss  3.828 | ppl     45.96 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 20:42:39.022] End E009 | valid loss  4.679; ppl    107.69 | accu 0.2245 = 25900/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 20:42:55.268] End E009 |  test loss  8.864; ppl   7070.40 | accu 0.0640 = 7181/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 20:43:58.871] End E009 |  test loss  9.396; ppl  12044.12 | accu 0.0579 = 29324/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 20:43:58.871] Save: model.pt... 
[2022-04-13 20:43:59.391] Save: model.pt...Done. best_val_loss: 4.6793
[2022-04-13 20:43:59.391] Epoch 010/20 ==================================================
[2022-04-13 20:45:04.347] E010 |   200/731 batches | lr 20.0000 | loss  3.835 | ppl     46.29 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 20:46:13.793] E010 |   400/731 batches | lr 20.0000 | loss  3.866 | ppl     47.76 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 20:47:20.640] E010 |   600/731 batches | lr 20.0000 | loss  3.785 | ppl     44.04 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 20:48:03.164] E010 |   731/731 batches | lr 20.0000 | loss  3.768 | ppl     43.27 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 20:48:18.008] End E010 | valid loss  4.728; ppl    113.05 | accu 0.2217 = 25574/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 20:48:33.218] End E010 |  test loss  8.857; ppl   7020.03 | accu 0.0624 = 6997/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 20:49:37.299] End E010 |  test loss  9.459; ppl  12827.95 | accu 0.0603 = 30569/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 20:49:37.299] Epoch 011/20 ==================================================
[2022-04-13 20:50:39.847] E011 |   200/731 batches | lr 10.0000 | loss  3.728 | ppl     41.59 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 20:51:41.625] E011 |   400/731 batches | lr 10.0000 | loss  3.705 | ppl     40.66 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 20:52:43.527] E011 |   600/731 batches | lr 10.0000 | loss  3.593 | ppl     36.33 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 20:53:22.970] E011 |   731/731 batches | lr 10.0000 | loss  3.553 | ppl     34.91 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 20:53:38.727] End E011 | valid loss  4.643; ppl    103.84 | accu 0.2386 = 27533/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 20:53:54.104] End E011 |  test loss  9.095; ppl   8914.38 | accu 0.0648 = 7270/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 20:54:58.797] End E011 |  test loss  9.627; ppl  15166.75 | accu 0.0620 = 31438/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 20:54:58.797] Save: model.pt... 
[2022-04-13 20:54:59.273] Save: model.pt...Done. best_val_loss: 4.6429
[2022-04-13 20:54:59.273] Epoch 012/20 ==================================================
[2022-04-13 20:56:03.494] E012 |   200/731 batches | lr 10.0000 | loss  3.629 | ppl     37.66 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 20:57:06.404] E012 |   400/731 batches | lr 10.0000 | loss  3.641 | ppl     38.14 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 20:58:10.332] E012 |   600/731 batches | lr 10.0000 | loss  3.545 | ppl     34.63 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 20:58:50.992] E012 |   731/731 batches | lr 10.0000 | loss  3.515 | ppl     33.61 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 20:59:05.277] End E012 | valid loss  4.638; ppl    103.36 | accu 0.2400 = 27696/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 20:59:19.316] End E012 |  test loss  9.139; ppl   9314.04 | accu 0.0655 = 7356/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:00:25.961] End E012 |  test loss  9.687; ppl  16108.59 | accu 0.0618 = 31307/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:00:25.961] Save: model.pt... 
[2022-04-13 21:00:26.448] Save: model.pt...Done. best_val_loss: 4.6383
[2022-04-13 21:00:26.449] Epoch 013/20 ==================================================
[2022-04-13 21:01:32.975] E013 |   200/731 batches | lr 10.0000 | loss  3.576 | ppl     35.72 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 21:02:35.394] E013 |   400/731 batches | lr 10.0000 | loss  3.595 | ppl     36.43 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 21:03:38.018] E013 |   600/731 batches | lr 10.0000 | loss  3.503 | ppl     33.20 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 21:04:19.303] E013 |   731/731 batches | lr 10.0000 | loss  3.478 | ppl     32.40 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 21:04:33.770] End E013 | valid loss  4.671; ppl    106.79 | accu 0.2365 = 27286/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 21:04:48.214] End E013 |  test loss  9.271; ppl  10622.79 | accu 0.0655 = 7348/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:05:54.128] End E013 |  test loss  9.856; ppl  19069.71 | accu 0.0622 = 31519/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:05:54.128] Epoch 014/20 ==================================================
[2022-04-13 21:06:57.661] E014 |   200/731 batches | lr 5.0000 | loss  3.523 | ppl     33.89 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 21:07:58.495] E014 |   400/731 batches | lr 5.0000 | loss  3.516 | ppl     33.64 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 21:08:58.755] E014 |   600/731 batches | lr 5.0000 | loss  3.406 | ppl     30.15 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 21:09:37.791] E014 |   731/731 batches | lr 5.0000 | loss  3.362 | ppl     28.85 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 21:09:52.264] End E014 | valid loss  4.653; ppl    104.93 | accu 0.2414 = 27849/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 21:10:06.948] End E014 |  test loss  9.418; ppl  12302.02 | accu 0.0658 = 7388/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:11:13.539] End E014 |  test loss  9.939; ppl  20716.30 | accu 0.0638 = 32341/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:11:13.539] Epoch 015/20 ==================================================
[2022-04-13 21:12:14.763] E015 |   200/731 batches | lr 2.5000 | loss  3.476 | ppl     32.34 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 21:13:14.526] E015 |   400/731 batches | lr 2.5000 | loss  3.470 | ppl     32.14 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 21:14:17.276] E015 |   600/731 batches | lr 2.5000 | loss  3.351 | ppl     28.54 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 21:15:00.036] E015 |   731/731 batches | lr 2.5000 | loss  3.306 | ppl     27.26 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 21:15:15.005] End E015 | valid loss  4.643; ppl    103.91 | accu 0.2438 = 28127/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 21:15:33.231] End E015 |  test loss  9.449; ppl  12694.29 | accu 0.0664 = 7446/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:16:47.265] End E015 |  test loss  9.929; ppl  20511.60 | accu 0.0658 = 33353/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:16:47.265] Epoch 016/20 ==================================================
[2022-04-13 21:17:48.276] E016 |   200/731 batches | lr 1.2500 | loss  3.452 | ppl     31.56 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 21:18:49.125] E016 |   400/731 batches | lr 1.2500 | loss  3.447 | ppl     31.41 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 21:19:52.815] E016 |   600/731 batches | lr 1.2500 | loss  3.325 | ppl     27.79 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 21:20:34.166] E016 |   731/731 batches | lr 1.2500 | loss  3.272 | ppl     26.36 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 21:20:48.898] End E016 | valid loss  4.633; ppl    102.81 | accu 0.2454 = 28312/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 21:21:03.007] End E016 |  test loss  9.488; ppl  13197.88 | accu 0.0665 = 7460/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:22:10.498] End E016 |  test loss  9.972; ppl  21413.48 | accu 0.0659 = 33385/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:22:10.499] Save: model.pt... 
[2022-04-13 21:22:10.977] Save: model.pt...Done. best_val_loss: 4.6329
[2022-04-13 21:22:10.977] Epoch 017/20 ==================================================
[2022-04-13 21:23:15.147] E017 |   200/731 batches | lr 1.2500 | loss  3.428 | ppl     30.82 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 21:24:17.918] E017 |   400/731 batches | lr 1.2500 | loss  3.435 | ppl     31.02 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 21:25:23.199] E017 |   600/731 batches | lr 1.2500 | loss  3.317 | ppl     27.58 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 21:26:03.342] E017 |   731/731 batches | lr 1.2500 | loss  3.267 | ppl     26.23 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 21:26:17.434] End E017 | valid loss  4.637; ppl    103.28 | accu 0.2451 = 28283/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 21:26:33.844] End E017 |  test loss  9.509; ppl  13475.72 | accu 0.0664 = 7446/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:27:42.005] End E017 |  test loss  9.977; ppl  21535.09 | accu 0.0666 = 33757/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:27:42.005] Epoch 018/20 ==================================================
[2022-04-13 21:28:47.074] E018 |   200/731 batches | lr 0.6250 | loss  3.426 | ppl     30.74 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 21:29:50.456] E018 |   400/731 batches | lr 0.6250 | loss  3.424 | ppl     30.70 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 21:30:52.540] E018 |   600/731 batches | lr 0.6250 | loss  3.299 | ppl     27.08 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 21:31:33.461] E018 |   731/731 batches | lr 0.6250 | loss  3.255 | ppl     25.92 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 21:31:47.885] End E018 | valid loss  4.630; ppl    102.55 | accu 0.2460 = 28380/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 21:32:02.043] End E018 |  test loss  9.471; ppl  12979.04 | accu 0.0665 = 7466/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:33:06.632] End E018 |  test loss  9.931; ppl  20553.60 | accu 0.0667 = 33818/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:33:06.633] Save: model.pt... 
[2022-04-13 21:33:07.127] Save: model.pt...Done. best_val_loss: 4.6303
[2022-04-13 21:33:07.128] Epoch 019/20 ==================================================
[2022-04-13 21:34:08.295] E019 |   200/731 batches | lr 0.6250 | loss  3.414 | ppl     30.37 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 21:35:09.784] E019 |   400/731 batches | lr 0.6250 | loss  3.415 | ppl     30.42 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 21:36:08.973] E019 |   600/731 batches | lr 0.6250 | loss  3.297 | ppl     27.04 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 21:36:51.096] E019 |   731/731 batches | lr 0.6250 | loss  3.251 | ppl     25.81 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 21:37:07.963] End E019 | valid loss  4.632; ppl    102.67 | accu 0.2461 = 28398/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 21:37:22.145] End E019 |  test loss  9.493; ppl  13265.60 | accu 0.0666 = 7478/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:38:26.060] End E019 |  test loss  9.974; ppl  21451.20 | accu 0.0664 = 33631/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:38:26.060] Epoch 020/20 ==================================================
[2022-04-13 21:39:25.413] E020 |   200/731 batches | lr 0.3125 | loss  3.409 | ppl     30.23 frag_cnt/word_cnt=1.358=190183/140000
[2022-04-13 21:40:23.590] E020 |   400/731 batches | lr 0.3125 | loss  3.409 | ppl     30.25 frag_cnt/word_cnt=1.351=189199/140000
[2022-04-13 21:41:22.880] E020 |   600/731 batches | lr 0.3125 | loss  3.293 | ppl     26.92 frag_cnt/word_cnt=1.357=189938/140000
[2022-04-13 21:42:01.463] E020 |   731/731 batches | lr 0.3125 | loss  3.240 | ppl     25.53 frag_cnt/word_cnt=1.359=124608/91700
[2022-04-13 21:42:16.525] End E020 | valid loss  4.629; ppl    102.40 | accu 0.2463 = 28416/115380 | w_len 1.3133 = 151533/115380
[2022-04-13 21:42:31.167] End E020 |  test loss  9.475; ppl  13025.46 | accu 0.0672 = 7543/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:43:41.222] End E020 |  test loss  9.934; ppl  20611.52 | accu 0.0672 = 34039/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:43:41.222] Save: model.pt... 
[2022-04-13 21:43:41.749] Save: model.pt...Done. best_val_loss: 4.6289
[2022-04-13 21:43:55.990] End. test loss  9.47; ppl 13025.46 | accu 0.0672 = 7543/112220 | w_len 1.8753 = 210448/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:44:59.547] End. test loss  9.93; ppl 20611.52 | accu 0.0672 = 34039/506840 | w_len 1.9628 = 994802/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:44:59.547] =========================================================================================
[2022-04-13 21:44:59.547] valid_loss
[2022-04-13 21:44:59.548]  5.42, 5.06, 4.90, 4.80, 4.77, 4.73, 4.72, 4.70, 4.68, 4.73, 4.64, 4.64, 4.67, 4.65, 4.64, 4.63, 4.64, 4.63, 4.63, 4.63
[2022-04-13 21:44:59.548] valid_loss ppl
[2022-04-13 21:44:59.548]   226.48,  157.67,  133.83,  121.68,  117.97,  113.24,  112.56,  109.44,  107.69,  113.05,  103.84,  103.36,  106.79,  104.93,  103.91,  102.81,  103.28,  102.55,  102.67,  102.40
[2022-04-13 21:44:59.548] test_loss of ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:44:59.548]  9.05, 8.80, 8.58, 8.56, 8.60, 8.56, 8.64, 8.74, 8.86, 8.86, 9.10, 9.14, 9.27, 9.42, 9.45, 9.49, 9.51, 9.47, 9.49, 9.47
[2022-04-13 21:44:59.548] test_loss of ../data/sample_500k/adolescent_valid.txt ppl
[2022-04-13 21:44:59.548]  8530.70, 6656.54, 5332.75, 5193.30, 5436.19, 5231.19, 5652.42, 6226.69, 7070.40, 7020.03, 8914.38, 9314.04,10622.79,12302.02,12694.29,13197.88,13475.72,12979.04,13265.60,13025.46
[2022-04-13 21:44:59.548] test_loss of ../data/sample_500k/adult_test.txt
[2022-04-13 21:44:59.548]  9.08, 9.00, 8.81, 8.93, 9.08, 9.14, 9.08, 9.22, 9.40, 9.46, 9.63, 9.69, 9.86, 9.94, 9.93, 9.97, 9.98, 9.93, 9.97, 9.93
[2022-04-13 21:44:59.548] test_loss of ../data/sample_500k/adult_test.txt ppl
[2022-04-13 21:44:59.548]  8751.83, 8107.01, 6676.55, 7584.21, 8737.22, 9332.15, 8771.78,10081.25,12044.12,12827.95,15166.75,16108.59,19069.71,20716.30,20511.60,21413.48,21535.09,20553.60,21451.20,20611.52
[2022-04-13 21:44:59.548] 
[2022-04-13 21:44:59.548] 
[2022-04-13 21:44:59.548] 
Log file: ./output_wsm_Subword.2000_fam_LSTM.log closed.
Log file: ./output_wsm_Subword.5000_fam_CNN.log open...
[2022-04-13 21:44:59.557] corpus.train_file_list: 1
[2022-04-13 21:44:59.557]         ../data/sample_500k/cbt_train.txt
[2022-04-13 21:44:59.557] corpus.valid_file_list: 1
[2022-04-13 21:44:59.557]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 21:44:59.558] corpus.test_file_list: 2
[2022-04-13 21:44:59.558]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:44:59.558]         ../data/sample_500k/adult_test.txt
[2022-04-13 21:44:59.558] corpus.subword_vocab_size: 0
[2022-04-13 21:44:59.558] corpus.subword_model = None. Corpus will not use subword.
[2022-04-13 21:44:59.558] corpus tokenize...
[2022-04-13 21:45:00.208]         train tokens: 511735  ../data/sample_500k/cbt_train.txt
[2022-04-13 21:45:00.345]         valid tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-13 21:45:00.583]         test  tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:45:01.193]         test  tokens: 506878  ../data/sample_500k/adult_test.txt
[2022-04-13 21:45:01.193] corpus.ntokens      : 73236
[2022-04-13 21:45:01.193] corpus.char_count   : 157
[2022-04-13 21:45:01.193] corpus.char_cnt_dict: 157
[2022-04-13 21:45:01.193] corpus.char_id_dict : 157
[2022-04-13 21:45:01.201] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 21:45:01.201]         tokens_all: 511735
[2022-04-13 21:45:01.201]         batched   :  25586
[2022-04-13 21:45:01.201]         ../data/sample_500k/cbt_train.txt
[2022-04-13 21:45:01.203] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 21:45:01.203]         tokens_all: 115417
[2022-04-13 21:45:01.204]         batched   :   5770
[2022-04-13 21:45:01.204]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 21:45:01.205] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 21:45:01.205]         tokens_all: 112256
[2022-04-13 21:45:01.205]         batched   :   5612
[2022-04-13 21:45:01.205]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:45:01.209] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 21:45:01.209]         tokens_all: 506878
[2022-04-13 21:45:01.209]         batched   :  25343
[2022-04-13 21:45:01.209]         ../data/sample_500k/adult_test.txt
[2022-04-13 21:45:01.210] subword_adapter will be generated due to word_split_mode='Subword.5000'
[2022-04-13 21:45:01.210] SubwordAdapter.file_list: 2
[2022-04-13 21:45:01.210]         ../data/sample_500k/cbt_train.txt
[2022-04-13 21:45:01.210]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 21:45:01.210] SubwordAdapter.subword_vocab_size: 5000
[2022-04-13 21:45:01.210] SubwordAdapter.subword_model.train(2 files)...
[2022-04-13 21:45:01.856] SubwordAdapter.subword_model.train(2 files)...Done
[2022-04-13 21:45:02.352] RNNModel.rnn_type: LSTM
[2022-04-13 21:45:02.352] RNNModel.ntoken  : 73236
[2022-04-13 21:45:02.352] RNNModel.ninp    : 200
[2022-04-13 21:45:02.352] RNNModel.nhid    : 200
[2022-04-13 21:45:02.352] RNNModel.nlayers : 2
[2022-04-13 21:45:02.352] RNNModel.dropout : 0.2
[2022-04-13 21:45:02.352] RNNModel.tie_weights: False
[2022-04-13 21:45:02.353] RNNModel.fragment_aggregate_mode: CNN
[2022-04-13 21:45:02.353] RNNModel.fragment_cnt           : 5002
[2022-04-13 21:45:02.353] RNNModel.fragment_emsize        : 25
[2022-04-13 21:45:02.353] RNNModel.fragment_nhid          : 200
[2022-04-13 21:45:02.355] RNNModel.fragment_embeds     : created
[2022-04-13 21:45:02.356] RNNModel.fragment_cnn3       : created
[2022-04-13 21:45:02.383] Epoch 001/20 ==================================================
[2022-04-13 21:45:17.397] E001 |   200/731 batches | lr 20.0000 | loss  7.365 | ppl   1580.44 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 21:45:32.501] E001 |   400/731 batches | lr 20.0000 | loss  6.072 | ppl    433.38 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 21:45:47.568] E001 |   600/731 batches | lr 20.0000 | loss  5.394 | ppl    220.09 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 21:45:57.426] E001 |   731/731 batches | lr 20.0000 | loss  5.201 | ppl    181.40 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 21:46:02.702] End E001 | valid loss  5.316; ppl    203.62 | accu 0.1709 = 19719/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 21:46:07.968] End E001 |  test loss  8.829; ppl   6832.31 | accu 0.0344 = 3859/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:46:31.726] End E001 |  test loss  8.999; ppl   8092.72 | accu 0.0268 = 13586/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:46:31.726] Save: model.pt... 
[2022-04-13 21:46:32.198] Save: model.pt...Done. best_val_loss: 5.3163
[2022-04-13 21:46:32.198] Epoch 002/20 ==================================================
[2022-04-13 21:46:47.890] E002 |   200/731 batches | lr 20.0000 | loss  5.046 | ppl    155.39 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 21:47:03.271] E002 |   400/731 batches | lr 20.0000 | loss  4.962 | ppl    142.82 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 21:47:18.374] E002 |   600/731 batches | lr 20.0000 | loss  4.753 | ppl    115.91 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 21:47:28.210] E002 |   731/731 batches | lr 20.0000 | loss  4.705 | ppl    110.53 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 21:47:33.461] End E002 | valid loss  5.051; ppl    156.16 | accu 0.1853 = 21380/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 21:47:38.655] End E002 |  test loss  8.585; ppl   5351.40 | accu 0.0516 = 5785/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:48:02.351] End E002 |  test loss  8.722; ppl   6133.76 | accu 0.0455 = 23084/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:48:02.351] Save: model.pt... 
[2022-04-13 21:48:02.858] Save: model.pt...Done. best_val_loss: 5.0509
[2022-04-13 21:48:02.859] Epoch 003/20 ==================================================
[2022-04-13 21:48:17.790] E003 |   200/731 batches | lr 20.0000 | loss  4.647 | ppl    104.29 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 21:48:32.885] E003 |   400/731 batches | lr 20.0000 | loss  4.639 | ppl    103.41 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 21:48:47.972] E003 |   600/731 batches | lr 20.0000 | loss  4.494 | ppl     89.47 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 21:48:57.838] E003 |   731/731 batches | lr 20.0000 | loss  4.466 | ppl     87.00 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 21:49:03.118] End E003 | valid loss  4.836; ppl    125.99 | accu 0.2027 = 23390/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 21:49:08.383] End E003 |  test loss  8.511; ppl   4970.58 | accu 0.0596 = 6692/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:49:32.334] End E003 |  test loss  8.777; ppl   6480.49 | accu 0.0539 = 27308/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:49:32.334] Save: model.pt... 
[2022-04-13 21:49:32.811] Save: model.pt...Done. best_val_loss: 4.8362
[2022-04-13 21:49:32.811] Epoch 004/20 ==================================================
[2022-04-13 21:49:47.794] E004 |   200/731 batches | lr 20.0000 | loss  4.447 | ppl     85.38 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 21:50:04.564] E004 |   400/731 batches | lr 20.0000 | loss  4.444 | ppl     85.15 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 21:50:19.756] E004 |   600/731 batches | lr 20.0000 | loss  4.329 | ppl     75.83 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 21:50:29.657] E004 |   731/731 batches | lr 20.0000 | loss  4.307 | ppl     74.24 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 21:50:34.923] End E004 | valid loss  4.839; ppl    126.29 | accu 0.1979 = 22828/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 21:50:40.154] End E004 |  test loss  8.495; ppl   4892.51 | accu 0.0597 = 6704/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:51:03.988] End E004 |  test loss  8.779; ppl   6498.02 | accu 0.0526 = 26682/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:51:03.989] Epoch 005/20 ==================================================
[2022-04-13 21:51:18.877] E005 |   200/731 batches | lr 10.0000 | loss  4.232 | ppl     68.87 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 21:51:33.921] E005 |   400/731 batches | lr 10.0000 | loss  4.207 | ppl     67.18 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 21:51:49.059] E005 |   600/731 batches | lr 10.0000 | loss  4.085 | ppl     59.46 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 21:51:58.977] E005 |   731/731 batches | lr 10.0000 | loss  4.050 | ppl     57.37 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 21:52:05.340] End E005 | valid loss  4.651; ppl    104.66 | accu 0.2297 = 26502/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 21:52:11.649] End E005 |  test loss  8.604; ppl   5454.11 | accu 0.0670 = 7517/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:52:40.504] End E005 |  test loss  8.859; ppl   7040.46 | accu 0.0621 = 31489/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:52:40.505] Save: model.pt... 
[2022-04-13 21:52:40.979] Save: model.pt...Done. best_val_loss: 4.6507
[2022-04-13 21:52:40.980] Epoch 006/20 ==================================================
[2022-04-13 21:52:57.649] E006 |   200/731 batches | lr 10.0000 | loss  4.112 | ppl     61.10 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 21:53:14.654] E006 |   400/731 batches | lr 10.0000 | loss  4.112 | ppl     61.09 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 21:53:31.628] E006 |   600/731 batches | lr 10.0000 | loss  4.006 | ppl     54.94 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 21:53:42.767] E006 |   731/731 batches | lr 10.0000 | loss  3.982 | ppl     53.63 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 21:53:49.128] End E006 | valid loss  4.646; ppl    104.14 | accu 0.2299 = 26523/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 21:53:55.448] End E006 |  test loss  8.646; ppl   5687.88 | accu 0.0667 = 7487/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:54:22.089] End E006 |  test loss  8.957; ppl   7763.53 | accu 0.0607 = 30740/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:54:22.089] Save: model.pt... 
[2022-04-13 21:54:22.579] Save: model.pt...Done. best_val_loss: 4.6457
[2022-04-13 21:54:22.580] Epoch 007/20 ==================================================
[2022-04-13 21:54:37.796] E007 |   200/731 batches | lr 10.0000 | loss  4.028 | ppl     56.18 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 21:54:52.978] E007 |   400/731 batches | lr 10.0000 | loss  4.034 | ppl     56.46 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 21:55:08.184] E007 |   600/731 batches | lr 10.0000 | loss  3.934 | ppl     51.10 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 21:55:18.141] E007 |   731/731 batches | lr 10.0000 | loss  3.915 | ppl     50.13 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 21:55:23.434] End E007 | valid loss  4.631; ppl    102.66 | accu 0.2318 = 26740/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 21:55:28.667] End E007 |  test loss  8.628; ppl   5585.68 | accu 0.0679 = 7624/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:55:52.468] End E007 |  test loss  8.924; ppl   7509.94 | accu 0.0630 = 31908/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:55:52.469] Save: model.pt... 
[2022-04-13 21:55:52.948] Save: model.pt...Done. best_val_loss: 4.6314
[2022-04-13 21:55:52.948] Epoch 008/20 ==================================================
[2022-04-13 21:56:08.055] E008 |   200/731 batches | lr 10.0000 | loss  3.958 | ppl     52.33 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 21:56:23.242] E008 |   400/731 batches | lr 10.0000 | loss  3.967 | ppl     52.82 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 21:56:38.448] E008 |   600/731 batches | lr 10.0000 | loss  3.870 | ppl     47.96 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 21:56:48.413] E008 |   731/731 batches | lr 10.0000 | loss  3.852 | ppl     47.07 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 21:56:53.669] End E008 | valid loss  4.628; ppl    102.33 | accu 0.2336 = 26958/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 21:56:58.889] End E008 |  test loss  8.794; ppl   6592.40 | accu 0.0684 = 7678/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:57:26.838] End E008 |  test loss  9.111; ppl   9057.46 | accu 0.0650 = 32922/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:57:26.838] Save: model.pt... 
[2022-04-13 21:57:27.320] Save: model.pt...Done. best_val_loss: 4.6282
[2022-04-13 21:57:27.320] Epoch 009/20 ==================================================
[2022-04-13 21:57:43.244] E009 |   200/731 batches | lr 10.0000 | loss  3.892 | ppl     49.02 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 21:57:58.620] E009 |   400/731 batches | lr 10.0000 | loss  3.909 | ppl     49.86 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 21:58:13.807] E009 |   600/731 batches | lr 10.0000 | loss  3.815 | ppl     45.36 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 21:58:23.777] E009 |   731/731 batches | lr 10.0000 | loss  3.799 | ppl     44.67 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 21:58:29.042] End E009 | valid loss  4.626; ppl    102.06 | accu 0.2355 = 27177/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 21:58:34.280] End E009 |  test loss  8.909; ppl   7401.82 | accu 0.0672 = 7538/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 21:58:58.120] End E009 |  test loss  9.238; ppl  10285.06 | accu 0.0614 = 31110/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 21:58:58.121] Save: model.pt... 
[2022-04-13 21:58:58.602] Save: model.pt...Done. best_val_loss: 4.6256
[2022-04-13 21:58:58.602] Epoch 010/20 ==================================================
[2022-04-13 21:59:13.749] E010 |   200/731 batches | lr 10.0000 | loss  3.836 | ppl     46.36 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 21:59:29.597] E010 |   400/731 batches | lr 10.0000 | loss  3.859 | ppl     47.42 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 21:59:46.666] E010 |   600/731 batches | lr 10.0000 | loss  3.762 | ppl     43.01 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 21:59:57.123] E010 |   731/731 batches | lr 10.0000 | loss  3.746 | ppl     42.33 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:00:03.429] End E010 | valid loss  4.622; ppl    101.71 | accu 0.2357 = 27194/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:00:09.871] End E010 |  test loss  8.899; ppl   7325.24 | accu 0.0690 = 7745/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:00:38.704] End E010 |  test loss  9.197; ppl   9872.01 | accu 0.0635 = 32188/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:00:38.704] Save: model.pt... 
[2022-04-13 22:00:39.188] Save: model.pt...Done. best_val_loss: 4.6221
[2022-04-13 22:00:39.188] Epoch 011/20 ==================================================
[2022-04-13 22:00:54.460] E011 |   200/731 batches | lr 10.0000 | loss  3.787 | ppl     44.14 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:01:09.715] E011 |   400/731 batches | lr 10.0000 | loss  3.807 | ppl     45.03 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:01:25.014] E011 |   600/731 batches | lr 10.0000 | loss  3.720 | ppl     41.25 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:01:34.989] E011 |   731/731 batches | lr 10.0000 | loss  3.698 | ppl     40.36 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:01:40.266] End E011 | valid loss  4.628; ppl    102.26 | accu 0.2363 = 27265/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:01:45.486] End E011 |  test loss  8.950; ppl   7707.30 | accu 0.0681 = 7646/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:02:09.415] End E011 |  test loss  9.299; ppl  10924.25 | accu 0.0620 = 31427/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:02:09.415] Epoch 012/20 ==================================================
[2022-04-13 22:02:24.485] E012 |   200/731 batches | lr 5.0000 | loss  3.717 | ppl     41.13 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:02:39.698] E012 |   400/731 batches | lr 5.0000 | loss  3.713 | ppl     40.96 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:02:54.845] E012 |   600/731 batches | lr 5.0000 | loss  3.599 | ppl     36.57 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:03:04.782] E012 |   731/731 batches | lr 5.0000 | loss  3.564 | ppl     35.31 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:03:10.036] End E012 | valid loss  4.613; ppl    100.84 | accu 0.2402 = 27716/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:03:15.273] End E012 |  test loss  9.101; ppl   8960.56 | accu 0.0687 = 7710/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:03:39.246] End E012 |  test loss  9.417; ppl  12298.35 | accu 0.0629 = 31905/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:03:39.247] Save: model.pt... 
[2022-04-13 22:03:39.747] Save: model.pt...Done. best_val_loss: 4.6135
[2022-04-13 22:03:39.748] Epoch 013/20 ==================================================
[2022-04-13 22:03:54.912] E013 |   200/731 batches | lr 5.0000 | loss  3.650 | ppl     38.48 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:04:10.123] E013 |   400/731 batches | lr 5.0000 | loss  3.665 | ppl     39.05 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:04:25.382] E013 |   600/731 batches | lr 5.0000 | loss  3.565 | ppl     35.33 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:04:35.923] E013 |   731/731 batches | lr 5.0000 | loss  3.535 | ppl     34.30 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:04:42.307] End E013 | valid loss  4.620; ppl    101.51 | accu 0.2415 = 27867/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:04:48.617] End E013 |  test loss  9.186; ppl   9763.69 | accu 0.0678 = 7604/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:05:17.458] End E013 |  test loss  9.502; ppl  13380.69 | accu 0.0623 = 31596/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:05:17.458] Epoch 014/20 ==================================================
[2022-04-13 22:05:33.075] E014 |   200/731 batches | lr 2.5000 | loss  3.614 | ppl     37.11 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:05:48.731] E014 |   400/731 batches | lr 2.5000 | loss  3.616 | ppl     37.17 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:06:04.487] E014 |   600/731 batches | lr 2.5000 | loss  3.502 | ppl     33.18 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:06:14.803] E014 |   731/731 batches | lr 2.5000 | loss  3.459 | ppl     31.79 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:06:20.081] End E014 | valid loss  4.614; ppl    100.84 | accu 0.2448 = 28242/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:06:25.325] End E014 |  test loss  9.186; ppl   9762.77 | accu 0.0703 = 7893/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:06:49.252] End E014 |  test loss  9.536; ppl  13851.70 | accu 0.0638 = 32327/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:06:49.253] Epoch 015/20 ==================================================
[2022-04-13 22:07:04.058] E015 |   200/731 batches | lr 1.2500 | loss  3.588 | ppl     36.18 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:07:19.154] E015 |   400/731 batches | lr 1.2500 | loss  3.587 | ppl     36.13 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:07:34.312] E015 |   600/731 batches | lr 1.2500 | loss  3.470 | ppl     32.14 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:07:44.576] E015 |   731/731 batches | lr 1.2500 | loss  3.423 | ppl     30.65 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:07:49.892] End E015 | valid loss  4.611; ppl    100.62 | accu 0.2465 = 28438/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:07:55.156] End E015 |  test loss  9.225; ppl  10148.26 | accu 0.0707 = 7929/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:08:22.922] End E015 |  test loss  9.575; ppl  14399.18 | accu 0.0650 = 32969/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:08:22.922] Save: model.pt... 
[2022-04-13 22:08:23.403] Save: model.pt...Done. best_val_loss: 4.6114
[2022-04-13 22:08:23.403] Epoch 016/20 ==================================================
[2022-04-13 22:08:38.799] E016 |   200/731 batches | lr 1.2500 | loss  3.562 | ppl     35.25 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:08:54.088] E016 |   400/731 batches | lr 1.2500 | loss  3.571 | ppl     35.55 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:09:09.273] E016 |   600/731 batches | lr 1.2500 | loss  3.461 | ppl     31.85 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:09:19.284] E016 |   731/731 batches | lr 1.2500 | loss  3.419 | ppl     30.55 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:09:24.599] End E016 | valid loss  4.613; ppl    100.74 | accu 0.2462 = 28404/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:09:29.886] End E016 |  test loss  9.230; ppl  10198.99 | accu 0.0713 = 7997/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:09:54.918] End E016 |  test loss  9.570; ppl  14328.79 | accu 0.0655 = 33211/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:09:54.918] Epoch 017/20 ==================================================
[2022-04-13 22:10:10.088] E017 |   200/731 batches | lr 0.6250 | loss  3.554 | ppl     34.96 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:10:25.542] E017 |   400/731 batches | lr 0.6250 | loss  3.557 | ppl     35.06 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:10:41.182] E017 |   600/731 batches | lr 0.6250 | loss  3.442 | ppl     31.25 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:10:51.170] E017 |   731/731 batches | lr 0.6250 | loss  3.397 | ppl     29.87 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:10:57.565] End E017 | valid loss  4.609; ppl    100.38 | accu 0.2468 = 28476/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:11:03.049] End E017 |  test loss  9.237; ppl  10265.63 | accu 0.0717 = 8049/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:11:27.227] End E017 |  test loss  9.569; ppl  14311.61 | accu 0.0664 = 33669/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:11:27.227] Save: model.pt... 
[2022-04-13 22:11:27.763] Save: model.pt...Done. best_val_loss: 4.6089
[2022-04-13 22:11:27.763] Epoch 018/20 ==================================================
[2022-04-13 22:11:43.836] E018 |   200/731 batches | lr 0.6250 | loss  3.541 | ppl     34.49 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:11:59.235] E018 |   400/731 batches | lr 0.6250 | loss  3.550 | ppl     34.82 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:12:14.544] E018 |   600/731 batches | lr 0.6250 | loss  3.438 | ppl     31.14 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:12:24.469] E018 |   731/731 batches | lr 0.6250 | loss  3.393 | ppl     29.76 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:12:29.783] End E018 | valid loss  4.610; ppl    100.50 | accu 0.2466 = 28456/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:12:35.086] End E018 |  test loss  9.253; ppl  10433.88 | accu 0.0713 = 7999/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:12:59.165] End E018 |  test loss  9.593; ppl  14657.91 | accu 0.0661 = 33487/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:12:59.165] Epoch 019/20 ==================================================
[2022-04-13 22:13:14.367] E019 |   200/731 batches | lr 0.3125 | loss  3.539 | ppl     34.45 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:13:29.777] E019 |   400/731 batches | lr 0.3125 | loss  3.545 | ppl     34.64 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:13:45.112] E019 |   600/731 batches | lr 0.3125 | loss  3.430 | ppl     30.88 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:13:55.412] E019 |   731/731 batches | lr 0.3125 | loss  3.386 | ppl     29.54 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:14:00.692] End E019 | valid loss  4.608; ppl    100.32 | accu 0.2473 = 28537/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:14:05.925] End E019 |  test loss  9.239; ppl  10292.39 | accu 0.0717 = 8046/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:14:29.932] End E019 |  test loss  9.574; ppl  14378.79 | accu 0.0663 = 33603/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:14:29.933] Save: model.pt... 
[2022-04-13 22:14:30.423] Save: model.pt...Done. best_val_loss: 4.6083
[2022-04-13 22:14:30.423] Epoch 020/20 ==================================================
[2022-04-13 22:14:45.558] E020 |   200/731 batches | lr 0.3125 | loss  3.532 | ppl     34.19 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:15:00.920] E020 |   400/731 batches | lr 0.3125 | loss  3.538 | ppl     34.39 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:15:16.335] E020 |   600/731 batches | lr 0.3125 | loss  3.432 | ppl     30.94 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:15:26.448] E020 |   731/731 batches | lr 0.3125 | loss  3.388 | ppl     29.62 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:15:31.729] End E020 | valid loss  4.609; ppl    100.38 | accu 0.2475 = 28558/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:15:37.081] End E020 |  test loss  9.238; ppl  10284.73 | accu 0.0722 = 8097/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:16:01.106] End E020 |  test loss  9.575; ppl  14404.47 | accu 0.0669 = 33895/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:16:06.470] End. test loss  9.24; ppl 10292.39 | accu 0.0717 = 8046/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:16:30.493] End. test loss  9.57; ppl 14378.79 | accu 0.0663 = 33603/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:16:30.493] =========================================================================================
[2022-04-13 22:16:30.493] valid_loss
[2022-04-13 22:16:30.493]  5.32, 5.05, 4.84, 4.84, 4.65, 4.65, 4.63, 4.63, 4.63, 4.62, 4.63, 4.61, 4.62, 4.61, 4.61, 4.61, 4.61, 4.61, 4.61, 4.61
[2022-04-13 22:16:30.493] valid_loss ppl
[2022-04-13 22:16:30.493]   203.62,  156.16,  125.99,  126.29,  104.66,  104.14,  102.66,  102.33,  102.06,  101.71,  102.26,  100.84,  101.51,  100.84,  100.62,  100.74,  100.38,  100.50,  100.32,  100.38
[2022-04-13 22:16:30.493] test_loss of ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:16:30.493]  8.83, 8.59, 8.51, 8.50, 8.60, 8.65, 8.63, 8.79, 8.91, 8.90, 8.95, 9.10, 9.19, 9.19, 9.23, 9.23, 9.24, 9.25, 9.24, 9.24
[2022-04-13 22:16:30.493] test_loss of ../data/sample_500k/adolescent_valid.txt ppl
[2022-04-13 22:16:30.494]  6832.31, 5351.40, 4970.58, 4892.51, 5454.11, 5687.88, 5585.68, 6592.40, 7401.82, 7325.24, 7707.30, 8960.56, 9763.69, 9762.77,10148.26,10198.99,10265.63,10433.88,10292.39,10284.73
[2022-04-13 22:16:30.494] test_loss of ../data/sample_500k/adult_test.txt
[2022-04-13 22:16:30.494]  9.00, 8.72, 8.78, 8.78, 8.86, 8.96, 8.92, 9.11, 9.24, 9.20, 9.30, 9.42, 9.50, 9.54, 9.57, 9.57, 9.57, 9.59, 9.57, 9.58
[2022-04-13 22:16:30.494] test_loss of ../data/sample_500k/adult_test.txt ppl
[2022-04-13 22:16:30.494]  8092.72, 6133.76, 6480.49, 6498.02, 7040.46, 7763.53, 7509.94, 9057.46,10285.06, 9872.01,10924.25,12298.35,13380.69,13851.70,14399.18,14328.79,14311.61,14657.91,14378.79,14404.47
[2022-04-13 22:16:30.494] 
[2022-04-13 22:16:30.494] 
[2022-04-13 22:16:30.494] 
Log file: ./output_wsm_Subword.5000_fam_CNN.log closed.
Log file: ./output_wsm_Subword.5000_fam_LSTM.log open...
[2022-04-13 22:16:30.503] corpus.train_file_list: 1
[2022-04-13 22:16:30.503]         ../data/sample_500k/cbt_train.txt
[2022-04-13 22:16:30.503] corpus.valid_file_list: 1
[2022-04-13 22:16:30.503]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 22:16:30.503] corpus.test_file_list: 2
[2022-04-13 22:16:30.503]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:16:30.503]         ../data/sample_500k/adult_test.txt
[2022-04-13 22:16:30.503] corpus.subword_vocab_size: 0
[2022-04-13 22:16:30.503] corpus.subword_model = None. Corpus will not use subword.
[2022-04-13 22:16:30.503] corpus tokenize...
[2022-04-13 22:16:31.158]         train tokens: 511735  ../data/sample_500k/cbt_train.txt
[2022-04-13 22:16:31.298]         valid tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-13 22:16:31.524]         test  tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:16:32.146]         test  tokens: 506878  ../data/sample_500k/adult_test.txt
[2022-04-13 22:16:32.146] corpus.ntokens      : 73236
[2022-04-13 22:16:32.146] corpus.char_count   : 157
[2022-04-13 22:16:32.146] corpus.char_cnt_dict: 157
[2022-04-13 22:16:32.146] corpus.char_id_dict : 157
[2022-04-13 22:16:32.152] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 22:16:32.152]         tokens_all: 511735
[2022-04-13 22:16:32.152]         batched   :  25586
[2022-04-13 22:16:32.152]         ../data/sample_500k/cbt_train.txt
[2022-04-13 22:16:32.154] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 22:16:32.154]         tokens_all: 115417
[2022-04-13 22:16:32.154]         batched   :   5770
[2022-04-13 22:16:32.154]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 22:16:32.155] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 22:16:32.156]         tokens_all: 112256
[2022-04-13 22:16:32.156]         batched   :   5612
[2022-04-13 22:16:32.156]         ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:16:32.159] corpus.batchify(1 files, batch_size=20)...
[2022-04-13 22:16:32.160]         tokens_all: 506878
[2022-04-13 22:16:32.160]         batched   :  25343
[2022-04-13 22:16:32.160]         ../data/sample_500k/adult_test.txt
[2022-04-13 22:16:32.160] subword_adapter will be generated due to word_split_mode='Subword.5000'
[2022-04-13 22:16:32.161] SubwordAdapter.file_list: 2
[2022-04-13 22:16:32.161]         ../data/sample_500k/cbt_train.txt
[2022-04-13 22:16:32.161]         ../data/sample_500k/cbt_valid.txt
[2022-04-13 22:16:32.161] SubwordAdapter.subword_vocab_size: 5000
[2022-04-13 22:16:32.161] SubwordAdapter.subword_model.train(2 files)...
[2022-04-13 22:16:32.794] SubwordAdapter.subword_model.train(2 files)...Done
[2022-04-13 22:16:33.309] RNNModel.rnn_type: LSTM
[2022-04-13 22:16:33.309] RNNModel.ntoken  : 73236
[2022-04-13 22:16:33.309] RNNModel.ninp    : 200
[2022-04-13 22:16:33.309] RNNModel.nhid    : 200
[2022-04-13 22:16:33.309] RNNModel.nlayers : 2
[2022-04-13 22:16:33.309] RNNModel.dropout : 0.2
[2022-04-13 22:16:33.309] RNNModel.tie_weights: False
[2022-04-13 22:16:33.309] RNNModel.fragment_aggregate_mode: LSTM
[2022-04-13 22:16:33.309] RNNModel.fragment_cnt           : 5002
[2022-04-13 22:16:33.309] RNNModel.fragment_emsize        : 25
[2022-04-13 22:16:33.309] RNNModel.fragment_nhid          : 200
[2022-04-13 22:16:33.312] RNNModel.fragment_embeds     : created
[2022-04-13 22:16:33.315] RNNModel.fragment_lstm       : created
[2022-04-13 22:16:33.315] RNNModel.fragment_lstm_linear: created
[2022-04-13 22:16:33.342] Epoch 001/20 ==================================================
[2022-04-13 22:17:36.235] E001 |   200/731 batches | lr 20.0000 | loss  7.363 | ppl   1577.14 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:18:38.449] E001 |   400/731 batches | lr 20.0000 | loss  5.992 | ppl    400.33 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:19:41.599] E001 |   600/731 batches | lr 20.0000 | loss  5.376 | ppl    216.24 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:20:22.163] E001 |   731/731 batches | lr 20.0000 | loss  5.203 | ppl    181.88 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:20:36.624] End E001 | valid loss  5.409; ppl    223.42 | accu 0.1623 = 18727/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:20:51.845] End E001 |  test loss  8.896; ppl   7300.93 | accu 0.0459 = 5146/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:21:58.648] End E001 |  test loss  8.808; ppl   6688.59 | accu 0.0468 = 23708/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:21:58.648] Save: model.pt... 
[2022-04-13 22:21:59.111] Save: model.pt...Done. best_val_loss: 5.4091
[2022-04-13 22:21:59.112] Epoch 002/20 ==================================================
[2022-04-13 22:23:04.249] E002 |   200/731 batches | lr 20.0000 | loss  5.061 | ppl    157.76 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:24:05.304] E002 |   400/731 batches | lr 20.0000 | loss  4.962 | ppl    142.84 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:25:10.033] E002 |   600/731 batches | lr 20.0000 | loss  4.769 | ppl    117.80 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:25:50.916] E002 |   731/731 batches | lr 20.0000 | loss  4.719 | ppl    112.05 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:26:05.278] End E002 | valid loss  5.064; ppl    158.19 | accu 0.1724 = 19891/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:26:19.407] End E002 |  test loss  8.794; ppl   6596.85 | accu 0.0320 = 3589/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:27:25.467] End E002 |  test loss  8.898; ppl   7315.17 | accu 0.0323 = 16390/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:27:25.467] Save: model.pt... 
[2022-04-13 22:27:25.928] Save: model.pt...Done. best_val_loss: 5.0638
[2022-04-13 22:27:25.928] Epoch 003/20 ==================================================
[2022-04-13 22:28:28.936] E003 |   200/731 batches | lr 20.0000 | loss  4.666 | ppl    106.27 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:29:34.735] E003 |   400/731 batches | lr 20.0000 | loss  4.634 | ppl    102.90 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:30:39.538] E003 |   600/731 batches | lr 20.0000 | loss  4.496 | ppl     89.63 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:31:23.025] E003 |   731/731 batches | lr 20.0000 | loss  4.467 | ppl     87.13 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:31:37.303] End E003 | valid loss  4.895; ppl    133.58 | accu 0.1943 = 22414/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:31:51.556] End E003 |  test loss  8.736; ppl   6223.43 | accu 0.0475 = 5330/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:32:56.053] End E003 |  test loss  8.913; ppl   7426.16 | accu 0.0474 = 24008/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:32:56.053] Save: model.pt... 
[2022-04-13 22:32:56.584] Save: model.pt...Done. best_val_loss: 4.8947
[2022-04-13 22:32:56.584] Epoch 004/20 ==================================================
[2022-04-13 22:34:00.980] E004 |   200/731 batches | lr 20.0000 | loss  4.446 | ppl     85.25 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:35:03.308] E004 |   400/731 batches | lr 20.0000 | loss  4.437 | ppl     84.48 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:36:06.002] E004 |   600/731 batches | lr 20.0000 | loss  4.323 | ppl     75.41 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:36:45.808] E004 |   731/731 batches | lr 20.0000 | loss  4.300 | ppl     73.70 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:37:00.224] End E004 | valid loss  4.799; ppl    121.38 | accu 0.2060 = 23767/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:37:14.321] End E004 |  test loss  8.804; ppl   6661.50 | accu 0.0537 = 6031/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:38:21.273] End E004 |  test loss  9.032; ppl   8366.75 | accu 0.0548 = 27753/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:38:21.273] Save: model.pt... 
[2022-04-13 22:38:21.745] Save: model.pt...Done. best_val_loss: 4.7989
[2022-04-13 22:38:21.745] Epoch 005/20 ==================================================
[2022-04-13 22:39:24.934] E005 |   200/731 batches | lr 20.0000 | loss  4.293 | ppl     73.17 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:40:29.725] E005 |   400/731 batches | lr 20.0000 | loss  4.294 | ppl     73.23 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:41:33.215] E005 |   600/731 batches | lr 20.0000 | loss  4.187 | ppl     65.84 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:42:14.488] E005 |   731/731 batches | lr 20.0000 | loss  4.169 | ppl     64.63 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:42:28.837] End E005 | valid loss  4.767; ppl    117.53 | accu 0.2087 = 24080/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:42:43.014] End E005 |  test loss  8.931; ppl   7564.44 | accu 0.0515 = 5776/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:43:50.925] End E005 |  test loss  9.279; ppl  10710.65 | accu 0.0496 = 25160/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:43:50.925] Save: model.pt... 
[2022-04-13 22:43:51.404] Save: model.pt...Done. best_val_loss: 4.7667
[2022-04-13 22:43:51.405] Epoch 006/20 ==================================================
[2022-04-13 22:44:56.020] E006 |   200/731 batches | lr 20.0000 | loss  4.167 | ppl     64.55 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:45:57.560] E006 |   400/731 batches | lr 20.0000 | loss  4.175 | ppl     65.04 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:47:01.055] E006 |   600/731 batches | lr 20.0000 | loss  4.076 | ppl     58.93 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:47:40.968] E006 |   731/731 batches | lr 20.0000 | loss  4.063 | ppl     58.17 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:47:55.217] End E006 | valid loss  4.727; ppl    113.00 | accu 0.2132 = 24600/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:48:09.174] End E006 |  test loss  9.044; ppl   8467.88 | accu 0.0489 = 5488/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:49:13.541] End E006 |  test loss  9.287; ppl  10795.55 | accu 0.0482 = 24432/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:49:13.541] Save: model.pt... 
[2022-04-13 22:49:14.061] Save: model.pt...Done. best_val_loss: 4.7274
[2022-04-13 22:49:14.062] Epoch 007/20 ==================================================
[2022-04-13 22:50:16.810] E007 |   200/731 batches | lr 20.0000 | loss  4.063 | ppl     58.16 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:51:22.796] E007 |   400/731 batches | lr 20.0000 | loss  4.076 | ppl     58.92 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:52:26.351] E007 |   600/731 batches | lr 20.0000 | loss  3.988 | ppl     53.93 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:53:05.943] E007 |   731/731 batches | lr 20.0000 | loss  3.973 | ppl     53.13 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:53:21.171] End E007 | valid loss  4.712; ppl    111.29 | accu 0.2177 = 25117/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:53:35.164] End E007 |  test loss  9.059; ppl   8596.08 | accu 0.0496 = 5562/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 22:54:48.545] End E007 |  test loss  9.463; ppl  12870.31 | accu 0.0481 = 24369/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 22:54:48.545] Save: model.pt... 
[2022-04-13 22:54:49.036] Save: model.pt...Done. best_val_loss: 4.7121
[2022-04-13 22:54:49.036] Epoch 008/20 ==================================================
[2022-04-13 22:55:51.137] E008 |   200/731 batches | lr 20.0000 | loss  3.971 | ppl     53.04 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 22:56:52.245] E008 |   400/731 batches | lr 20.0000 | loss  3.994 | ppl     54.29 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 22:57:54.055] E008 |   600/731 batches | lr 20.0000 | loss  3.906 | ppl     49.72 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 22:58:34.407] E008 |   731/731 batches | lr 20.0000 | loss  3.894 | ppl     49.12 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 22:58:50.466] End E008 | valid loss  4.713; ppl    111.40 | accu 0.2172 = 25059/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 22:59:05.427] End E008 |  test loss  9.084; ppl   8815.42 | accu 0.0513 = 5754/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 23:00:09.043] End E008 |  test loss  9.482; ppl  13122.12 | accu 0.0497 = 25204/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 23:00:09.043] Epoch 009/20 ==================================================
[2022-04-13 23:01:09.080] E009 |   200/731 batches | lr 10.0000 | loss  3.842 | ppl     46.62 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 23:02:11.382] E009 |   400/731 batches | lr 10.0000 | loss  3.821 | ppl     45.66 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 23:03:10.097] E009 |   600/731 batches | lr 10.0000 | loss  3.706 | ppl     40.68 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 23:03:53.834] E009 |   731/731 batches | lr 10.0000 | loss  3.663 | ppl     38.98 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 23:04:08.311] End E009 | valid loss  4.639; ppl    103.48 | accu 0.2376 = 27420/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 23:04:22.382] End E009 |  test loss  9.233; ppl  10232.16 | accu 0.0583 = 6539/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 23:05:26.570] End E009 |  test loss  9.656; ppl  15615.55 | accu 0.0582 = 29523/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 23:05:26.571] Save: model.pt... 
[2022-04-13 23:05:27.037] Save: model.pt...Done. best_val_loss: 4.6394
[2022-04-13 23:05:27.037] Epoch 010/20 ==================================================
[2022-04-13 23:06:28.190] E010 |   200/731 batches | lr 10.0000 | loss  3.738 | ppl     42.03 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 23:07:28.311] E010 |   400/731 batches | lr 10.0000 | loss  3.748 | ppl     42.44 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 23:08:27.769] E010 |   600/731 batches | lr 10.0000 | loss  3.643 | ppl     38.22 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 23:09:07.959] E010 |   731/731 batches | lr 10.0000 | loss  3.621 | ppl     37.38 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 23:09:22.118] End E010 | valid loss  4.649; ppl    104.46 | accu 0.2388 = 27557/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 23:09:36.234] End E010 |  test loss  9.320; ppl  11159.88 | accu 0.0581 = 6522/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 23:10:41.271] End E010 |  test loss  9.643; ppl  15411.66 | accu 0.0594 = 30102/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 23:10:41.271] Epoch 011/20 ==================================================
[2022-04-13 23:11:44.667] E011 |   200/731 batches | lr 5.0000 | loss  3.667 | ppl     39.12 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 23:12:43.756] E011 |   400/731 batches | lr 5.0000 | loss  3.660 | ppl     38.86 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 23:13:45.712] E011 |   600/731 batches | lr 5.0000 | loss  3.539 | ppl     34.43 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 23:14:25.928] E011 |   731/731 batches | lr 5.0000 | loss  3.496 | ppl     32.97 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 23:14:40.512] End E011 | valid loss  4.635; ppl    103.06 | accu 0.2420 = 27921/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 23:14:54.538] End E011 |  test loss  9.502; ppl  13387.73 | accu 0.0584 = 6556/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 23:16:02.645] End E011 |  test loss  9.786; ppl  17776.70 | accu 0.0593 = 30058/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 23:16:02.645] Save: model.pt... 
[2022-04-13 23:16:03.111] Save: model.pt...Done. best_val_loss: 4.6353
[2022-04-13 23:16:03.111] Epoch 012/20 ==================================================
[2022-04-13 23:17:03.967] E012 |   200/731 batches | lr 5.0000 | loss  3.610 | ppl     36.95 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 23:18:05.820] E012 |   400/731 batches | lr 5.0000 | loss  3.614 | ppl     37.11 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 23:19:05.719] E012 |   600/731 batches | lr 5.0000 | loss  3.511 | ppl     33.48 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 23:19:47.138] E012 |   731/731 batches | lr 5.0000 | loss  3.472 | ppl     32.20 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 23:20:01.769] End E012 | valid loss  4.632; ppl    102.72 | accu 0.2412 = 27833/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 23:20:16.009] End E012 |  test loss  9.493; ppl  13267.84 | accu 0.0592 = 6647/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 23:21:21.117] End E012 |  test loss  9.819; ppl  18384.66 | accu 0.0604 = 30608/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 23:21:21.117] Save: model.pt... 
[2022-04-13 23:21:21.588] Save: model.pt...Done. best_val_loss: 4.6321
[2022-04-13 23:21:21.588] Epoch 013/20 ==================================================
[2022-04-13 23:22:25.042] E013 |   200/731 batches | lr 5.0000 | loss  3.572 | ppl     35.58 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 23:23:28.513] E013 |   400/731 batches | lr 5.0000 | loss  3.581 | ppl     35.90 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 23:24:29.127] E013 |   600/731 batches | lr 5.0000 | loss  3.480 | ppl     32.45 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 23:25:08.932] E013 |   731/731 batches | lr 5.0000 | loss  3.451 | ppl     31.52 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 23:25:23.137] End E013 | valid loss  4.637; ppl    103.19 | accu 0.2416 = 27874/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 23:25:37.190] End E013 |  test loss  9.530; ppl  13766.70 | accu 0.0615 = 6905/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 23:26:42.826] End E013 |  test loss  9.900; ppl  19923.64 | accu 0.0624 = 31611/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 23:26:42.826] Epoch 014/20 ==================================================
[2022-04-13 23:27:42.512] E014 |   200/731 batches | lr 2.5000 | loss  3.540 | ppl     34.47 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 23:28:49.094] E014 |   400/731 batches | lr 2.5000 | loss  3.542 | ppl     34.55 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 23:29:53.119] E014 |   600/731 batches | lr 2.5000 | loss  3.425 | ppl     30.71 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 23:30:35.715] E014 |   731/731 batches | lr 2.5000 | loss  3.386 | ppl     29.54 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 23:30:51.170] End E014 | valid loss  4.638; ppl    103.39 | accu 0.2431 = 28045/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 23:31:05.165] End E014 |  test loss  9.548; ppl  14020.36 | accu 0.0623 = 6989/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 23:32:13.950] End E014 |  test loss  9.903; ppl  19998.75 | accu 0.0638 = 32320/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 23:32:13.950] Epoch 015/20 ==================================================
[2022-04-13 23:33:20.278] E015 |   200/731 batches | lr 1.2500 | loss  3.516 | ppl     33.66 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 23:34:22.722] E015 |   400/731 batches | lr 1.2500 | loss  3.514 | ppl     33.59 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 23:35:30.311] E015 |   600/731 batches | lr 1.2500 | loss  3.399 | ppl     29.94 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 23:36:12.614] E015 |   731/731 batches | lr 1.2500 | loss  3.352 | ppl     28.55 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 23:36:26.698] End E015 | valid loss  4.637; ppl    103.21 | accu 0.2438 = 28131/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 23:36:40.446] End E015 |  test loss  9.577; ppl  14425.97 | accu 0.0642 = 7210/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 23:37:46.862] End E015 |  test loss  9.967; ppl  21307.40 | accu 0.0641 = 32479/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 23:37:46.863] Epoch 016/20 ==================================================
[2022-04-13 23:38:46.251] E016 |   200/731 batches | lr 0.6250 | loss  3.504 | ppl     33.24 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 23:39:48.903] E016 |   400/731 batches | lr 0.6250 | loss  3.503 | ppl     33.20 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 23:40:54.665] E016 |   600/731 batches | lr 0.6250 | loss  3.383 | ppl     29.47 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 23:41:34.539] E016 |   731/731 batches | lr 0.6250 | loss  3.329 | ppl     27.92 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 23:41:48.597] End E016 | valid loss  4.635; ppl    103.00 | accu 0.2443 = 28191/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 23:42:02.579] End E016 |  test loss  9.608; ppl  14879.68 | accu 0.0643 = 7218/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 23:43:06.723] End E016 |  test loss 10.007; ppl  22189.98 | accu 0.0645 = 32716/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 23:43:06.723] Epoch 017/20 ==================================================
[2022-04-13 23:44:09.534] E017 |   200/731 batches | lr 0.3125 | loss  3.497 | ppl     33.02 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 23:45:12.606] E017 |   400/731 batches | lr 0.3125 | loss  3.501 | ppl     33.14 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 23:46:13.837] E017 |   600/731 batches | lr 0.3125 | loss  3.374 | ppl     29.19 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 23:46:56.896] E017 |   731/731 batches | lr 0.3125 | loss  3.326 | ppl     27.83 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 23:47:13.810] End E017 | valid loss  4.632; ppl    102.74 | accu 0.2445 = 28214/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 23:47:27.823] End E017 |  test loss  9.605; ppl  14832.65 | accu 0.0644 = 7224/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 23:48:30.993] End E017 |  test loss  9.995; ppl  21911.28 | accu 0.0648 = 32856/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 23:48:30.994] Epoch 018/20 ==================================================
[2022-04-13 23:49:32.891] E018 |   200/731 batches | lr 0.1562 | loss  3.491 | ppl     32.82 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 23:50:33.200] E018 |   400/731 batches | lr 0.1562 | loss  3.492 | ppl     32.85 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 23:51:31.735] E018 |   600/731 batches | lr 0.1562 | loss  3.369 | ppl     29.04 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 23:52:10.630] E018 |   731/731 batches | lr 0.1562 | loss  3.321 | ppl     27.70 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 23:52:24.628] End E018 | valid loss  4.630; ppl    102.55 | accu 0.2442 = 28173/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 23:52:38.448] End E018 |  test loss  9.605; ppl  14833.78 | accu 0.0646 = 7255/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 23:53:48.569] End E018 |  test loss  9.995; ppl  21907.21 | accu 0.0650 = 32939/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 23:53:48.569] Save: model.pt... 
[2022-04-13 23:53:49.073] Save: model.pt...Done. best_val_loss: 4.6304
[2022-04-13 23:53:49.073] Epoch 019/20 ==================================================
[2022-04-13 23:54:47.968] E019 |   200/731 batches | lr 0.1562 | loss  3.489 | ppl     32.74 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-13 23:55:51.113] E019 |   400/731 batches | lr 0.1562 | loss  3.487 | ppl     32.67 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-13 23:56:53.821] E019 |   600/731 batches | lr 0.1562 | loss  3.365 | ppl     28.94 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-13 23:57:32.314] E019 |   731/731 batches | lr 0.1562 | loss  3.322 | ppl     27.72 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-13 23:57:46.430] End E019 | valid loss  4.630; ppl    102.50 | accu 0.2441 = 28163/115380 | w_len 1.1401 = 131545/115380
[2022-04-13 23:58:01.315] End E019 |  test loss  9.615; ppl  14993.82 | accu 0.0642 = 7208/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-13 23:59:04.830] End E019 |  test loss 10.003; ppl  22097.75 | accu 0.0646 = 32766/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-13 23:59:04.830] Save: model.pt... 
[2022-04-13 23:59:05.334] Save: model.pt...Done. best_val_loss: 4.6299
[2022-04-13 23:59:05.334] Epoch 020/20 ==================================================
[2022-04-14 00:00:08.895] E020 |   200/731 batches | lr 0.1562 | loss  3.486 | ppl     32.66 frag_cnt/word_cnt=1.168=163464/140000
[2022-04-14 00:01:12.754] E020 |   400/731 batches | lr 0.1562 | loss  3.486 | ppl     32.67 frag_cnt/word_cnt=1.163=162814/140000
[2022-04-14 00:02:17.761] E020 |   600/731 batches | lr 0.1562 | loss  3.365 | ppl     28.92 frag_cnt/word_cnt=1.167=163419/140000
[2022-04-14 00:02:56.909] E020 |   731/731 batches | lr 0.1562 | loss  3.322 | ppl     27.72 frag_cnt/word_cnt=1.169=107233/91700
[2022-04-14 00:03:11.181] End E020 | valid loss  4.630; ppl    102.51 | accu 0.2443 = 28182/115380 | w_len 1.1401 = 131545/115380
[2022-04-14 00:03:26.352] End E020 |  test loss  9.614; ppl  14980.38 | accu 0.0645 = 7239/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:04:41.954] End E020 |  test loss 10.005; ppl  22147.04 | accu 0.0647 = 32792/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:04:55.902] End. test loss  9.62; ppl 14993.82 | accu 0.0642 = 7208/112220 | w_len 1.5840 = 177756/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:05:59.452] End. test loss 10.00; ppl 22097.75 | accu 0.0646 = 32766/506840 | w_len 1.7260 = 874807/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:05:59.452] =========================================================================================
[2022-04-14 00:05:59.452] valid_loss
[2022-04-14 00:05:59.452]  5.41, 5.06, 4.89, 4.80, 4.77, 4.73, 4.71, 4.71, 4.64, 4.65, 4.64, 4.63, 4.64, 4.64, 4.64, 4.63, 4.63, 4.63, 4.63, 4.63
[2022-04-14 00:05:59.452] valid_loss ppl
[2022-04-14 00:05:59.452]   223.42,  158.19,  133.58,  121.38,  117.53,  113.00,  111.29,  111.40,  103.48,  104.46,  103.06,  102.72,  103.19,  103.39,  103.21,  103.00,  102.74,  102.55,  102.50,  102.51
[2022-04-14 00:05:59.452] test_loss of ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:05:59.452]  8.90, 8.79, 8.74, 8.80, 8.93, 9.04, 9.06, 9.08, 9.23, 9.32, 9.50, 9.49, 9.53, 9.55, 9.58, 9.61, 9.60, 9.60, 9.62, 9.61
[2022-04-14 00:05:59.452] test_loss of ../data/sample_500k/adolescent_valid.txt ppl
[2022-04-14 00:05:59.452]  7300.93, 6596.85, 6223.43, 6661.50, 7564.44, 8467.88, 8596.08, 8815.42,10232.16,11159.88,13387.73,13267.84,13766.70,14020.36,14425.97,14879.68,14832.65,14833.78,14993.82,14980.38
[2022-04-14 00:05:59.452] test_loss of ../data/sample_500k/adult_test.txt
[2022-04-14 00:05:59.452]  8.81, 8.90, 8.91, 9.03, 9.28, 9.29, 9.46, 9.48, 9.66, 9.64, 9.79, 9.82, 9.90, 9.90, 9.97,10.01, 9.99, 9.99,10.00,10.01
[2022-04-14 00:05:59.453] test_loss of ../data/sample_500k/adult_test.txt ppl
[2022-04-14 00:05:59.453]  6688.59, 7315.17, 7426.16, 8366.75,10710.65,10795.55,12870.31,13122.12,15615.55,15411.66,17776.70,18384.66,19923.64,19998.75,21307.40,22189.98,21911.28,21907.21,22097.75,22147.04
[2022-04-14 00:05:59.453] 
[2022-04-14 00:05:59.453] 
[2022-04-14 00:05:59.453] 
Log file: ./output_wsm_Subword.5000_fam_LSTM.log closed.
Log file: ./output_wsm_Subword.10000_fam_CNN.log open...
[2022-04-14 00:05:59.462] corpus.train_file_list: 1
[2022-04-14 00:05:59.462]         ../data/sample_500k/cbt_train.txt
[2022-04-14 00:05:59.463] corpus.valid_file_list: 1
[2022-04-14 00:05:59.463]         ../data/sample_500k/cbt_valid.txt
[2022-04-14 00:05:59.463] corpus.test_file_list: 2
[2022-04-14 00:05:59.463]         ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:05:59.463]         ../data/sample_500k/adult_test.txt
[2022-04-14 00:05:59.463] corpus.subword_vocab_size: 0
[2022-04-14 00:05:59.463] corpus.subword_model = None. Corpus will not use subword.
[2022-04-14 00:05:59.463] corpus tokenize...
[2022-04-14 00:06:00.118]         train tokens: 511735  ../data/sample_500k/cbt_train.txt
[2022-04-14 00:06:00.255]         valid tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-14 00:06:00.486]         test  tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:06:01.108]         test  tokens: 506878  ../data/sample_500k/adult_test.txt
[2022-04-14 00:06:01.109] corpus.ntokens      : 73236
[2022-04-14 00:06:01.109] corpus.char_count   : 157
[2022-04-14 00:06:01.109] corpus.char_cnt_dict: 157
[2022-04-14 00:06:01.109] corpus.char_id_dict : 157
[2022-04-14 00:06:01.116] corpus.batchify(1 files, batch_size=20)...
[2022-04-14 00:06:01.116]         tokens_all: 511735
[2022-04-14 00:06:01.116]         batched   :  25586
[2022-04-14 00:06:01.116]         ../data/sample_500k/cbt_train.txt
[2022-04-14 00:06:01.118] corpus.batchify(1 files, batch_size=20)...
[2022-04-14 00:06:01.118]         tokens_all: 115417
[2022-04-14 00:06:01.118]         batched   :   5770
[2022-04-14 00:06:01.118]         ../data/sample_500k/cbt_valid.txt
[2022-04-14 00:06:01.119] corpus.batchify(1 files, batch_size=20)...
[2022-04-14 00:06:01.120]         tokens_all: 112256
[2022-04-14 00:06:01.120]         batched   :   5612
[2022-04-14 00:06:01.120]         ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:06:01.123] corpus.batchify(1 files, batch_size=20)...
[2022-04-14 00:06:01.123]         tokens_all: 506878
[2022-04-14 00:06:01.123]         batched   :  25343
[2022-04-14 00:06:01.124]         ../data/sample_500k/adult_test.txt
[2022-04-14 00:06:01.124] subword_adapter will be generated due to word_split_mode='Subword.10000'
[2022-04-14 00:06:01.124] SubwordAdapter.file_list: 2
[2022-04-14 00:06:01.124]         ../data/sample_500k/cbt_train.txt
[2022-04-14 00:06:01.125]         ../data/sample_500k/cbt_valid.txt
[2022-04-14 00:06:01.125] SubwordAdapter.subword_vocab_size: 10000
[2022-04-14 00:06:01.125] SubwordAdapter.subword_model.train(2 files)...
[2022-04-14 00:06:01.950] SubwordAdapter.subword_model.train(2 files)...Done
[2022-04-14 00:06:02.462] RNNModel.rnn_type: LSTM
[2022-04-14 00:06:02.463] RNNModel.ntoken  : 73236
[2022-04-14 00:06:02.463] RNNModel.ninp    : 200
[2022-04-14 00:06:02.463] RNNModel.nhid    : 200
[2022-04-14 00:06:02.463] RNNModel.nlayers : 2
[2022-04-14 00:06:02.463] RNNModel.dropout : 0.2
[2022-04-14 00:06:02.463] RNNModel.tie_weights: False
[2022-04-14 00:06:02.463] RNNModel.fragment_aggregate_mode: CNN
[2022-04-14 00:06:02.463] RNNModel.fragment_cnt           : 10002
[2022-04-14 00:06:02.463] RNNModel.fragment_emsize        : 25
[2022-04-14 00:06:02.463] RNNModel.fragment_nhid          : 200
[2022-04-14 00:06:02.468] RNNModel.fragment_embeds     : created
[2022-04-14 00:06:02.468] RNNModel.fragment_cnn3       : created
[2022-04-14 00:06:02.496] Epoch 001/20 ==================================================
[2022-04-14 00:06:17.573] E001 |   200/731 batches | lr 20.0000 | loss  7.401 | ppl   1638.20 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:06:32.965] E001 |   400/731 batches | lr 20.0000 | loss  5.997 | ppl    402.22 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:06:48.019] E001 |   600/731 batches | lr 20.0000 | loss  5.370 | ppl    214.85 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:06:57.811] E001 |   731/731 batches | lr 20.0000 | loss  5.185 | ppl    178.64 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:07:03.065] End E001 | valid loss  5.341; ppl    208.66 | accu 0.1635 = 18868/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:07:08.299] End E001 |  test loss  8.771; ppl   6443.09 | accu 0.0460 = 5157/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:07:32.059] End E001 |  test loss  8.907; ppl   7382.87 | accu 0.0466 = 23628/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:07:32.059] Save: model.pt... 
[2022-04-14 00:07:32.564] Save: model.pt...Done. best_val_loss: 5.3407
[2022-04-14 00:07:32.564] Epoch 002/20 ==================================================
[2022-04-14 00:07:47.668] E002 |   200/731 batches | lr 20.0000 | loss  5.047 | ppl    155.51 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:08:03.010] E002 |   400/731 batches | lr 20.0000 | loss  4.955 | ppl    141.82 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:08:18.532] E002 |   600/731 batches | lr 20.0000 | loss  4.750 | ppl    115.60 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:08:28.389] E002 |   731/731 batches | lr 20.0000 | loss  4.704 | ppl    110.35 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:08:33.733] End E002 | valid loss  5.062; ppl    157.95 | accu 0.1813 = 20920/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:08:39.146] End E002 |  test loss  8.667; ppl   5808.98 | accu 0.0384 = 4305/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:09:03.162] End E002 |  test loss  8.902; ppl   7348.66 | accu 0.0363 = 18383/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:09:03.162] Save: model.pt... 
[2022-04-14 00:09:03.647] Save: model.pt...Done. best_val_loss: 5.0623
[2022-04-14 00:09:03.648] Epoch 003/20 ==================================================
[2022-04-14 00:09:18.741] E003 |   200/731 batches | lr 20.0000 | loss  4.649 | ppl    104.51 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:09:33.758] E003 |   400/731 batches | lr 20.0000 | loss  4.627 | ppl    102.17 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:09:48.847] E003 |   600/731 batches | lr 20.0000 | loss  4.491 | ppl     89.20 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:09:58.775] E003 |   731/731 batches | lr 20.0000 | loss  4.460 | ppl     86.48 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:10:04.080] End E003 | valid loss  4.885; ppl    132.24 | accu 0.1952 = 22521/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:10:09.306] End E003 |  test loss  8.640; ppl   5652.82 | accu 0.0531 = 5955/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:10:33.002] End E003 |  test loss  8.940; ppl   7628.52 | accu 0.0485 = 24579/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:10:33.002] Save: model.pt... 
[2022-04-14 00:10:33.462] Save: model.pt...Done. best_val_loss: 4.8846
[2022-04-14 00:10:33.463] Epoch 004/20 ==================================================
[2022-04-14 00:10:48.253] E004 |   200/731 batches | lr 20.0000 | loss  4.443 | ppl     85.05 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:11:03.251] E004 |   400/731 batches | lr 20.0000 | loss  4.441 | ppl     84.85 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:11:18.150] E004 |   600/731 batches | lr 20.0000 | loss  4.329 | ppl     75.88 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:11:28.002] E004 |   731/731 batches | lr 20.0000 | loss  4.308 | ppl     74.26 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:11:33.219] End E004 | valid loss  4.809; ppl    122.62 | accu 0.2044 = 23584/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:11:38.409] End E004 |  test loss  8.672; ppl   5837.47 | accu 0.0549 = 6159/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:12:02.253] End E004 |  test loss  9.051; ppl   8525.24 | accu 0.0485 = 24586/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:12:02.253] Save: model.pt... 
[2022-04-14 00:12:02.703] Save: model.pt...Done. best_val_loss: 4.8091
[2022-04-14 00:12:02.703] Epoch 005/20 ==================================================
[2022-04-14 00:12:17.832] E005 |   200/731 batches | lr 20.0000 | loss  4.295 | ppl     73.32 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:12:33.059] E005 |   400/731 batches | lr 20.0000 | loss  4.302 | ppl     73.84 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:12:48.619] E005 |   600/731 batches | lr 20.0000 | loss  4.205 | ppl     67.01 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:12:58.542] E005 |   731/731 batches | lr 20.0000 | loss  4.188 | ppl     65.91 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:13:03.794] End E005 | valid loss  4.788; ppl    120.05 | accu 0.2070 = 23889/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:13:09.005] End E005 |  test loss  8.518; ppl   5003.18 | accu 0.0610 = 6847/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:13:32.806] End E005 |  test loss  8.936; ppl   7601.50 | accu 0.0544 = 27570/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:13:32.806] Save: model.pt... 
[2022-04-14 00:13:33.262] Save: model.pt...Done. best_val_loss: 4.7879
[2022-04-14 00:13:33.262] Epoch 006/20 ==================================================
[2022-04-14 00:13:48.555] E006 |   200/731 batches | lr 20.0000 | loss  4.182 | ppl     65.52 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:14:04.771] E006 |   400/731 batches | lr 20.0000 | loss  4.195 | ppl     66.37 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:14:19.924] E006 |   600/731 batches | lr 20.0000 | loss  4.101 | ppl     60.39 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:14:30.146] E006 |   731/731 batches | lr 20.0000 | loss  4.085 | ppl     59.46 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:14:36.577] End E006 | valid loss  4.778; ppl    118.87 | accu 0.2094 = 24157/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:14:42.905] End E006 |  test loss  8.665; ppl   5795.63 | accu 0.0609 = 6837/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:15:11.691] End E006 |  test loss  9.107; ppl   9016.89 | accu 0.0556 = 28195/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:15:11.691] Save: model.pt... 
[2022-04-14 00:15:12.150] Save: model.pt...Done. best_val_loss: 4.7780
[2022-04-14 00:15:12.150] Epoch 007/20 ==================================================
[2022-04-14 00:15:27.434] E007 |   200/731 batches | lr 20.0000 | loss  4.087 | ppl     59.53 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:15:42.591] E007 |   400/731 batches | lr 20.0000 | loss  4.108 | ppl     60.85 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:15:58.524] E007 |   600/731 batches | lr 20.0000 | loss  4.018 | ppl     55.57 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:16:08.424] E007 |   731/731 batches | lr 20.0000 | loss  4.001 | ppl     54.66 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:16:13.677] End E007 | valid loss  4.764; ppl    117.26 | accu 0.2144 = 24735/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:16:18.907] End E007 |  test loss  8.520; ppl   5014.44 | accu 0.0646 = 7251/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:16:42.806] End E007 |  test loss  8.879; ppl   7179.88 | accu 0.0597 = 30264/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:16:42.806] Save: model.pt... 
[2022-04-14 00:16:43.258] Save: model.pt...Done. best_val_loss: 4.7644
[2022-04-14 00:16:43.259] Epoch 008/20 ==================================================
[2022-04-14 00:16:58.489] E008 |   200/731 batches | lr 20.0000 | loss  4.005 | ppl     54.87 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:17:13.737] E008 |   400/731 batches | lr 20.0000 | loss  4.022 | ppl     55.82 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:17:29.125] E008 |   600/731 batches | lr 20.0000 | loss  3.943 | ppl     51.56 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:17:39.539] E008 |   731/731 batches | lr 20.0000 | loss  3.928 | ppl     50.83 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:17:44.948] End E008 | valid loss  4.740; ppl    114.40 | accu 0.2177 = 25119/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:17:50.216] End E008 |  test loss  8.719; ppl   6120.50 | accu 0.0620 = 6956/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:18:14.224] End E008 |  test loss  9.209; ppl   9990.89 | accu 0.0535 = 27107/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:18:14.224] Save: model.pt... 
[2022-04-14 00:18:14.681] Save: model.pt...Done. best_val_loss: 4.7397
[2022-04-14 00:18:14.682] Epoch 009/20 ==================================================
[2022-04-14 00:18:29.697] E009 |   200/731 batches | lr 20.0000 | loss  3.930 | ppl     50.90 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:18:45.589] E009 |   400/731 batches | lr 20.0000 | loss  3.956 | ppl     52.24 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:19:00.786] E009 |   600/731 batches | lr 20.0000 | loss  3.874 | ppl     48.12 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:19:10.727] E009 |   731/731 batches | lr 20.0000 | loss  3.865 | ppl     47.69 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:19:15.967] End E009 | valid loss  4.681; ppl    107.89 | accu 0.2256 = 26026/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:19:21.190] End E009 |  test loss  8.831; ppl   6841.68 | accu 0.0594 = 6661/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:19:45.008] End E009 |  test loss  9.486; ppl  13171.25 | accu 0.0537 = 27198/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:19:45.008] Save: model.pt... 
[2022-04-14 00:19:45.458] Save: model.pt...Done. best_val_loss: 4.6812
[2022-04-14 00:19:45.458] Epoch 010/20 ==================================================
[2022-04-14 00:20:00.480] E010 |   200/731 batches | lr 20.0000 | loss  3.872 | ppl     48.02 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:20:17.065] E010 |   400/731 batches | lr 20.0000 | loss  3.893 | ppl     49.05 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:20:33.065] E010 |   600/731 batches | lr 20.0000 | loss  3.821 | ppl     45.65 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:20:43.204] E010 |   731/731 batches | lr 20.0000 | loss  3.807 | ppl     45.02 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:20:48.440] End E010 | valid loss  4.680; ppl    107.79 | accu 0.2264 = 26118/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:20:53.698] End E010 |  test loss  8.894; ppl   7287.77 | accu 0.0601 = 6740/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:21:17.643] End E010 |  test loss  9.605; ppl  14831.47 | accu 0.0501 = 25373/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:21:17.643] Save: model.pt... 
[2022-04-14 00:21:18.099] Save: model.pt...Done. best_val_loss: 4.6801
[2022-04-14 00:21:18.099] Epoch 011/20 ==================================================
[2022-04-14 00:21:33.312] E011 |   200/731 batches | lr 20.0000 | loss  3.816 | ppl     45.44 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:21:48.637] E011 |   400/731 batches | lr 20.0000 | loss  3.841 | ppl     46.59 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:22:03.920] E011 |   600/731 batches | lr 20.0000 | loss  3.763 | ppl     43.07 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:22:13.849] E011 |   731/731 batches | lr 20.0000 | loss  3.757 | ppl     42.84 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:22:19.140] End E011 | valid loss  4.673; ppl    107.07 | accu 0.2329 = 26875/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:22:24.381] End E011 |  test loss  8.797; ppl   6617.06 | accu 0.0661 = 7419/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:22:48.231] End E011 |  test loss  9.440; ppl  12586.31 | accu 0.0584 = 29605/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:22:48.231] Save: model.pt... 
[2022-04-14 00:22:48.686] Save: model.pt...Done. best_val_loss: 4.6735
[2022-04-14 00:22:48.686] Epoch 012/20 ==================================================
[2022-04-14 00:23:03.834] E012 |   200/731 batches | lr 20.0000 | loss  3.773 | ppl     43.49 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:23:19.568] E012 |   400/731 batches | lr 20.0000 | loss  3.798 | ppl     44.59 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:23:34.818] E012 |   600/731 batches | lr 20.0000 | loss  3.726 | ppl     41.50 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:23:44.778] E012 |   731/731 batches | lr 20.0000 | loss  3.713 | ppl     40.98 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:23:50.070] End E012 | valid loss  4.683; ppl    108.09 | accu 0.2327 = 26851/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:23:55.318] End E012 |  test loss  9.108; ppl   9024.30 | accu 0.0617 = 6919/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:24:19.362] End E012 |  test loss  9.725; ppl  16724.57 | accu 0.0565 = 28631/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:24:19.363] Epoch 013/20 ==================================================
[2022-04-14 00:24:34.616] E013 |   200/731 batches | lr 10.0000 | loss  3.668 | ppl     39.16 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:24:50.568] E013 |   400/731 batches | lr 10.0000 | loss  3.648 | ppl     38.38 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:25:05.916] E013 |   600/731 batches | lr 10.0000 | loss  3.539 | ppl     34.42 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:25:15.951] E013 |   731/731 batches | lr 10.0000 | loss  3.495 | ppl     32.96 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:25:21.243] End E013 | valid loss  4.653; ppl    104.90 | accu 0.2402 = 27719/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:25:26.498] End E013 |  test loss  9.218; ppl  10076.28 | accu 0.0634 = 7117/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:25:50.638] End E013 |  test loss 10.018; ppl  22423.43 | accu 0.0593 = 30044/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:25:50.638] Save: model.pt... 
[2022-04-14 00:25:51.089] Save: model.pt...Done. best_val_loss: 4.6530
[2022-04-14 00:25:51.089] Epoch 014/20 ==================================================
[2022-04-14 00:26:07.319] E014 |   200/731 batches | lr 10.0000 | loss  3.575 | ppl     35.70 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:26:22.544] E014 |   400/731 batches | lr 10.0000 | loss  3.582 | ppl     35.96 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:26:37.909] E014 |   600/731 batches | lr 10.0000 | loss  3.488 | ppl     32.73 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:26:47.883] E014 |   731/731 batches | lr 10.0000 | loss  3.464 | ppl     31.96 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:26:53.191] End E014 | valid loss  4.666; ppl    106.30 | accu 0.2399 = 27684/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:26:58.555] End E014 |  test loss  9.170; ppl   9599.90 | accu 0.0652 = 7322/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:27:22.532] End E014 |  test loss  9.724; ppl  16706.28 | accu 0.0628 = 31823/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:27:22.532] Epoch 015/20 ==================================================
[2022-04-14 00:27:37.957] E015 |   200/731 batches | lr 5.0000 | loss  3.516 | ppl     33.65 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:27:53.591] E015 |   400/731 batches | lr 5.0000 | loss  3.506 | ppl     33.31 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:28:09.129] E015 |   600/731 batches | lr 5.0000 | loss  3.388 | ppl     29.59 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:28:19.170] E015 |   731/731 batches | lr 5.0000 | loss  3.349 | ppl     28.47 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:28:25.552] End E015 | valid loss  4.659; ppl    105.57 | accu 0.2433 = 28072/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:28:31.916] End E015 |  test loss  9.212; ppl  10017.17 | accu 0.0674 = 7560/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:28:57.542] End E015 |  test loss  9.866; ppl  19268.95 | accu 0.0641 = 32477/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:28:57.543] Epoch 016/20 ==================================================
[2022-04-14 00:29:12.790] E016 |   200/731 batches | lr 2.5000 | loss  3.469 | ppl     32.11 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:29:27.925] E016 |   400/731 batches | lr 2.5000 | loss  3.457 | ppl     31.74 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:29:42.992] E016 |   600/731 batches | lr 2.5000 | loss  3.339 | ppl     28.19 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:29:52.921] E016 |   731/731 batches | lr 2.5000 | loss  3.289 | ppl     26.82 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:29:58.211] End E016 | valid loss  4.646; ppl    104.19 | accu 0.2464 = 28435/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:30:03.506] End E016 |  test loss  9.297; ppl  10903.84 | accu 0.0680 = 7630/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:30:27.491] End E016 |  test loss  9.897; ppl  19871.13 | accu 0.0649 = 32881/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:30:27.491] Save: model.pt... 
[2022-04-14 00:30:27.950] Save: model.pt...Done. best_val_loss: 4.6462
[2022-04-14 00:30:27.950] Epoch 017/20 ==================================================
[2022-04-14 00:30:43.237] E017 |   200/731 batches | lr 2.5000 | loss  3.427 | ppl     30.78 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:30:58.267] E017 |   400/731 batches | lr 2.5000 | loss  3.432 | ppl     30.94 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:31:13.420] E017 |   600/731 batches | lr 2.5000 | loss  3.319 | ppl     27.63 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:31:23.789] E017 |   731/731 batches | lr 2.5000 | loss  3.276 | ppl     26.47 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:31:30.198] End E017 | valid loss  4.655; ppl    105.07 | accu 0.2464 = 28435/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:31:36.582] End E017 |  test loss  9.250; ppl  10405.18 | accu 0.0680 = 7631/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:32:06.056] End E017 |  test loss  9.926; ppl  20460.67 | accu 0.0642 = 32555/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:32:06.057] Epoch 018/20 ==================================================
[2022-04-14 00:32:21.295] E018 |   200/731 batches | lr 1.2500 | loss  3.413 | ppl     30.36 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:32:37.308] E018 |   400/731 batches | lr 1.2500 | loss  3.414 | ppl     30.37 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:32:52.966] E018 |   600/731 batches | lr 1.2500 | loss  3.298 | ppl     27.05 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:33:03.284] E018 |   731/731 batches | lr 1.2500 | loss  3.253 | ppl     25.87 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:33:08.557] End E018 | valid loss  4.652; ppl    104.84 | accu 0.2468 = 28472/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:33:13.810] End E018 |  test loss  9.225; ppl  10149.62 | accu 0.0696 = 7807/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:33:37.730] End E018 |  test loss  9.818; ppl  18366.87 | accu 0.0661 = 33499/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:33:37.730] Epoch 019/20 ==================================================
[2022-04-14 00:33:52.567] E019 |   200/731 batches | lr 0.6250 | loss  3.402 | ppl     30.01 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:34:07.666] E019 |   400/731 batches | lr 0.6250 | loss  3.404 | ppl     30.08 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:34:22.776] E019 |   600/731 batches | lr 0.6250 | loss  3.281 | ppl     26.61 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:34:33.426] E019 |   731/731 batches | lr 0.6250 | loss  3.233 | ppl     25.35 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:34:38.744] End E019 | valid loss  4.648; ppl    104.35 | accu 0.2471 = 28513/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:34:43.994] End E019 |  test loss  9.242; ppl  10322.18 | accu 0.0698 = 7833/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:35:08.054] End E019 |  test loss  9.835; ppl  18668.42 | accu 0.0667 = 33824/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:35:08.054] Epoch 020/20 ==================================================
[2022-04-14 00:35:23.235] E020 |   200/731 batches | lr 0.3125 | loss  3.394 | ppl     29.80 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:35:38.488] E020 |   400/731 batches | lr 0.3125 | loss  3.401 | ppl     30.00 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:35:53.876] E020 |   600/731 batches | lr 0.3125 | loss  3.276 | ppl     26.47 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:36:03.949] E020 |   731/731 batches | lr 0.3125 | loss  3.222 | ppl     25.09 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:36:09.317] End E020 | valid loss  4.642; ppl    103.78 | accu 0.2475 = 28560/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:36:14.709] End E020 |  test loss  9.234; ppl  10236.79 | accu 0.0699 = 7847/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:36:38.798] End E020 |  test loss  9.816; ppl  18330.12 | accu 0.0670 = 33969/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:36:38.799] Save: model.pt... 
[2022-04-14 00:36:39.258] Save: model.pt...Done. best_val_loss: 4.6423
[2022-04-14 00:36:44.729] End. test loss  9.23; ppl 10236.79 | accu 0.0699 = 7847/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:37:08.738] End. test loss  9.82; ppl 18330.12 | accu 0.0670 = 33969/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:37:08.738] =========================================================================================
[2022-04-14 00:37:08.738] valid_loss
[2022-04-14 00:37:08.738]  5.34, 5.06, 4.88, 4.81, 4.79, 4.78, 4.76, 4.74, 4.68, 4.68, 4.67, 4.68, 4.65, 4.67, 4.66, 4.65, 4.65, 4.65, 4.65, 4.64
[2022-04-14 00:37:08.738] valid_loss ppl
[2022-04-14 00:37:08.738]   208.66,  157.95,  132.24,  122.62,  120.05,  118.87,  117.26,  114.40,  107.89,  107.79,  107.07,  108.09,  104.90,  106.30,  105.57,  104.19,  105.07,  104.84,  104.35,  103.78
[2022-04-14 00:37:08.738] test_loss of ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:37:08.738]  8.77, 8.67, 8.64, 8.67, 8.52, 8.66, 8.52, 8.72, 8.83, 8.89, 8.80, 9.11, 9.22, 9.17, 9.21, 9.30, 9.25, 9.23, 9.24, 9.23
[2022-04-14 00:37:08.739] test_loss of ../data/sample_500k/adolescent_valid.txt ppl
[2022-04-14 00:37:08.739]  6443.09, 5808.98, 5652.82, 5837.47, 5003.18, 5795.63, 5014.44, 6120.50, 6841.68, 7287.77, 6617.06, 9024.30,10076.28, 9599.90,10017.17,10903.84,10405.18,10149.62,10322.18,10236.79
[2022-04-14 00:37:08.739] test_loss of ../data/sample_500k/adult_test.txt
[2022-04-14 00:37:08.739]  8.91, 8.90, 8.94, 9.05, 8.94, 9.11, 8.88, 9.21, 9.49, 9.60, 9.44, 9.72,10.02, 9.72, 9.87, 9.90, 9.93, 9.82, 9.83, 9.82
[2022-04-14 00:37:08.739] test_loss of ../data/sample_500k/adult_test.txt ppl
[2022-04-14 00:37:08.739]  7382.87, 7348.66, 7628.52, 8525.24, 7601.50, 9016.89, 7179.88, 9990.89,13171.25,14831.47,12586.31,16724.57,22423.43,16706.28,19268.95,19871.13,20460.67,18366.87,18668.42,18330.12
[2022-04-14 00:37:08.739] 
[2022-04-14 00:37:08.739] 
[2022-04-14 00:37:08.739] 
Log file: ./output_wsm_Subword.10000_fam_CNN.log closed.
Log file: ./output_wsm_Subword.10000_fam_LSTM.log open...
[2022-04-14 00:37:08.751] corpus.train_file_list: 1
[2022-04-14 00:37:08.751]         ../data/sample_500k/cbt_train.txt
[2022-04-14 00:37:08.751] corpus.valid_file_list: 1
[2022-04-14 00:37:08.751]         ../data/sample_500k/cbt_valid.txt
[2022-04-14 00:37:08.751] corpus.test_file_list: 2
[2022-04-14 00:37:08.751]         ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:37:08.751]         ../data/sample_500k/adult_test.txt
[2022-04-14 00:37:08.751] corpus.subword_vocab_size: 0
[2022-04-14 00:37:08.751] corpus.subword_model = None. Corpus will not use subword.
[2022-04-14 00:37:08.751] corpus tokenize...
[2022-04-14 00:37:09.420]         train tokens: 511735  ../data/sample_500k/cbt_train.txt
[2022-04-14 00:37:09.560]         valid tokens: 115417  ../data/sample_500k/cbt_valid.txt
[2022-04-14 00:37:09.811]         test  tokens: 112256  ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:37:10.452]         test  tokens: 506878  ../data/sample_500k/adult_test.txt
[2022-04-14 00:37:10.453] corpus.ntokens      : 73236
[2022-04-14 00:37:10.453] corpus.char_count   : 157
[2022-04-14 00:37:10.453] corpus.char_cnt_dict: 157
[2022-04-14 00:37:10.453] corpus.char_id_dict : 157
[2022-04-14 00:37:10.458] corpus.batchify(1 files, batch_size=20)...
[2022-04-14 00:37:10.458]         tokens_all: 511735
[2022-04-14 00:37:10.459]         batched   :  25586
[2022-04-14 00:37:10.459]         ../data/sample_500k/cbt_train.txt
[2022-04-14 00:37:10.461] corpus.batchify(1 files, batch_size=20)...
[2022-04-14 00:37:10.461]         tokens_all: 115417
[2022-04-14 00:37:10.461]         batched   :   5770
[2022-04-14 00:37:10.461]         ../data/sample_500k/cbt_valid.txt
[2022-04-14 00:37:10.463] corpus.batchify(1 files, batch_size=20)...
[2022-04-14 00:37:10.463]         tokens_all: 112256
[2022-04-14 00:37:10.463]         batched   :   5612
[2022-04-14 00:37:10.463]         ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:37:10.470] corpus.batchify(1 files, batch_size=20)...
[2022-04-14 00:37:10.470]         tokens_all: 506878
[2022-04-14 00:37:10.470]         batched   :  25343
[2022-04-14 00:37:10.470]         ../data/sample_500k/adult_test.txt
[2022-04-14 00:37:10.471] subword_adapter will be generated due to word_split_mode='Subword.10000'
[2022-04-14 00:37:10.471] SubwordAdapter.file_list: 2
[2022-04-14 00:37:10.471]         ../data/sample_500k/cbt_train.txt
[2022-04-14 00:37:10.471]         ../data/sample_500k/cbt_valid.txt
[2022-04-14 00:37:10.471] SubwordAdapter.subword_vocab_size: 10000
[2022-04-14 00:37:10.472] SubwordAdapter.subword_model.train(2 files)...
[2022-04-14 00:37:11.343] SubwordAdapter.subword_model.train(2 files)...Done
[2022-04-14 00:37:11.854] RNNModel.rnn_type: LSTM
[2022-04-14 00:37:11.854] RNNModel.ntoken  : 73236
[2022-04-14 00:37:11.854] RNNModel.ninp    : 200
[2022-04-14 00:37:11.854] RNNModel.nhid    : 200
[2022-04-14 00:37:11.854] RNNModel.nlayers : 2
[2022-04-14 00:37:11.854] RNNModel.dropout : 0.2
[2022-04-14 00:37:11.854] RNNModel.tie_weights: False
[2022-04-14 00:37:11.854] RNNModel.fragment_aggregate_mode: LSTM
[2022-04-14 00:37:11.854] RNNModel.fragment_cnt           : 10002
[2022-04-14 00:37:11.854] RNNModel.fragment_emsize        : 25
[2022-04-14 00:37:11.854] RNNModel.fragment_nhid          : 200
[2022-04-14 00:37:11.859] RNNModel.fragment_embeds     : created
[2022-04-14 00:37:11.862] RNNModel.fragment_lstm       : created
[2022-04-14 00:37:11.862] RNNModel.fragment_lstm_linear: created
[2022-04-14 00:37:11.889] Epoch 001/20 ==================================================
[2022-04-14 00:38:13.176] E001 |   200/731 batches | lr 20.0000 | loss  7.396 | ppl   1629.25 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:39:15.153] E001 |   400/731 batches | lr 20.0000 | loss  6.022 | ppl    412.51 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:40:16.852] E001 |   600/731 batches | lr 20.0000 | loss  5.389 | ppl    218.91 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:41:03.360] E001 |   731/731 batches | lr 20.0000 | loss  5.206 | ppl    182.37 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:41:17.565] End E001 | valid loss  5.232; ppl    187.13 | accu 0.1827 = 21085/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:41:31.683] End E001 |  test loss  9.059; ppl   8596.34 | accu 0.0474 = 5320/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:42:35.910] End E001 |  test loss  9.170; ppl   9601.09 | accu 0.0484 = 24546/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:42:35.911] Save: model.pt... 
[2022-04-14 00:42:36.363] Save: model.pt...Done. best_val_loss: 5.2318
[2022-04-14 00:42:36.364] Epoch 002/20 ==================================================
[2022-04-14 00:43:37.743] E002 |   200/731 batches | lr 20.0000 | loss  5.070 | ppl    159.23 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:44:47.754] E002 |   400/731 batches | lr 20.0000 | loss  4.972 | ppl    144.31 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:45:51.179] E002 |   600/731 batches | lr 20.0000 | loss  4.777 | ppl    118.77 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:46:31.796] E002 |   731/731 batches | lr 20.0000 | loss  4.723 | ppl    112.47 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:46:48.377] End E002 | valid loss  5.089; ppl    162.22 | accu 0.1826 = 21070/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:47:03.922] End E002 |  test loss  8.726; ppl   6161.86 | accu 0.0467 = 5242/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:48:09.247] End E002 |  test loss  8.855; ppl   7007.89 | accu 0.0470 = 23831/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:48:09.248] Save: model.pt... 
[2022-04-14 00:48:09.716] Save: model.pt...Done. best_val_loss: 5.0890
[2022-04-14 00:48:09.716] Epoch 003/20 ==================================================
[2022-04-14 00:49:10.652] E003 |   200/731 batches | lr 20.0000 | loss  4.675 | ppl    107.24 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:50:13.135] E003 |   400/731 batches | lr 20.0000 | loss  4.644 | ppl    103.97 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:51:18.814] E003 |   600/731 batches | lr 20.0000 | loss  4.505 | ppl     90.50 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:51:58.460] E003 |   731/731 batches | lr 20.0000 | loss  4.479 | ppl     88.17 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:52:12.910] End E003 | valid loss  4.904; ppl    134.78 | accu 0.1936 = 22337/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:52:26.920] End E003 |  test loss  8.793; ppl   6585.79 | accu 0.0487 = 5468/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:53:31.469] End E003 |  test loss  8.992; ppl   8036.85 | accu 0.0454 = 22992/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:53:31.469] Save: model.pt... 
[2022-04-14 00:53:31.938] Save: model.pt...Done. best_val_loss: 4.9036
[2022-04-14 00:53:31.938] Epoch 004/20 ==================================================
[2022-04-14 00:54:35.076] E004 |   200/731 batches | lr 20.0000 | loss  4.453 | ppl     85.91 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 00:55:38.621] E004 |   400/731 batches | lr 20.0000 | loss  4.443 | ppl     85.03 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 00:56:42.777] E004 |   600/731 batches | lr 20.0000 | loss  4.332 | ppl     76.06 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 00:57:23.780] E004 |   731/731 batches | lr 20.0000 | loss  4.302 | ppl     73.82 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 00:57:38.102] End E004 | valid loss  4.782; ppl    119.33 | accu 0.2085 = 24057/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 00:57:52.181] End E004 |  test loss  8.698; ppl   5992.74 | accu 0.0558 = 6261/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 00:58:56.394] End E004 |  test loss  8.998; ppl   8086.70 | accu 0.0551 = 27932/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 00:58:56.394] Save: model.pt... 
[2022-04-14 00:58:56.847] Save: model.pt...Done. best_val_loss: 4.7819
[2022-04-14 00:58:56.848] Epoch 005/20 ==================================================
[2022-04-14 00:59:58.539] E005 |   200/731 batches | lr 20.0000 | loss  4.293 | ppl     73.15 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 01:00:58.894] E005 |   400/731 batches | lr 20.0000 | loss  4.293 | ppl     73.21 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 01:01:59.466] E005 |   600/731 batches | lr 20.0000 | loss  4.192 | ppl     66.14 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 01:02:42.895] E005 |   731/731 batches | lr 20.0000 | loss  4.170 | ppl     64.69 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 01:02:57.122] End E005 | valid loss  4.748; ppl    115.30 | accu 0.2125 = 24522/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 01:03:11.276] End E005 |  test loss  8.831; ppl   6841.78 | accu 0.0525 = 5886/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 01:04:21.135] End E005 |  test loss  9.151; ppl   9423.45 | accu 0.0489 = 24789/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 01:04:21.135] Save: model.pt... 
[2022-04-14 01:04:21.642] Save: model.pt...Done. best_val_loss: 4.7475
[2022-04-14 01:04:21.642] Epoch 006/20 ==================================================
[2022-04-14 01:05:23.505] E006 |   200/731 batches | lr 20.0000 | loss  4.166 | ppl     64.43 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 01:06:27.209] E006 |   400/731 batches | lr 20.0000 | loss  4.175 | ppl     65.03 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 01:07:28.943] E006 |   600/731 batches | lr 20.0000 | loss  4.085 | ppl     59.43 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 01:08:07.698] E006 |   731/731 batches | lr 20.0000 | loss  4.060 | ppl     57.97 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 01:08:22.982] End E006 | valid loss  4.735; ppl    113.92 | accu 0.2189 = 25254/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 01:08:36.946] End E006 |  test loss  8.930; ppl   7554.89 | accu 0.0598 = 6713/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 01:09:41.595] End E006 |  test loss  9.250; ppl  10403.39 | accu 0.0546 = 27697/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 01:09:41.595] Save: model.pt... 
[2022-04-14 01:09:42.151] Save: model.pt...Done. best_val_loss: 4.7355
[2022-04-14 01:09:42.151] Epoch 007/20 ==================================================
[2022-04-14 01:10:46.112] E007 |   200/731 batches | lr 20.0000 | loss  4.064 | ppl     58.23 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 01:11:46.053] E007 |   400/731 batches | lr 20.0000 | loss  4.078 | ppl     59.04 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 01:12:51.364] E007 |   600/731 batches | lr 20.0000 | loss  3.990 | ppl     54.08 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 01:13:34.266] E007 |   731/731 batches | lr 20.0000 | loss  3.967 | ppl     52.84 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 01:13:48.623] End E007 | valid loss  4.720; ppl    112.17 | accu 0.2180 = 25156/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 01:14:02.810] End E007 |  test loss  9.277; ppl  10684.28 | accu 0.0451 = 5061/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 01:15:07.945] End E007 |  test loss  9.534; ppl  13815.30 | accu 0.0409 = 20718/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 01:15:07.946] Save: model.pt... 
[2022-04-14 01:15:08.422] Save: model.pt...Done. best_val_loss: 4.7200
[2022-04-14 01:15:08.422] Epoch 008/20 ==================================================
[2022-04-14 01:16:13.139] E008 |   200/731 batches | lr 20.0000 | loss  3.978 | ppl     53.43 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 01:17:15.347] E008 |   400/731 batches | lr 20.0000 | loss  3.995 | ppl     54.32 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 01:18:23.486] E008 |   600/731 batches | lr 20.0000 | loss  3.914 | ppl     50.09 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 01:19:04.690] E008 |   731/731 batches | lr 20.0000 | loss  3.889 | ppl     48.84 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 01:19:18.901] End E008 | valid loss  4.698; ppl    109.71 | accu 0.2236 = 25800/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 01:19:33.020] End E008 |  test loss  9.175; ppl   9657.26 | accu 0.0552 = 6192/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 01:20:41.177] End E008 |  test loss  9.461; ppl  12843.84 | accu 0.0511 = 25885/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 01:20:41.178] Save: model.pt... 
[2022-04-14 01:20:41.669] Save: model.pt...Done. best_val_loss: 4.6978
[2022-04-14 01:20:41.669] Epoch 009/20 ==================================================
[2022-04-14 01:21:42.295] E009 |   200/731 batches | lr 20.0000 | loss  3.905 | ppl     49.65 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 01:22:44.590] E009 |   400/731 batches | lr 20.0000 | loss  3.920 | ppl     50.40 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 01:23:45.684] E009 |   600/731 batches | lr 20.0000 | loss  3.844 | ppl     46.72 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 01:24:26.998] E009 |   731/731 batches | lr 20.0000 | loss  3.821 | ppl     45.64 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 01:24:41.217] End E009 | valid loss  4.682; ppl    107.94 | accu 0.2285 = 26366/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 01:24:56.579] End E009 |  test loss  9.301; ppl  10947.73 | accu 0.0540 = 6057/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 01:26:06.319] End E009 |  test loss  9.532; ppl  13788.49 | accu 0.0498 = 25218/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 01:26:06.319] Save: model.pt... 
[2022-04-14 01:26:06.854] Save: model.pt...Done. best_val_loss: 4.6815
[2022-04-14 01:26:06.854] Epoch 010/20 ==================================================
[2022-04-14 01:27:09.785] E010 |   200/731 batches | lr 20.0000 | loss  3.839 | ppl     46.50 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 01:28:11.713] E010 |   400/731 batches | lr 20.0000 | loss  3.855 | ppl     47.23 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 01:29:13.095] E010 |   600/731 batches | lr 20.0000 | loss  3.780 | ppl     43.83 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 01:29:54.450] E010 |   731/731 batches | lr 20.0000 | loss  3.764 | ppl     43.13 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 01:30:08.426] End E010 | valid loss  4.697; ppl    109.62 | accu 0.2241 = 25862/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 01:30:22.222] End E010 |  test loss  9.503; ppl  13396.63 | accu 0.0526 = 5905/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 01:31:30.305] End E010 |  test loss  9.720; ppl  16645.43 | accu 0.0514 = 26046/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 01:31:30.305] Epoch 011/20 ==================================================
[2022-04-14 01:32:31.071] E011 |   200/731 batches | lr 10.0000 | loss  3.731 | ppl     41.72 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 01:33:31.150] E011 |   400/731 batches | lr 10.0000 | loss  3.705 | ppl     40.66 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 01:34:32.677] E011 |   600/731 batches | lr 10.0000 | loss  3.592 | ppl     36.29 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 01:35:11.942] E011 |   731/731 batches | lr 10.0000 | loss  3.546 | ppl     34.66 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 01:35:26.870] End E011 | valid loss  4.646; ppl    104.12 | accu 0.2399 = 27675/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 01:35:41.496] End E011 |  test loss  9.759; ppl  17317.74 | accu 0.0566 = 6354/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 01:36:45.521] End E011 |  test loss 10.180; ppl  26367.44 | accu 0.0561 = 28430/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 01:36:45.522] Save: model.pt... 
[2022-04-14 01:36:46.047] Save: model.pt...Done. best_val_loss: 4.6456
[2022-04-14 01:36:46.048] Epoch 012/20 ==================================================
[2022-04-14 01:37:51.232] E012 |   200/731 batches | lr 10.0000 | loss  3.629 | ppl     37.69 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 01:38:51.482] E012 |   400/731 batches | lr 10.0000 | loss  3.636 | ppl     37.93 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 01:39:55.460] E012 |   600/731 batches | lr 10.0000 | loss  3.540 | ppl     34.45 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 01:40:38.195] E012 |   731/731 batches | lr 10.0000 | loss  3.511 | ppl     33.50 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 01:40:52.330] End E012 | valid loss  4.660; ppl    105.61 | accu 0.2375 = 27399/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 01:41:06.456] End E012 |  test loss  9.637; ppl  15326.73 | accu 0.0569 = 6385/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 01:42:18.719] End E012 |  test loss  9.911; ppl  20155.63 | accu 0.0551 = 27907/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 01:42:18.719] Epoch 013/20 ==================================================
[2022-04-14 01:43:20.686] E013 |   200/731 batches | lr 5.0000 | loss  3.573 | ppl     35.63 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 01:44:23.164] E013 |   400/731 batches | lr 5.0000 | loss  3.557 | ppl     35.07 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 01:45:22.504] E013 |   600/731 batches | lr 5.0000 | loss  3.438 | ppl     31.14 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 01:46:01.083] E013 |   731/731 batches | lr 5.0000 | loss  3.397 | ppl     29.86 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 01:46:15.307] End E013 | valid loss  4.643; ppl    103.87 | accu 0.2431 = 28044/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 01:46:29.216] End E013 |  test loss  9.888; ppl  19689.05 | accu 0.0572 = 6420/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 01:47:40.310] End E013 |  test loss 10.204; ppl  27024.01 | accu 0.0564 = 28568/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 01:47:40.310] Save: model.pt... 
[2022-04-14 01:47:40.839] Save: model.pt...Done. best_val_loss: 4.6432
[2022-04-14 01:47:40.839] Epoch 014/20 ==================================================
[2022-04-14 01:48:44.429] E014 |   200/731 batches | lr 5.0000 | loss  3.515 | ppl     33.60 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 01:49:47.618] E014 |   400/731 batches | lr 5.0000 | loss  3.517 | ppl     33.69 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 01:50:48.628] E014 |   600/731 batches | lr 5.0000 | loss  3.411 | ppl     30.31 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 01:51:27.558] E014 |   731/731 batches | lr 5.0000 | loss  3.376 | ppl     29.26 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 01:51:41.959] End E014 | valid loss  4.649; ppl    104.49 | accu 0.2435 = 28095/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 01:51:56.256] End E014 |  test loss  9.802; ppl  18069.27 | accu 0.0589 = 6607/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 01:53:01.547] End E014 |  test loss 10.205; ppl  27050.32 | accu 0.0566 = 28712/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 01:53:01.547] Epoch 015/20 ==================================================
[2022-04-14 01:54:01.574] E015 |   200/731 batches | lr 2.5000 | loss  3.484 | ppl     32.57 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 01:55:01.631] E015 |   400/731 batches | lr 2.5000 | loss  3.482 | ppl     32.52 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 01:56:06.376] E015 |   600/731 batches | lr 2.5000 | loss  3.360 | ppl     28.80 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 01:56:46.484] E015 |   731/731 batches | lr 2.5000 | loss  3.316 | ppl     27.54 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 01:57:02.367] End E015 | valid loss  4.651; ppl    104.69 | accu 0.2455 = 28322/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 01:57:16.260] End E015 |  test loss  9.891; ppl  19743.32 | accu 0.0606 = 6801/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 01:58:22.452] End E015 |  test loss 10.306; ppl  29905.14 | accu 0.0575 = 29136/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 01:58:22.452] Epoch 016/20 ==================================================
[2022-04-14 01:59:25.323] E016 |   200/731 batches | lr 1.2500 | loss  3.465 | ppl     31.99 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 02:00:30.459] E016 |   400/731 batches | lr 1.2500 | loss  3.456 | ppl     31.69 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 02:01:32.197] E016 |   600/731 batches | lr 1.2500 | loss  3.336 | ppl     28.11 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 02:02:10.382] E016 |   731/731 batches | lr 1.2500 | loss  3.287 | ppl     26.75 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 02:02:24.528] End E016 | valid loss  4.653; ppl    104.92 | accu 0.2463 = 28415/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 02:02:38.393] End E016 |  test loss  9.843; ppl  18832.72 | accu 0.0620 = 6963/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 02:03:40.525] End E016 |  test loss 10.294; ppl  29562.27 | accu 0.0590 = 29928/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 02:03:40.525] Epoch 017/20 ==================================================
[2022-04-14 02:04:45.361] E017 |   200/731 batches | lr 0.6250 | loss  3.451 | ppl     31.52 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 02:05:42.976] E017 |   400/731 batches | lr 0.6250 | loss  3.447 | ppl     31.42 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 02:06:41.934] E017 |   600/731 batches | lr 0.6250 | loss  3.316 | ppl     27.56 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 02:07:22.246] E017 |   731/731 batches | lr 0.6250 | loss  3.269 | ppl     26.27 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 02:07:36.179] End E017 | valid loss  4.654; ppl    104.98 | accu 0.2475 = 28555/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 02:07:50.014] End E017 |  test loss  9.872; ppl  19378.74 | accu 0.0620 = 6957/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 02:08:53.235] End E017 |  test loss 10.333; ppl  30727.26 | accu 0.0595 = 30158/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 02:08:53.236] Epoch 018/20 ==================================================
[2022-04-14 02:09:51.371] E018 |   200/731 batches | lr 0.3125 | loss  3.443 | ppl     31.28 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 02:10:55.252] E018 |   400/731 batches | lr 0.3125 | loss  3.431 | ppl     30.91 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 02:11:54.315] E018 |   600/731 batches | lr 0.3125 | loss  3.312 | ppl     27.44 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 02:12:33.426] E018 |   731/731 batches | lr 0.3125 | loss  3.262 | ppl     26.09 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 02:12:47.344] End E018 | valid loss  4.648; ppl    104.40 | accu 0.2476 = 28573/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 02:13:01.086] End E018 |  test loss  9.859; ppl  19132.01 | accu 0.0623 = 6990/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 02:14:03.737] End E018 |  test loss 10.314; ppl  30150.79 | accu 0.0595 = 30167/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 02:14:03.737] Epoch 019/20 ==================================================
[2022-04-14 02:15:04.356] E019 |   200/731 batches | lr 0.1562 | loss  3.438 | ppl     31.13 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 02:16:02.452] E019 |   400/731 batches | lr 0.1562 | loss  3.442 | ppl     31.24 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 02:17:09.516] E019 |   600/731 batches | lr 0.1562 | loss  3.309 | ppl     27.35 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 02:17:48.108] E019 |   731/731 batches | lr 0.1562 | loss  3.258 | ppl     26.01 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 02:18:02.104] End E019 | valid loss  4.645; ppl    104.10 | accu 0.2476 = 28568/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 02:18:15.949] End E019 |  test loss  9.832; ppl  18625.05 | accu 0.0625 = 7009/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 02:19:19.176] End E019 |  test loss 10.309; ppl  30002.81 | accu 0.0598 = 30314/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 02:19:19.177] Epoch 020/20 ==================================================
[2022-04-14 02:20:18.961] E020 |   200/731 batches | lr 0.0781 | loss  3.437 | ppl     31.10 frag_cnt/word_cnt=1.110=155389/140000
[2022-04-14 02:21:16.871] E020 |   400/731 batches | lr 0.0781 | loss  3.437 | ppl     31.10 frag_cnt/word_cnt=1.103=154356/140000
[2022-04-14 02:22:17.493] E020 |   600/731 batches | lr 0.0781 | loss  3.306 | ppl     27.27 frag_cnt/word_cnt=1.109=155309/140000
[2022-04-14 02:22:55.850] E020 |   731/731 batches | lr 0.0781 | loss  3.255 | ppl     25.92 frag_cnt/word_cnt=1.107=101506/91700
[2022-04-14 02:23:09.980] End E020 | valid loss  4.643; ppl    103.82 | accu 0.2474 = 28540/115380 | w_len 1.0818 = 124817/115380
[2022-04-14 02:23:23.929] End E020 |  test loss  9.825; ppl  18488.11 | accu 0.0624 = 6997/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 02:24:27.058] End E020 |  test loss 10.308; ppl  29984.85 | accu 0.0595 = 30155/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 02:24:27.058] Save: model.pt... 
[2022-04-14 02:24:27.564] Save: model.pt...Done. best_val_loss: 4.6427
[2022-04-14 02:24:41.654] End. test loss  9.82; ppl 18488.11 | accu 0.0624 = 6997/112220 | w_len 1.4955 = 167821/112220 ../data/sample_500k/adolescent_valid.txt
[2022-04-14 02:25:44.403] End. test loss 10.31; ppl 29984.85 | accu 0.0595 = 30155/506840 | w_len 1.5691 = 795287/506840 ../data/sample_500k/adult_test.txt
[2022-04-14 02:25:44.404] =========================================================================================
[2022-04-14 02:25:44.404] valid_loss
[2022-04-14 02:25:44.404]  5.23, 5.09, 4.90, 4.78, 4.75, 4.74, 4.72, 4.70, 4.68, 4.70, 4.65, 4.66, 4.64, 4.65, 4.65, 4.65, 4.65, 4.65, 4.65, 4.64
[2022-04-14 02:25:44.404] valid_loss ppl
[2022-04-14 02:25:44.404]   187.13,  162.22,  134.78,  119.33,  115.30,  113.92,  112.17,  109.71,  107.94,  109.62,  104.12,  105.61,  103.87,  104.49,  104.69,  104.92,  104.98,  104.40,  104.10,  103.82
[2022-04-14 02:25:44.404] test_loss of ../data/sample_500k/adolescent_valid.txt
[2022-04-14 02:25:44.404]  9.06, 8.73, 8.79, 8.70, 8.83, 8.93, 9.28, 9.18, 9.30, 9.50, 9.76, 9.64, 9.89, 9.80, 9.89, 9.84, 9.87, 9.86, 9.83, 9.82
[2022-04-14 02:25:44.404] test_loss of ../data/sample_500k/adolescent_valid.txt ppl
[2022-04-14 02:25:44.404]  8596.34, 6161.86, 6585.79, 5992.74, 6841.78, 7554.89,10684.28, 9657.26,10947.73,13396.63,17317.74,15326.73,19689.05,18069.27,19743.32,18832.72,19378.74,19132.01,18625.05,18488.11
[2022-04-14 02:25:44.404] test_loss of ../data/sample_500k/adult_test.txt
[2022-04-14 02:25:44.404]  9.17, 8.85, 8.99, 9.00, 9.15, 9.25, 9.53, 9.46, 9.53, 9.72,10.18, 9.91,10.20,10.21,10.31,10.29,10.33,10.31,10.31,10.31
[2022-04-14 02:25:44.404] test_loss of ../data/sample_500k/adult_test.txt ppl
[2022-04-14 02:25:44.404]  9601.09, 7007.89, 8036.85, 8086.70, 9423.45,10403.39,13815.30,12843.84,13788.49,16645.43,26367.44,20155.63,27024.01,27050.32,29905.14,29562.27,30727.26,30150.79,30002.81,29984.85
[2022-04-14 02:25:44.404] 
[2022-04-14 02:25:44.405] 
[2022-04-14 02:25:44.405] 
Log file: ./output_wsm_Subword.10000_fam_LSTM.log closed.
